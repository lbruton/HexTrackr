# /generatedocs Command

Generate and validate the HexTrackr documentation portal using Atlas and Doc agents in sequence.

## Usage
`/generatedocs [options]`

Options:
- `validate` - Run full Playwright validation after generation
- `verbose` - Show detailed output from both agents
- `bump <type>` - Bump version before generation (patch/minor/major)

## Agent Workflow

**ATLAS** - Specification Cartographer & Version Historian
- Role: Scan specifications, manage versions, update changelog
- Tools: Read, Glob, Grep, Memento, version-manager.js
- Approach: Methodical data extraction and version tracking
- Output: `ATLAS_[timestamp].md` + roadmap.json + CHANGELOG.md
- NEW: Handles version bumps and changelog generation

**DOC** - Documentation Portal Guardian
- Role: Generate HTML and validate portal
- Tools: Bash, Playwright, Read/Write
- Approach: Systematic generation and validation
- Output: `DOC_[timestamp].md` + validation report
- Simplified: No longer handles changelog (Atlas does this)

## Execution

### Sequential Flow
1. Launch Atlas agent to scan specifications
2. Wait for Atlas to complete and generate roadmap.json
3. Launch Doc agent to generate HTML documentation
4. Doc validates the portal (with Playwright if requested)
5. Return combined summary from both agents

### Implementation

```javascript
// Step 1: Launch Atlas
Task(
  subagent_type: "atlas",
  description: "Scan specs and update roadmap",
  prompt: `
    TOOLS AVAILABLE:
    - Use atlas-spec-tools.js for specification scanning and roadmap management
    - Use agent-logger.js for cartographic precision logs
    
    MISSION:
    Scan all specifications in hextrackr-specs/specs/.
    Extract task progress from tasks.md files with cartographic precision.
    ${options.bump ? `Bump version: ${options.bump}` : ''}
    Update CHANGELOG.md with completed tasks.
    Generate or update roadmap.json with current status.
    ${options.bump ? 'Store version in Memento.' : ''}
    Report any issues found before making changes.
    Save full analysis to timestamped file.
  `
)

// Step 2: After Atlas completes, launch Doc
Task(
  subagent_type: "doc", 
  description: "Generate and validate documentation",
  prompt: `
    TOOLS AVAILABLE:
    - Use update-footer-version.js for footer version updates
    - Use agent-logger.js for systematic documentation logs
    
    MISSION:
    Read the roadmap.json generated by Atlas.
    Update ROADMAP.md with specification table.
    Run HTML generation script with systematic thoroughness.
    Update footer version using roadmap.json data.
    ${options.validate ? "Use Playwright to validate the portal." : "Perform basic validation."}
    Verify version badge is current and accurate.
    Report validation results with Doc's pride in clean execution.
    Save full report to timestamped file.
  `
)
```

## Key Benefits

- **Separation of Concerns**: Atlas handles data, Doc handles presentation
- **Quality Assurance**: Doc validates Atlas's work automatically
- **Detailed Reporting**: Both agents provide comprehensive reports
- **Error Detection**: Issues caught before they reach production
- **Audit Trail**: Timestamped files track all changes

## Example Usage

### Basic Documentation Generation
Input: `/generatedocs`

Claude Code executes:
1. Atlas scans all specs, finds 23 specifications
2. Atlas updates roadmap.json with current progress
3. Doc reads roadmap.json and updates ROADMAP.md
4. Doc runs HTML generation and basic validation
5. Both agents return summaries

Output:
```
üìö Documentation Generation Complete

ATLAS Report:
‚Ä¢ Scanned 23 specifications
‚Ä¢ Updated roadmap.json
‚Ä¢ 3 specs complete, 15 in progress, 5 planned
Full report: ATLAS_20250110T143000.md

DOC Report:
‚Ä¢ ROADMAP.md updated ‚úÖ
‚Ä¢ HTML generated ‚úÖ
‚Ä¢ Portal validated ‚úÖ
‚Ä¢ Version v1.0.12 confirmed ‚úÖ
Full report: DOC_20250110T143045.md

Portal ready at: http://localhost:8989/docs-html
```

### With Full Validation
Input: `/generatedocs validate`

Includes Playwright browser testing:
- Page load verification
- Navigation testing
- Content integrity checks
- Version badge validation
- Screenshot on failures

### With Verbose Output
Input: `/generatedocs verbose`

Shows:
- Detailed progress from each agent
- All files being processed
- Validation step results
- Any warnings or issues

### With Version Bump
Input: `/generatedocs bump patch`

Atlas performs:
1. Scans all specifications for completed tasks
2. Updates CHANGELOG.md with new entries
3. Runs version-manager.js to bump version
4. Generates Version ID (e.g., HEXTRACKR-VERSION-1013-20250910-001)
5. Stores version history in Memento
6. Updates roadmap.json

Then Doc generates HTML as usual.

Output includes:
```
üì¶ Version bumped: 1.0.12 ‚Üí 1.0.13
üìù Changelog updated with 5 completed tasks
üÜî Version ID: HEXTRACKR-VERSION-1013-20250910-001
```

## Error Handling

### Atlas Failures
- Missing specifications
- Malformed tasks.md files
- Invalid JSON structure

### Doc Failures
- Docker container not running
- HTML generation script errors
- Playwright validation failures

Both agents report issues clearly and provide recovery suggestions.

## Integration Notes

This command replaces the shell script approach with proper agent orchestration:
- Better error handling and reporting
- Integration with Claude's memory system
- Parallel capability if needed in future
- Consistent with other agent commands

### Related Atlas Commands
- `/atlas-bump-version <type>` - Direct version bumping
- `/atlas-list-versions` - View version history
- `/atlas-recall-version <id>` - Retrieve version details

The `/generatedocs bump` option is a convenient wrapper that combines version bumping with documentation generation in one step.

---

*"Atlas charts the territory, Doc makes it beautiful."*