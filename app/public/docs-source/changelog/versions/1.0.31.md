# Version 1.0.31

**Release Date**: 2025-09-25

---

## [1.0.31] - 2025-09-25

### Security Fixes

#### Critical: Cryptographically Weak Random Number Generators

**HEX-14**: Fixed multiple Math.random() vulnerabilities

- `app/public/scripts/shared/vulnerability-cards.js` - Added `generateSecureVulnId()` method using `crypto.getRandomValues()`
- `app/services/ticketService.js` - Updated to use `crypto.randomBytes()` for ticket ID generation
- `app/services/fileService.js` - Updated to use `crypto.randomBytes()` for secure file naming
- **Impact**: Eliminated predictability vulnerability in ID generation, increased entropy from ~2^32 to 2^48 bits

**HEX-15**: Fixed session ID vulnerability in CSV imports

- `app/public/scripts/shared/vulnerability-core.js` - Replaced Math.random() with `window.crypto.getRandomValues()` for session IDs
- **Impact**: Import session IDs are now cryptographically secure, preventing session hijacking during CSV operations

**HEX-16**: Fixed toast notification ID vulnerability

- `app/public/scripts/shared/toast-manager.js` - Secure ID generation for toast notifications using `crypto.getRandomValues()`
- **Impact**: Toast notification IDs are now unpredictable, preventing potential ID collision attacks

**HEX-17**: Fixed modal operation tracking vulnerability

- `app/public/scripts/shared/modal-monitoring.js` - Secure operation ID generation for modal lifecycle tracking
- **Impact**: Modal operation IDs now use cryptographic randomness, eliminating tracking manipulation risks

#### Technical Details

- All fixes maintain backward compatibility with existing ID formats
- Browser implementations use `window.crypto.getRandomValues()`
- Node.js implementations use `crypto.randomBytes()`
- No breaking changes to application functionality
- All fixes validated with ESLint and tested in Docker environment

### Fixed (9)

#### P1: Crypto API Fallbacks for Non-HTTPS Environments

**Issue**: Security fixes introduced breaking changes in environments without Web Crypto API support (HTTP, WebViews, older browsers)

**Resolution**: Added feature detection and graceful fallbacks to maintain functionality across all environments

**Files Updated**:

- `app/public/scripts/shared/vulnerability-core.js` - CSV import session IDs now fallback to timestamp-based IDs when crypto unavailable
- `app/public/scripts/shared/toast-manager.js` - Toast notifications maintain functionality with performance.now() fallback
- `app/public/scripts/shared/modal-monitoring.js` - Modal operations use timestamp fallback to prevent complete failure

**Impact**:

- Maintains cryptographic security in HTTPS environments
- Prevents complete feature failure in non-HTTPS environments
- Console warnings inform developers when running in degraded mode
- No breaking changes - all features work in all environments

### Refactored

#### Code Optimization: Eliminated Crypto Fallback Duplication

**Issue**: Codacy detected code clones from repeated crypto fallback patterns

**Resolution**: Created shared `crypto-utils.js` utility module to centralize ID generation logic

**Implementation**:

- New file: `app/public/scripts/shared/crypto-utils.js` - Shared utility with `generateSecureId()` function
- Refactored: `vulnerability-core.js` - Uses utility for CSV import session IDs
- Refactored: `toast-manager.js` - Uses utility for toast notification IDs
- Refactored: `modal-monitoring.js` - Uses utility for modal operation IDs
- Updated: `vulnerabilities.html` - Added script reference to load utility

**Impact**:

- Eliminated 2 code clones detected by Codacy
- Reduced total code by ~30 lines
- Single source of truth for secure ID generation
- Improved maintainability and testability

### Fixed (10)

#### ESLint no-undef Errors in Crypto Implementation (HEX-61)

**Issue**: The crypto-utils.js refactoring introduced 4 ESLint no-undef errors due to module compatibility issues

**Resolution**: Fixed browser/Node.js compatibility in crypto-utils module

**Errors Fixed**:

- `crypto-utils.js` lines 66-67: 'module' is not defined - Added module to ESLint globals
- `toast-manager.js` line 74: 'generateSecureId' is not defined - Added global directive
- `modal-monitoring.js` line 646: 'generateSecureId' is not defined - Added global directive

**Implementation**:

- Added proper module detection and browser window export in crypto-utils.js
- Added ESLint global directives for generateSecureId in consuming files
- Maintains compatibility with both browser and Node.js environments

### Configuration

#### Codacy Tool Configuration Cleanup

**Issue**: PMD and Semgrep tools causing analysis errors for JavaScript project

**Resolution**: Removed Java-specific and proprietary tools from Codacy configuration

**Changes**:

- Removed PMD tool (Java analyzer not applicable to JavaScript project)
- Removed Semgrep tool (proprietary extension errors)
- Deleted `ruleset.xml` containing Java PMD rules
- Updated `.codacy/codacy.yaml` to include only relevant tools (ESLint, Lizard, Trivy, Pylint)
- Cleaned `.codacy/tools-configs/languages-config.yaml` to remove PMD and Semgrep entries

**Impact**:

- Eliminated all PMD Java ruleset errors
- Resolved Semgrep proprietary extension failures
- Clean Codacy analysis with 0 configuration errors