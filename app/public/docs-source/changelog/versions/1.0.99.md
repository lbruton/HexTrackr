---
title: "Version 1.0.99 - CVE References Display with Blacklist Filtering"
date: "2025-10-21"
version: "1.0.99"
status: "Released"
category: "Feature"
---

# Version 1.0.99 - CVE References Display with Blacklist Filtering

**Release Status**: Released
**Release Date**: 2025-10-21
**Category**: Feature
**Issue**: [HEX-273](https://linear.app/hextrackr/issue/HEX-273)

## Overview

Added a References section to the Vulnerability Details Modal that displays curated CVE reference links from the CVE.org API. Uses a config-driven blacklist to filter out broken domains (securityfocus.com, securitytracker.com) while showing all working references. Default references (CVE.org Official Record + NIST NVD) are always displayed first.

## Changes

### CVE References Section

**New Features**:
- References section added to Vulnerability Details Modal
- CVE.org API integration with 24-hour client-side caching
- Blacklist-based filtering (permissive by default)
- Default references always shown first (CVE.org + NIST NVD)
- All reference links open in 1200x1200 popup windows

**User Experience**:
- CVE ID displayed as plain text (no clickable link)
- References section appears below vulnerability details
- Default references provide authoritative sources
- Broken domains automatically filtered out
- Loading spinner shows while fetching API data

**Files Created**:
- `app/public/scripts/shared/cve-api-helper.js` (570 lines) - CVE.org API integration
- `app/public/config/cve-reference-blacklist.json` - Blacklist config file

**Files Modified**:
- `app/public/scripts/shared/vulnerability-details-modal.js:101-109,157-166,174-233` - References section
- `app/public/vulnerabilities.html:983` - Script tag for cve-api-helper.js

## Technical Details

### CVE API Helper

**Class**: `CVEApiHelper`

**Key Methods**:
- `fetchCVEData(cveId)` - Fetch full CVE JSON from CVE.org API
- `fetchCVEReferences(cveId)` - Lightweight method returning only filtered references
- `loadReferenceBlacklist()` - Lazy-load blacklist from config file (cached)

**Caching Strategy**:
- localStorage with 24-hour TTL
- Max 100 entries with FIFO eviction
- Quota exceeded handling with auto-cleanup
- Supports both CVE 5.0 and CVE 4.0 JSON formats

**API Endpoint**:
- Base URL: `https://cveawg.mitre.org/api/cve/{CVE-ID}`
- Example: `https://cveawg.mitre.org/api/cve/CVE-2025-20352`
- No authentication required
- 5-second timeout

### Blacklist Filtering

**Config File**: `/app/public/config/cve-reference-blacklist.json`

**Structure**:
```json
{
  "description": "Blacklist of broken/unreliable CVE reference domains",
  "lastUpdated": "2025-10-21",
  "blacklistedDomains": [
    "securityfocus.com",
    "securitytracker.com"
  ],
  "notes": [
    "Add domains that return 404, timeout, or are no longer maintained",
    "Lowercase only - matching is case-insensitive",
    "Partial matches supported (e.g., 'example.com' blocks 'www.example.com')"
  ]
}
```

**Filtering Logic**:
- Permissive by default (allows all except blacklisted)
- Partial domain matching (blocks subdomains)
- Case-insensitive matching
- Easy maintenance (no code changes to update blacklist)

### Default References

**Always Shown First**:
1. CVE.org Official Record - `https://www.cve.org/CVERecord?id={CVE-ID}`
2. NIST NVD - `https://nvd.nist.gov/vuln/detail/{CVE-ID}`

**API References**: Appended after default references, filtered by blacklist

### Modal Integration

**Vulnerability Details Modal Changes**:

1. **CVE ID Display** (lines 101-109):
   - Changed from clickable link to plain text
   - Maintains Cisco Advisory and Plugin ID badges
   - Cleaner UX without nested modal triggers

2. **References Section** (lines 157-166):
   - Added below Affected Devices section
   - Loading spinner shown during API fetch
   - Error handling with "N/A" fallback

3. **Reference Loading** (lines 174-233):
   - `loadCVEReferences()` method called on modal display
   - Builds default references first (always shown)
   - Fetches and appends API references (filtered by blacklist)
   - All links use 1200x1200 popup windows

## KISS Decision (Mid-Sprint Pivot)

### Problem Identified

After implementing a full CVE.org modal with CVSS scores, CWE classifications, and affected products (683 lines of code), user feedback revealed:

- Complex modal was overkill for network admin use case
- Broke KISS principle (showing data users don't need)
- Modal-on-modal pattern was confusing
- Only needed: working reference links

### Simplified Solution

**What Was Removed**:
- Deleted `cve-org-modal.js` (683 lines)
- Removed complex CVE data modal HTML
- Removed CVSS vector parsing and display
- Removed CWE classification rendering
- Removed affected products display

**What Was Kept**:
- CVE.org API integration (`cve-api-helper.js`)
- Reference fetching and filtering
- Client-side caching (24-hour TTL)
- Error handling and fallbacks

**Benefits of KISS Approach**:
- Simpler UX - one modal, clear information hierarchy
- Faster implementation - 30 min vs 3+ hours
- Less code to maintain - ~100 lines vs 683 lines
- Config-driven maintenance (no code changes to update blacklist)
- Permissive by default (blacklist approach)
- Smaller bundle size

## User Experience Rationale

**Decision**: Show filtered references in existing modal, not new modal

**Reasoning**:
1. **Simplicity**: One modal is easier to navigate than nested modals
2. **Relevance**: Network admins need reference links, not CVSS vectors
3. **Accessibility**: All references in one place with working links
4. **Maintenance**: Config-driven blacklist requires zero code changes

**Use Case**: When investigating a CVE, users need quick access to authoritative sources (CVE.org, NIST NVD) and vendor advisories. Broken links (securityfocus.com, securitytracker.com) waste time and create frustration.

## Future Enhancements (Phase 2)

**Backend Service** (`cveEnrichmentService.js`):
- Run every 24 hours via cron
- Update non-Cisco/Palo CVEs with fix versions from CVE.org API
- Store enhanced descriptions in database
- Cache filtered references for instant display
- Similar to `ciscoAdvisoryService.js` pattern

**Database Table** (`cve_generic_advisories`):
- Store CVE.org data server-side
- Eliminate client-side API calls
- Provide offline capability
- Support fix version parsing for generic vendors

---

**Sprint**: [HEX-273](https://linear.app/hextrackr/issue/HEX-273) - CVE.org JSON Modal Display + Generic Advisory Fallback System (Phase 1)
**Sprint Documentation**: `/SPRINT_HEX-273.md`
**Implementation Approach**: KISS simplification (references only, not full modal)
