---
title: "Version 1.1.6 - Location Cards Multi-Ticket Modal Fix & Code Cleanup"
date: "2025-10-25"
version: "1.1.6"
status: "Released"
category: "Bug Fix"
---

# Version 1.1.6 - Location Cards Multi-Ticket Modal Fix & Code Cleanup

**Release Status**: ✅ Released
**Release Date**: 2025-10-25
**Parent Issues**: [HEX-344](https://linear.app/hextrackr/issue/HEX-344), [HEX-343](https://linear.app/hextrackr/issue/HEX-343), [DOCS-157](https://linear.app/hextrackr/issue/DOCS-157)

## Overview

Fixed location cards multi-ticket modal displaying placeholder data instead of proper ticket details, removed three debug console.log statements from CSV import controller, and updated documentation version footer.

---

## [1.1.6]

### Fixed

#### Location Cards Multi-Ticket Modal Data Display (HEX-344) - 2025-10-24

**Issue**: Location cards showed "placeholder information" in multi-ticket picker modal instead of proper ticket details.

**Symptoms**:
- Displayed timestamp IDs like "Ticket #1761280480398" instead of XT numbers ("XT-0046")
- All tickets showed same status/job type (only most recent ticket's metadata)
- Missing creation dates
- Radio button selection pattern instead of direct-click navigation

**Root Cause**: Location cards used batch lookup API response which returns summary metadata `{id, status, jobType}` for performance optimization, not full ticket objects `{id, xt_number, job_type, created_at, status}`. A duplicate modal implementation (`showLocationTicketPickerModal`) was built using this incomplete data instead of reusing the working device cards modal.

**Solution**:
- Added backend `getTicketsByLocation()` method to fetch full ticket details by location prefix
- Location cards now fetch complete ticket data on-demand and reuse device cards modal directly
- Eliminated 119 lines of duplicate modal code
- Overridden "Create New Ticket Anyway" button to add all location devices (not just location name)

**Technical Implementation**:
- Backend query uses `LIKE` pattern matching with `DISTINCT` to find all tickets for devices at location
- Frontend calls device modal after async fetch, then overrides button onclick handler
- Both modals now share identical UX and data structure

**Files Modified**:
- `app/services/ticketService.js`: Added `getTicketsByLocation(locationPrefix)` method (45 lines)
- `app/controllers/ticketController.js`: Added `getTicketsByLocation()` route handler (28 lines)
- `app/routes/tickets.js`: Registered `GET /location/:locationKey` endpoint (1 line)
- `app/public/scripts/shared/location-cards.js`: Replaced duplicate modal with `fetchAndShowLocationTicketModal()` and `overrideModalCreateButton()`, deleted 119 lines of duplicate code

**Validation**:
- ✅ Location cards show proper XT numbers in multi-ticket modal
- ✅ Each ticket displays individual status, job type, and creation date
- ✅ Direct-click navigation (no radio buttons)
- ✅ "Create New Ticket Anyway" button adds all location devices
- ✅ Identical UX to device cards modal
- ✅ No console errors or warnings
- ✅ Passes ESLint validation

**Issues**:
- [HEX-344](https://linear.app/hextrackr/issue/HEX-344) - Location Card Ticket Buttons

---

### Code Quality Improvements

#### Console.log Cleanup (HEX-343) - 2025-10-25

- **Cleanup**: Removed debug console.log statements from `app/controllers/importController.js` ([HEX-343](https://linear.app/hextrackr/issue/HEX-343/code-cleanup-remove-consolelog-in-importcontrollerjs))
  - **Removed (3 statements total)**:
    - Line 159: `console.log("STAGING IMPORT: Starting high-performance CSV import")`
    - Line 160: `console.log(\` File: ${filename}, Vendor: ${vendor}, Scan Date: ${scanDate}\`)`
    - Line 161: `console.log(\` Progress Session: ${sessionId}\`)`
  - All information already captured by ProgressTracker.createSession() and res.json() response
  - No functional impact - debugging code from September 18, 2025 feature development
  - Verified: ESLint passed, server restart successful, no regressions
  - **Impact**: Complete removal of STAGING IMPORT debugging block from CSV import pipeline

---

### Documentation Improvements

- **Content**: Fixed outdated version footer in `reference/system-requirements.md` - Updated from v1.1.3 to v1.1.6 ([DOCS-157](https://linear.app/hextrackr/issue/DOCS-157/docs-content-fix-system-requirementsmd-shows-outdated-version-footer))
- **Content**: Fixed incorrect code example in `architecture/frontend.md` - Added missing `window.` prefix to `VulnerabilityCoreOrchestrator` instantiation to match actual implementation ([DOCS-158](https://linear.app/hextrackr/issue/DOCS-158))
- **Content**: Fixed inaccurate VulnerabilityDataManager method documentation in `architecture/frontend.md` - Replaced non-existent `importCSV()` method with actual methods `loadData()`, `loadStatistics()`, and `refreshData()` ([DOCS-159](https://linear.app/hextrackr/issue/DOCS-159))
- **JSDoc**: Fixed documentation for `sendBypassResponse()` in `app/controllers/locationController.js` - Added complete JSDoc with detailed @param payload structure, @returns description, @throws tag, and two practical @example blocks demonstrating cache bypass integration ([DOCS-160](https://linear.app/hextrackr/issue/DOCS-160))
- **Content**: Fixed outdated version footer in `guides/user-guide.md` - Updated from v1.0.54 to v1.1.6 ([DOCS-161](https://linear.app/hextrackr/issue/DOCS-161))
- **Content**: Fixed misleading hot reloading documentation in `architecture/frontend.md` - Replaced "Hot Reloading: Development server support" with accurate Docker deployment workflow (frontend changes: browser refresh, backend changes: docker-compose restart) ([DOCS-162](https://linear.app/hextrackr/issue/DOCS-162))
- **Content**: Fixed broken internal link to `getting-started.md` in `guides/cisco-psirt-integration.md` - Removed non-existent reference from Related Documentation section ([DOCS-163](https://linear.app/hextrackr/issue/DOCS-163))

---

## Notes

### Performance Impact

**Positive**: Eliminated 119 lines of duplicate code, reducing maintenance burden and future bug surface area.

**Trade-off**: Location multi-ticket modal now makes additional API call to fetch full ticket details (only triggered when user clicks "View Tickets" on locations with 2+ tickets). This is acceptable because:
- Only affects rare case (most locations have 0-1 tickets)
- Preserves batch API's performance optimization for initial card rendering
- Matches device cards pattern (consistency is more valuable than micro-optimization)

---

*Version 1.1.6 | Released: 2025-10-24*
