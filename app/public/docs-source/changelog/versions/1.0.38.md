# Version 1.0.38

**Release Date**: 2025-09-30

---

## [1.0.38] - 2025-09-30

### Fixed (5)

#### HEX-98: Broken CVE Discovery Query in Import Summaries

**Critical Bug**: Duplicate CSV imports incorrectly showed 51-54 "new CVEs" instead of 0. Import summaries were completely unreliable for CVE discovery tracking.

**Evidence**:

- Import 1 (01:06 AM): 54 new CVEs affecting 1,556 vulnerabilities ❌
- Import 2 (02:30 PM): 54 new CVEs affecting 1,556 vulnerabilities ❌
- Import 3 (03:17 PM): 51 new CVEs affecting 442 vulnerabilities ❌
- **Expected**: 0 new CVEs for duplicate imports

**Root Cause**: SQL query attempted to join `vulnerability_daily_totals` (aggregated table) with `vulnerabilities_current` (detailed records) without proper join condition, creating cartesian product with non-deterministic results. Query would mark ancient CVEs (CVE-2017-12240, CVE-2018-0171) as "new" on every import.

**Solution**:

- Replaced broken query with correct `vulnerability_snapshots` lookup
- Added database indexes on CVE columns for performance optimization
- Reduced query complexity from O(n²) to O(n log n)

**Verification**: Duplicate imports now correctly show 0 new CVEs.

**Files Modified**:

- `app/services/importService.js` - Fixed CVE discovery query
- `app/public/scripts/init-database.js` - Added `idx_snapshots_cve` and `idx_current_cve` indexes