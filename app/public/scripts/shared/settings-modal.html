<!-- HexTrackr Shared Settings Modal -->
<div class="modal fade" id="settingsModal" tabindex="-1">
    <div class="modal-dialog modal-xl" style="max-width: 1400px;">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="fas fa-cog me-2"></i>
                    HexTrackr Settings
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <!-- Settings Section Navigation Buttons -->
                <div class="d-flex justify-content-end mb-3">
                    <div id="settingsSectionButtons" class="btn-group" role="group" aria-label="Settings Section Navigation">
                        <button type="button" class="btn btn-outline-primary" data-section="system-config">
                            <i class="fas fa-cogs me-2"></i>System Configuration
                        </button>
                        <button type="button" class="btn btn-outline-primary" data-section="data-mgmt">
                            <i class="fas fa-database me-2"></i>Data Management
                        </button>
                        <button type="button" class="btn btn-primary active" data-section="third-party">
                            <i class="fas fa-plug me-2"></i>Third Party Integrations
                        </button>
                    </div>
                </div>

                <!-- Third Party Integrations Section -->
                <div id="thirdPartyContent" style="display: none;">
                    <div class="row">
                        <!-- Cisco PSIRT API Configuration -->
                        <div class="col-lg-6 mb-4" data-integration="cisco">
                                        <div class="card">
                                            <div class="card-header">
                                                <h6 class="card-title mb-0">
                                                    <i class="fas fa-network-wired me-2 text-primary"></i>
                                                    Cisco PSIRT Advisory Sync
                                                </h6>
                                            </div>
                                            <div class="card-body d-flex flex-column">
                                                <div class="flex-grow-1">
                                                    <div class="mb-3">
                                                        <label class="form-label">Last Sync</label>
                                                        <div class="d-flex justify-content-between align-items-center text-muted">
                                                            <span id="ciscoLastSync">Never synced</span>
                                                            <div class="d-flex align-items-center" style="gap: 0.5rem;">
                                                                <small id="ciscoNextSync" class="text-nowrap">Calculating...</small>
                                                                <span id="ciscoHealthBadge" class="badge badge-sm bg-secondary">
                                                                    <i class="fas fa-circle" style="font-size: 0.5rem;"></i>
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="mb-3">
                                                        <label class="form-label">Cisco Advisory Statistics</label>
                                                        <div class="text-muted" id="ciscoStats">
                                                            <div><span id="ciscoTotalCves">0</span> Total Cisco CVEs • <span id="ciscoSyncedCount">0</span> Synced</div>
                                                            <div class="mt-1"><span id="ciscoMatchedCount">0</span> With Fixes • <span id="ciscoNoFixCount">0</span> No Fix Yet • <span id="ciscoUnsyncedCount">0</span> Not Applicable</div>
                                                        </div>
                                                    </div>
                                                    <div class="mb-3">
                                                        <div class="form-check form-switch">
                                                            <input class="form-check-input" type="checkbox" id="ciscoAutoSync" checked>
                                                            <label class="form-check-label" for="ciscoAutoSync">
                                                                <strong>Enable background sync</strong>
                                                            </label>
                                                        </div>
                                                        <small class="text-muted">Automatically syncs advisory data every 24 hours on server startup</small>
                                                    </div>
                                                </div>
                                                <div class="d-flex justify-content-between">
                                                    <button type="button" class="btn btn-outline-primary" id="syncCiscoNow" disabled>
                                                        <i class="fas fa-sync me-2"></i>Sync Now
                                                    </button>
                                                    <button type="button" class="btn btn-outline-primary" id="manageCiscoCredentials">
                                                        <i class="fas fa-key me-2"></i><span id="ciscoCredentialButtonText">Manage Credentials</span>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- CISA KEV Sync Configuration -->
                                    <div class="col-lg-6 mb-4" data-integration="kev">
                                        <div class="card">
                                            <div class="card-header">
                                                <h6 class="card-title mb-0">
                                                    <i class="fas fa-fire me-2 text-danger"></i>
                                                    CISA KEV Sync
                                                </h6>
                                            </div>
                                            <div class="card-body d-flex flex-column">
                                                <div class="flex-grow-1">
                                                    <div class="mb-3">
                                                        <label class="form-label">Last Sync</label>
                                                        <div class="d-flex justify-content-between align-items-center text-muted">
                                                            <span id="kevLastSync">Never synced</span>
                                                            <div class="d-flex align-items-center" style="gap: 0.5rem;">
                                                                <small id="kevNextSync" class="text-nowrap">Calculating...</small>
                                                                <span id="kevHealthBadge" class="badge badge-sm bg-secondary">
                                                                    <i class="fas fa-circle" style="font-size: 0.5rem;"></i>
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="mb-3">
                                                        <label class="form-label">KEV Statistics</label>
                                                        <div class="text-muted" id="kevStats">
                                                            <span id="kevTotalCount">0</span> total KEVs •
                                                            <span id="kevMatchedCount">0</span> matched in your environment
                                                        </div>
                                                    </div>
                                                    <div class="mb-3">
                                                        <div class="form-check form-switch">
                                                            <input class="form-check-input" type="checkbox" id="kevAutoSync" checked>
                                                            <label class="form-check-label" for="kevAutoSync">
                                                                <strong>Enable background sync</strong>
                                                            </label>
                                                        </div>
                                                        <small class="text-muted">Automatically syncs advisory data every 24 hours on server startup</small>
                                                    </div>
                                                </div>
                                                <div>
                                                    <button type="button" class="btn btn-outline-danger" id="syncKevNow">
                                                        <i class="fas fa-sync me-2"></i>Sync Now
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Palo Alto Security Advisory Sync Configuration (HEX-209) -->
                                    <div class="col-lg-6 mb-4" data-integration="palo">
                                        <div class="card">
                                            <div class="card-header">
                                                <h6 class="card-title mb-0">
                                                    <i class="fas fa-shield-alt me-2 text-warning"></i>
                                                    Palo Alto Security Advisory
                                                </h6>
                                            </div>
                                            <div class="card-body d-flex flex-column">
                                                <div class="flex-grow-1">
                                                    <div class="mb-3">
                                                        <label class="form-label">Last Sync</label>
                                                        <div class="d-flex justify-content-between align-items-center text-muted">
                                                            <span id="paloLastSync">Never synced</span>
                                                            <div class="d-flex align-items-center" style="gap: 0.5rem;">
                                                                <small id="paloNextSync" class="text-nowrap">Calculating...</small>
                                                                <span id="paloHealthBadge" class="badge badge-sm bg-secondary">
                                                                    <i class="fas fa-circle" style="font-size: 0.5rem;"></i>
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="mb-3">
                                                        <label class="form-label">Palo Alto Advisory Statistics</label>
                                                        <div class="text-muted" id="paloStats">
                                                            <div><span id="paloTotalCves">0</span> Total Palo Alto CVEs • <span id="paloSyncedCount">0</span> Synced</div>
                                                            <div class="mt-1"><span id="paloMatchedCount">0</span> With Fixes • <span id="paloNoFixCount">0</span> No Fix Yet • <span id="paloUnsyncedCount">0</span> Not Applicable</div>
                                                        </div>
                                                    </div>
                                                    <div class="mb-3">
                                                        <div class="form-check form-switch">
                                                            <input class="form-check-input" type="checkbox" id="paloAutoSync" checked>
                                                            <label class="form-check-label" for="paloAutoSync">
                                                                <strong>Enable background sync</strong>
                                                            </label>
                                                        </div>
                                                        <small class="text-muted">Automatically syncs advisory data every 24 hours on server startup</small>
                                                    </div>
                                                </div>
                                                <div>
                                                    <button type="button" class="btn btn-outline-warning" id="syncPaloNow">
                                                        <i class="fas fa-sync me-2"></i>Sync Now
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- ServiceNow Integration -->
                                    <div class="col-lg-6 mb-4" data-integration="servicenow">
                                        <div class="card">
                                            <div class="card-header">
                                                <h6 class="card-title mb-0">
                                                    <i class="fas fa-cloud me-2 text-primary"></i>
                                                    ServiceNow Integration
                                                </h6>
                                            </div>
                                            <div class="card-body d-flex flex-column">
                                                <div class="flex-grow-1">
                                                    <div class="mb-3" id="serviceNowConfig">
                                                        <label for="serviceNowInstance" class="form-label">ServiceNow Instance URL</label>
                                                        <input type="url" class="form-control" id="serviceNowInstance"
                                                               placeholder="https://yourorg.service-now.com"
                                                               pattern="https://.*\.service-now\.com">
                                                        <div class="form-text">
                                                            Enter your organization's ServiceNow instance URL (e.g., https://yourorg.service-now.com)
                                                        </div>
                                                    </div>
                                                    <div class="mb-3">
                                                        <div class="form-check form-switch">
                                                            <input class="form-check-input" type="checkbox" id="serviceNowEnabled">
                                                            <label class="form-check-label" for="serviceNowEnabled">
                                                                <strong>Enable ServiceNow Integration</strong>
                                                            </label>
                                                        </div>
                                                        <small class="text-muted">When enabled, Service Now ticket numbers become clickable links</small>
                                                    </div>
                                                </div>
                                                <div class="d-flex justify-content-between">
                                                    <button type="button" class="btn btn-outline-success" id="saveServiceNowSettings">
                                                        <i class="fas fa-save me-2"></i>Save Configuration
                                                    </button>
                                                    <button type="button" class="btn btn-outline-primary" id="testServiceNowLink">
                                                        <i class="fas fa-external-link-alt me-2"></i>Test Link
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Netbox Integration (HEX-233) -->
                                    <div class="col-lg-6 mb-4" data-integration="netbox">
                                        <div class="card">
                                            <div class="card-header">
                                                <h6 class="card-title mb-0">
                                                    <i class="fas fa-server me-2 text-info"></i>
                                                    Netbox
                                                </h6>
                                            </div>
                                            <div class="card-body d-flex flex-column">
                                                <div class="flex-grow-1">
                                                    <div class="row mb-3">
                                                        <div class="col-6">
                                                            <label class="form-label">Last Sync (API)</label>
                                                            <div class="text-muted" id="netboxLastSync">Never synced</div>
                                                        </div>
                                                        <div class="col-6">
                                                            <label class="form-label">Last Import (CSV)</label>
                                                            <div class="text-muted" id="netboxLastImport">No imports yet</div>
                                                        </div>
                                                    </div>
                                                    <div class="row mb-3">
                                                        <div class="col-6">
                                                            <label class="form-label">API Statistics</label>
                                                            <div class="text-muted">
                                                                <span id="netboxApiDevices">0</span> Devices •
                                                                <span id="netboxApiSites">0</span> Sites
                                                            </div>
                                                        </div>
                                                        <div class="col-6">
                                                            <label class="form-label">CSV Statistics</label>
                                                            <div class="text-muted">
                                                                <span id="netboxCsvDevices">0</span> Devices Imported
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="mb-3">
                                                        <div class="alert alert-info mb-0">
                                                            <i class="fas fa-info-circle me-2"></i>
                                                            <small><strong>Coming Soon:</strong> API integration for automated device inventory</small>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="d-flex justify-content-between">
                                                    <div class="d-flex gap-2">
                                                        <button type="button" class="btn btn-outline-info" id="syncNetboxNow" disabled>
                                                            <i class="fas fa-sync me-2"></i>Sync Now
                                                        </button>
                                                        <button type="button" class="btn btn-outline-info" id="importNetboxCsvBtn" disabled>
                                                            <i class="fas fa-upload me-2"></i>CSV Import
                                                        </button>
                                                    </div>
                                                    <button type="button" class="btn btn-outline-primary" id="manageNetboxCredentials" disabled>
                                                        <i class="fas fa-key me-2"></i>Configure Credentials
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Tenable Integration (HEX-233) -->
                                    <div class="col-lg-6 mb-4" data-integration="tenable">
                                        <div class="card">
                                            <div class="card-header">
                                                <h6 class="card-title mb-0">
                                                    <i class="fas fa-shield-virus me-2 text-success"></i>
                                                    Tenable
                                                </h6>
                                            </div>
                                            <div class="card-body d-flex flex-column">
                                                <div class="flex-grow-1">
                                                    <div class="row mb-3">
                                                        <div class="col-6">
                                                            <label class="form-label">Last Sync (API)</label>
                                                            <div class="text-muted" id="tenableLastSync">Never synced</div>
                                                        </div>
                                                        <div class="col-6">
                                                            <label class="form-label">Last Import (CSV)</label>
                                                            <div class="text-muted" id="tenableLastImport">No imports yet</div>
                                                        </div>
                                                    </div>
                                                    <div class="row mb-3">
                                                        <div class="col-6">
                                                            <label class="form-label">API Statistics</label>
                                                            <div class="text-muted">
                                                                <span id="tenableApiVulns">0</span> Vulnerabilities •
                                                                <span id="tenableApiScans">0</span> Scans
                                                            </div>
                                                        </div>
                                                        <div class="col-6">
                                                            <label class="form-label">CSV Statistics</label>
                                                            <div class="text-muted">
                                                                <span id="tenableCsvVulns">0</span> Vulnerabilities Imported
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="mb-3">
                                                        <div class="alert alert-info mb-0">
                                                            <i class="fas fa-info-circle me-2"></i>
                                                            <small><strong>Coming Soon:</strong> API integration for automated vulnerability scanning</small>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="d-flex justify-content-between">
                                                    <div class="d-flex gap-2">
                                                        <button type="button" class="btn btn-outline-success" id="syncTenableNow" disabled>
                                                            <i class="fas fa-sync me-2"></i>Sync Now
                                                        </button>
                                                        <button type="button" class="btn btn-success" id="importCsvBtn">
                                                            <i class="fas fa-upload me-2"></i>CSV Import
                                                        </button>
                                                    </div>
                                                    <button type="button" class="btn btn-outline-primary" id="manageTenableCredentials" disabled>
                                                        <i class="fas fa-key me-2"></i>Configure Credentials
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Data Management Section -->
                            <div id="dataManagementContent" style="display: none;">
                                <div class="row">
                                    <!-- Database Statistics -->
                                    <div class="col-12 mb-4">
                                        <div class="card">
                                            <div class="card-header">
                                                <h6 class="card-title mb-0">
                                                    <i class="fas fa-chart-bar me-2 text-primary"></i>
                                                    Database Statistics
                                                </h6>
                                            </div>
                                            <div class="card-body">
                                                <div class="row text-center" id="databaseStats">
                                                    <div class="col-md-3">
                                                        <div class="mb-2">
                                                            <i class="fas fa-ticket-alt text-success fs-2"></i>
                                                        </div>
                                                        <div class="text-muted">Tickets</div>
                                                        <div class="h3 mb-0" id="ticketCount">-</div>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <div class="mb-2">
                                                            <i class="fas fa-shield-virus text-danger fs-2"></i>
                                                        </div>
                                                        <div class="text-muted">Vulnerabilities</div>
                                                        <div class="h3 mb-0" id="vulnCount">-</div>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <div class="mb-2">
                                                            <i class="fas fa-database text-info fs-2"></i>
                                                        </div>
                                                        <div class="text-muted">Total Records</div>
                                                        <div class="h3 mb-0" id="totalCount">-</div>
                                                    </div>
                                                    <div class="col-md-3">
                                                        <div class="mb-2">
                                                            <i class="fas fa-hard-drive text-warning fs-2"></i>
                                                        </div>
                                                        <div class="text-muted">Database Size</div>
                                                        <div class="h3 mb-0" id="dbSize">-</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Module-specific Data Management -->
                                    <div class="col-lg-6 mb-4">
                                        <div class="card">
                                            <div class="card-header bg-success-subtle">
                                                <h6 class="card-title mb-0">
                                                    <i class="fas fa-ticket-alt me-2 text-success"></i>
                                                    Tickets Management
                                                </h6>
                                            </div>
                                            <div class="card-body">
                                                <div class="d-grid gap-2">
                                                    <button type="button" class="btn btn-outline-primary" onclick="window.backupModalManager.showTicketsBackupModal()">
                                                        <i class="fas fa-archive me-2"></i>Ticket Backups
                                                    </button>
                                                    <button type="button" class="btn btn-outline-danger" onclick="clearData('tickets')">
                                                        <i class="fas fa-trash me-2"></i>Clear Tickets
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="col-lg-6 mb-4">
                                        <div class="card">
                                            <div class="card-header bg-danger-subtle">
                                                <h6 class="card-title mb-0">
                                                    <i class="fas fa-shield-virus me-2 text-danger"></i>
                                                    Vulnerabilities Management
                                                </h6>
                                            </div>
                                            <div class="card-body">
                                                <div class="d-grid gap-2">
                                                    <button type="button" class="btn btn-outline-primary" onclick="window.backupModalManager.showVulnerabilitiesBackupModal()">
                                                        <i class="fas fa-archive me-2"></i>Vulnerability Backups
                                                    </button>
                                                    <button type="button" class="btn btn-outline-danger" onclick="clearData('vulnerabilities')">
                                                        <i class="fas fa-trash me-2"></i>Clear Vulnerabilities
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- User Preferences Management (HEX-303) -->
                                    <div class="col-lg-6 mb-4">
                                        <div class="card">
                                            <div class="card-header bg-info-subtle">
                                                <h6 class="card-title mb-0">
                                                    <i class="fas fa-user-cog me-2 text-info"></i>
                                                    User Preferences Management
                                                </h6>
                                            </div>
                                            <div class="card-body">
                                                <div class="mb-3">
                                                    <small class="text-muted">
                                                        Export/import your personal settings (theme, templates, UI preferences).
                                                        Credentials and API keys are never exported for security.
                                                    </small>
                                                </div>
                                                <div class="d-grid gap-2">
                                                    <button type="button" class="btn btn-outline-primary" onclick="exportUserPreferences()">
                                                        <i class="fas fa-download me-2"></i>Export User Settings
                                                    </button>
                                                    <button type="button" class="btn btn-outline-primary" onclick="importUserPreferences()">
                                                        <i class="fas fa-upload me-2"></i>Restore User Settings
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Global System Operations (HEX-303 - Redesigned) -->
                                    <div class="col-lg-6 mb-4">
                                        <div class="card border-danger">
                                            <div class="card-header bg-danger-subtle">
                                                <h6 class="card-title mb-0 text-dark">
                                                    <i class="fas fa-exclamation-triangle me-2"></i>
                                                    Global System Operations
                                                </h6>
                                            </div>
                                            <div class="card-body">
                                                <div class="alert alert-danger mb-3">
                                                    <i class="fas fa-exclamation-triangle me-2"></i>
                                                    <strong>Danger Zone:</strong> These operations affect the entire system and cannot be undone.
                                                </div>
                                                <div class="d-grid gap-2">
                                                    <button type="button" class="btn btn-warning w-100" onclick="refreshStats()">
                                                        <i class="fas fa-sync me-2"></i>Refresh Statistics
                                                    </button>
                                                    <button type="button" class="btn btn-danger w-100" onclick="clearAllData()">
                                                        <i class="fas fa-radiation me-2"></i>Clear All Data & Reset Admin
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- System Configuration Section -->
                            <div id="systemConfigContent" style="display: none;">
                                <div class="row">
                                    <!-- Future Features Placeholder -->
                                    <div class="col-12 mb-4">
                                        <div class="card">
                                            <div class="card-header">
                                                <h6 class="card-title mb-0">
                                                    <i class="fas fa-cogs me-2 text-secondary"></i>
                                                    System Configuration
                                                </h6>
                                            </div>
                                            <div class="card-body">
                                                <div class="alert alert-info">
                                                    <i class="fas fa-info-circle me-2"></i>
                                                    <strong>Coming Soon:</strong> User/ID Management, SNMP Polling, and additional system configuration options will be available here.
                                                </div>
                                                
                                                <!-- Placeholder cards for future features -->
                                                <div class="row">
                                                    <div class="col-md-6">
                                                        <div class="card border-dashed border-secondary">
                                                            <div class="card-body text-center text-muted">
                                                                <i class="fas fa-users fs-1 mb-3"></i>
                                                                <h6>User Management</h6>
                                                                <p class="small">Configure user accounts, roles, and permissions</p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-6">
                                                        <div class="card border-dashed border-secondary">
                                                            <div class="card-body text-center text-muted">
                                                                <i class="fas fa-network-wired fs-1 mb-3"></i>
                                                                <h6>SNMP Polling</h6>
                                                                <p class="small">Configure SNMP monitoring and polling intervals</p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="saveSettings">
                    <i class="fas fa-save me-2"></i>Save Settings
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Cisco Credentials Management Modal -->
<div class="modal fade" id="ciscoCredentialsModal" tabindex="-1" data-bs-backdrop="static">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="fas fa-key me-2 text-primary"></i>
                    Cisco PSIRT API Credentials
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="alert alert-info">
                    <i class="fas fa-info-circle me-2"></i>
                    <strong>Security:</strong> Credentials are encrypted and stored securely in the database.
                </div>
                <div class="mb-3">
                    <label for="ciscoClientIdInput" class="form-label">Client ID</label>
                    <input type="password" class="form-control" id="ciscoClientIdInput"
                           name="cisco-api-client-id"
                           placeholder="Enter Cisco PSIRT Client ID"
                           autocomplete="off"
                           data-lpignore="true"
                           data-form-type="other">
                    <div class="form-text">
                        Your Cisco PSIRT OAuth2 Client ID (masked for security)
                    </div>
                </div>
                <div class="mb-3">
                    <label for="ciscoClientSecretInput" class="form-label">Client Secret</label>
                    <input type="password" class="form-control" id="ciscoClientSecretInput"
                           name="cisco-api-client-secret"
                           placeholder="Enter Client Secret"
                           autocomplete="new-password"
                           data-lpignore="true"
                           data-form-type="other">
                    <div class="form-text">
                        Your Cisco PSIRT OAuth2 Client Secret (masked for security)
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-outline-danger" id="clearCiscoCredentialsBtn">
                    <i class="fas fa-trash me-2"></i>Clear Credentials
                </button>
                <button type="button" class="btn btn-primary" id="saveCiscoCredentialsBtn">
                    <i class="fas fa-save me-2"></i>Save Credentials
                </button>
            </div>
        </div>
    </div>
</div>

<!-- HEX-270: Backup Modals -->

<!-- Tickets Backup Modal -->
<div class="modal fade" id="ticketsBackupModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-success-subtle">
                <h5 class="modal-title">
                    <i class="fas fa-ticket-alt me-2 text-success"></i>
                    Tickets Backup Management
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body" id="ticketsBackupModalBody">
                <!-- Content dynamically generated by BackupModalManager -->
            </div>
            <div class="modal-footer d-flex justify-content-between align-items-start">
                <!-- Left side: Queue Backup button with status above -->
                <div>
                    <div class="mb-2">
                        <small class="text-muted" id="ticketsBackupStatus">Ready to create backup</small>
                    </div>
                    <button type="button" class="btn btn-warning" id="queueTicketsBackup" onclick="window.backupModalManager.queueBackup('tickets')">
                        <i class="fas fa-plus-circle me-1"></i>Queue Backup
                    </button>
                </div>

                <!-- Right side: Restore buttons with Close at far right -->
                <div class="d-flex gap-2">
                    <button type="button" class="btn btn-outline-primary" onclick="window.backupModalManager.restoreFromFile('tickets')">
                        <i class="fas fa-upload me-1"></i>Restore from File
                    </button>
                    <button type="button" class="btn btn-primary" id="restoreTicketsFromServer" onclick="window.backupModalManager.restoreFromServer('tickets')" disabled>
                        <i class="fas fa-cloud-download-alt me-1"></i>Restore from Server
                    </button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Vulnerabilities Backup Modal -->
<div class="modal fade" id="vulnerabilitiesBackupModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-danger-subtle">
                <h5 class="modal-title">
                    <i class="fas fa-shield-virus me-2 text-danger"></i>
                    Vulnerabilities Backup Management
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body" id="vulnerabilitiesBackupModalBody">
                <!-- Content dynamically generated by BackupModalManager -->
            </div>
            <div class="modal-footer d-flex justify-content-between align-items-start">
                <!-- Left side: Queue Backup button with status above -->
                <div>
                    <div class="mb-2">
                        <small class="text-muted" id="vulnerabilitiesBackupStatus">Ready to create backup</small>
                    </div>
                    <button type="button" class="btn btn-warning" id="queueVulnerabilitiesBackup" onclick="window.backupModalManager.queueBackup('vulnerabilities')">
                        <i class="fas fa-plus-circle me-1"></i>Queue Backup
                    </button>
                </div>

                <!-- Right side: Restore buttons with Close at far right -->
                <div class="d-flex gap-2">
                    <button type="button" class="btn btn-outline-primary" onclick="window.backupModalManager.restoreFromFile('vulnerabilities')">
                        <i class="fas fa-upload me-1"></i>Restore from File
                    </button>
                    <button type="button" class="btn btn-primary" id="restoreVulnerabilitiesFromServer" onclick="window.backupModalManager.restoreFromServer('vulnerabilities')" disabled>
                        <i class="fas fa-cloud-download-alt me-1"></i>Restore from Server
                    </button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Database Backup Modal -->
<div class="modal fade" id="databaseBackupModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-warning-subtle">
                <h5 class="modal-title">
                    <i class="fas fa-database me-2 text-warning"></i>
                    Database Backup Management
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body" id="databaseBackupModalBody">
                <!-- Content dynamically generated by BackupModalManager -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" onclick="window.backupModalManager.uploadBackup('all')">
                    <i class="fas fa-upload me-1"></i>Restore Database
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Settings Modal libraries are loaded by parent pages -->
