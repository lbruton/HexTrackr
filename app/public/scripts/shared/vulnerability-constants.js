/**
 * Vulnerability Color Constants
 * Single source of truth for VPR severity colors
 * These values match the CSS variables defined in css-variables.css
 *
 * @fileoverview VPR color definitions and utility functions for HexTrackr
 * @version 1.0.0
 * @since 2025-09-20
 */

/* eslint-env browser, node */
/* global document, getComputedStyle, module */

const VPR_COLORS = {
    critical: {
        name: "Critical",
        light: "#dc2626",  // red-600
        dark: "#ef4444",   // red-500
        rgb: {
            light: "220, 38, 38",
            dark: "239, 68, 68"
        },
        cssVar: "--vpr-critical",
        textClass: "text-vpr-critical",
        bgClass: "bg-vpr-critical",
        borderClass: "border-vpr-critical",
        icon: "ti-alert-triangle",
        priority: 1
    },
    high: {
        name: "High",
        light: "#d97706",  // amber-600 (adjusted for WCAG)
        dark: "#f97316",   // orange-500
        rgb: {
            light: "217, 119, 6",
            dark: "249, 115, 22"
        },
        cssVar: "--vpr-high",
        textClass: "text-vpr-high",
        bgClass: "bg-vpr-high",
        borderClass: "border-vpr-high",
        icon: "ti-alert-circle",
        priority: 2
    },
    medium: {
        name: "Medium",
        light: "#2563eb",  // blue-600
        dark: "#3b82f6",   // blue-500
        rgb: {
            light: "37, 99, 235",
            dark: "59, 130, 246"
        },
        cssVar: "--vpr-medium",
        textClass: "text-vpr-medium",
        bgClass: "bg-vpr-medium",
        borderClass: "border-vpr-medium",
        icon: "ti-info-circle",
        priority: 3
    },
    low: {
        name: "Low",
        light: "#16a34a",  // green-600
        dark: "#22c55e",   // green-500
        rgb: {
            light: "22, 163, 74",
            dark: "34, 197, 94"
        },
        cssVar: "--vpr-low",
        textClass: "text-vpr-low",
        bgClass: "bg-vpr-low",
        borderClass: "border-vpr-low",
        icon: "ti-check-circle",
        priority: 4
    }
};

/**
 * Get severity colors for the current theme
 * @param {string} theme - 'light' or 'dark'
 * @returns {Array<string>} Array of hex color values
 */
function getVPRColors(theme = "light") {
    return [
        VPR_COLORS.critical[theme],
        VPR_COLORS.high[theme],
        VPR_COLORS.medium[theme],
        VPR_COLORS.low[theme]
    ];
}

/**
 * Get color configuration for a specific severity
 * @param {string} severity - 'critical', 'high', 'medium', or 'low'
 * @param {string} theme - 'light' or 'dark'
 * @returns {Object} Color configuration object
 */
function getSeverityColor(severity, theme = "light") {
    const severityLower = severity.toLowerCase();
    if (VPR_COLORS[severityLower]) {
        return {
            hex: VPR_COLORS[severityLower][theme],
            rgb: VPR_COLORS[severityLower].rgb[theme],
            cssVar: VPR_COLORS[severityLower].cssVar,
            textClass: VPR_COLORS[severityLower].textClass,
            bgClass: VPR_COLORS[severityLower].bgClass,
            borderClass: VPR_COLORS[severityLower].borderClass
        };
    }
    return null;
}

/**
 * Get colors from CSS variables (dynamic, theme-aware)
 *
 * Retrieves the standard VPR color values from CSS custom properties.
 * For enhanced accessibility, use the contrast variants: --vpr-{severity}-contrast
 *
 * @returns {Array<string>} Array of hex color values from CSS [critical, high, medium, low]
 * @see css-variables.css for all available VPR color variants including contrast versions
 */
function getVPRColorsFromCSS() {
    const root = document.documentElement;
    const style = getComputedStyle(root);
    return [
        style.getPropertyValue("--vpr-critical").trim(),
        style.getPropertyValue("--vpr-high").trim(),
        style.getPropertyValue("--vpr-medium").trim(),
        style.getPropertyValue("--vpr-low").trim()
    ];
}

/**
 * Get WCAG contrast-optimized VPR colors from CSS variables
 *
 * Retrieves the high-contrast VPR color variants designed for enhanced accessibility
 * and better WCAG AA compliance. Use these variants when better contrast is required.
 *
 * @returns {Array<string>} Array of hex color values from CSS [critical, high, medium, low]
 * @see css-variables.css for standard vs contrast VPR color definitions
 */
function getVPRContrastColorsFromCSS() {
    const root = document.documentElement;
    const style = getComputedStyle(root);
    return [
        style.getPropertyValue("--vpr-critical-contrast").trim(),
        style.getPropertyValue("--vpr-high-contrast").trim(),
        style.getPropertyValue("--vpr-medium-contrast").trim(),
        style.getPropertyValue("--vpr-low-contrast").trim()
    ];
}

/**
 * Get the current theme from document body
 * @returns {string} 'light' or 'dark'
 */
function getCurrentTheme() {
    return document.body.getAttribute("data-theme") || "light";
}

// Export for use in other modules if using ES6 modules
if (typeof module !== "undefined" && module.exports) {
    module.exports = {
        VPR_COLORS,
        getVPRColors,
        getSeverityColor,
        getVPRColorsFromCSS,
        getCurrentTheme
    };
}