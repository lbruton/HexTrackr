<!-- Fragment template for documentation content injected by docs-tabler.js -->
<section class="doc-fragment">
    <h1>Frontend API Reference</h1><blockquote>
<p>Complete documentation for HexTrackr&#39;s frontend architecture, including page managers, shared components, and utilities</p>
</blockquote>
<h2>Overview</h2><p>HexTrackr&#39;s frontend uses vanilla JavaScript with a modular, class-based architecture. Components follow a consistent pattern using ES6 modules, with clear separation between page-specific logic, shared components, and utilities.</p>
<p><strong>Core Technologies:</strong></p>
<ul>
<li>Vanilla JavaScript (ES6+)</li>
<li>AG-Grid for data tables</li>
<li>ApexCharts for visualizations</li>
<li>Tabler.io CSS framework</li>
<li>WebSocket for real-time updates</li>
</ul>
<hr>
<h2 id="page-components">Page Components</h2><p>Page components manage the main functionality for each application page.</p>
<h3>VulnerabilitiesPage</h3><p><strong>Location:</strong> <code>app/public/scripts/pages/vulnerabilities.js</code></p>
<p>The main vulnerability management interface.</p>
<p><strong>Key Features:</strong></p>
<ul>
<li>Real-time vulnerability grid with AG-Grid</li>
<li>Interactive charts and statistics</li>
<li>CSV import with progress tracking</li>
<li>Advanced filtering and search</li>
<li>WebSocket integration for live updates</li>
</ul>
<p><strong>Main Components:</strong></p>
<ul>
<li><code>ModernVulnManager</code> - Main orchestrator class</li>
<li><code>VulnerabilityCoreOrchestrator</code> - Central module coordinator (Phase 2 modularization)</li>
<li><code>VulnerabilityDataManager</code> - Data operations</li>
<li><code>VulnerabilityGridManager</code> - AG-Grid integration</li>
<li><code>VulnerabilityChartManager</code> - ApexCharts visualizations</li>
</ul>
<p><strong>Initialization:</strong></p>
<pre><code class="language-javascript"><span class="hljs-comment">// Auto-initializes on DOMContentLoaded</span>
<span class="hljs-keyword">const</span> vulnManager = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ModernVulnManager</span>();</code></pre><p><strong>Key Methods:</strong></p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Purpose</th>
</tr>
</thead>
<tbody><tr>
<td><code>init()</code></td>
<td>Initialize all components and load data</td>
</tr>
<tr>
<td><code>loadVulnerabilities()</code></td>
<td>Fetch and display vulnerability data</td>
</tr>
<tr>
<td><code>setupEventListeners()</code></td>
<td>Configure UI interactions</td>
</tr>
<tr>
<td><code>handleImport()</code></td>
<td>Manage CSV import process</td>
</tr>
<tr>
<td><code>applyFilters()</code></td>
<td>Apply search and filter criteria</td>
</tr>
<tr>
<td><code>exportData()</code></td>
<td>Export filtered data to CSV</td>
</tr>
</tbody></table>
<h3>VulnerabilityCoreOrchestrator</h3><p><strong>Location:</strong> <code>app/public/scripts/shared/vulnerability-core.js</code><br><strong>Since:</strong> Phase 2 Modularization (T004)</p>
<p>Central coordination hub for the vulnerability management system. Implements the <strong>modular orchestrator pattern</strong> that provides clean separation of concerns and event-driven communication between specialized modules.</p>
<p><strong>Key Responsibilities:</strong></p>
<ul>
<li><strong>Module Lifecycle Management</strong>: Creates and initializes all specialized managers</li>
<li><strong>Inter-Module Communication</strong>: Coordinates data flow between modules via event system</li>
<li><strong>State Synchronization</strong>: Ensures consistent state across all components</li>
<li><strong>Cross-Cutting Concerns</strong>: Handles WebSocket integration, theme changes, error handling</li>
<li><strong>Delegation Pattern</strong>: ModernVulnManager delegates all operations to orchestrator</li>
</ul>
<p><strong>Architecture Pattern:</strong></p>
<pre><code class="language-javascript"><span class="hljs-comment">// ModernVulnManager creates orchestrator</span>
<span class="hljs-variable language_">this</span>.<span class="hljs-property">coreOrchestrator</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">VulnerabilityCoreOrchestrator</span>();
<span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">coreOrchestrator</span>.<span class="hljs-title function_">initializeAllModules</span>(<span class="hljs-variable language_">this</span>);

<span class="hljs-comment">// All operations delegated to orchestrator</span>
<span class="hljs-title function_">switchView</span>(<span class="hljs-params">view</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">coreOrchestrator</span>.<span class="hljs-title function_">switchView</span>(view);
}</code></pre><p><strong>Managed Modules:</strong></p>
<table>
<thead>
<tr>
<th>Module</th>
<th>Responsibility</th>
</tr>
</thead>
<tbody><tr>
<td><code>VulnerabilityDataManager</code></td>
<td>API communication, data caching</td>
</tr>
<tr>
<td><code>VulnerabilityStatisticsManager</code></td>
<td>Statistical calculations and analysis</td>
</tr>
<tr>
<td><code>VulnerabilityChartManager</code></td>
<td>ApexCharts visualization</td>
</tr>
<tr>
<td><code>VulnerabilitySearchManager</code></td>
<td>Search and filtering</td>
</tr>
<tr>
<td><code>VulnerabilityGridManager</code></td>
<td>AG-Grid table rendering</td>
</tr>
<tr>
<td><code>VulnerabilityCardsManager</code></td>
<td>Device card views</td>
</tr>
<tr>
<td><code>WebSocketClient</code></td>
<td>Real-time updates</td>
</tr>
<tr>
<td><code>ProgressModal</code></td>
<td>Long-running operation feedback</td>
</tr>
</tbody></table>
<p><strong>Core Methods:</strong></p>
<ul>
<li><code>initializeAllModules(parentContext)</code> - Single initialization point for all modules</li>
<li><code>setupDataManagerListeners()</code> - Coordinate cross-module data events</li>
<li><code>setupThemeListeners()</code> - Synchronize theme changes across components</li>
<li><code>switchView(view)</code> - Toggle between table and card views</li>
<li><code>loadData()</code> - Orchestrate data loading across all modules</li>
<li><code>viewDeviceDetails(hostname)</code> - Coordinate device detail modal</li>
<li><code>exportVulnerabilityReport()</code> - Generate CSV exports</li>
</ul>
<p><strong>Event Coordination:</strong></p>
<p>The orchestrator uses event-driven architecture to maintain loose coupling:</p>
<pre><code class="language-javascript"><span class="hljs-comment">// Data manager emits events</span>
<span class="hljs-variable language_">this</span>.<span class="hljs-property">dataManager</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;data-loaded&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">statisticsManager</span>.<span class="hljs-title function_">calculate</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">chartManager</span>.<span class="hljs-title function_">render</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">gridManager</span>.<span class="hljs-title function_">refresh</span>();
});

<span class="hljs-comment">// Theme changes propagate to all components</span>
<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setupThemeListeners</span>(); <span class="hljs-comment">// Updates grid, charts, modals</span></code></pre><p><strong>Benefits:</strong></p>
<ul>
<li><strong>Maintainability</strong>: Each module has single responsibility</li>
<li><strong>Testability</strong>: Modules can be tested independently</li>
<li><strong>Scalability</strong>: Easy to add new modules without touching existing code</li>
<li><strong>Debugging</strong>: Clear data flow and event tracking</li>
<li><strong>Performance</strong>: Efficient coordination prevents redundant operations</li>
</ul>
<h3>TicketsPage</h3><p><strong>Location:</strong> <code>app/public/scripts/pages/tickets.js</code></p>
<p>Support ticket management interface.</p>
<p><strong>Key Features:</strong></p>
<ul>
<li>Ticket CRUD operations</li>
<li>Device association management</li>
<li>Status workflow visualization</li>
<li>Priority-based sorting</li>
<li>Real-time updates</li>
</ul>
<p><strong>Main Components:</strong></p>
<ul>
<li><code>TicketManager</code> - Main ticket controller</li>
<li><code>TicketGrid</code> - AG-Grid configuration</li>
<li><code>DeviceModal</code> - Device management</li>
</ul>
<p><strong>Key Methods:</strong></p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Purpose</th>
</tr>
</thead>
<tbody><tr>
<td><code>init()</code></td>
<td>Initialize ticket interface</td>
</tr>
<tr>
<td><code>loadTickets()</code></td>
<td>Fetch and display tickets</td>
</tr>
<tr>
<td><code>createTicket()</code></td>
<td>Open new ticket modal</td>
</tr>
<tr>
<td><code>updateTicket()</code></td>
<td>Edit existing ticket</td>
</tr>
<tr>
<td><code>updateDevices()</code></td>
<td>Manage associated devices</td>
</tr>
<tr>
<td><code>deleteTicket()</code></td>
<td>Remove ticket with confirmation</td>
</tr>
</tbody></table>
<hr>
<h2 id="shared-components">Shared Components</h2><p>Reusable components used across multiple pages.</p>
<h3>ThemeController</h3><p><strong>Location:</strong> <code>app/public/scripts/shared/theme-controller.js</code></p>
<p>Manages light/dark theme switching with CSS variable updates.</p>
<p><strong>Features:</strong></p>
<ul>
<li>Persistent theme preference (localStorage)</li>
<li>Smooth transitions</li>
<li>Dynamic CSS variable updates</li>
<li>AG-Grid theme synchronization</li>
<li>Chart theme adaptation</li>
</ul>
<p><strong>Usage:</strong></p>
<pre><code class="language-javascript"><span class="hljs-keyword">const</span> themeController = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ThemeController</span>();
themeController.<span class="hljs-title function_">initializeToggle</span>();</code></pre><h3>AGGridResponsiveConfig</h3><p><strong>Location:</strong> <code>app/public/scripts/shared/ag-grid-responsive-config.js</code></p>
<p>Provides responsive AG-Grid configuration with theme support.</p>
<p><strong>Features:</strong></p>
<ul>
<li>Automatic theme detection</li>
<li>Responsive column sizing</li>
<li>Custom cell renderers</li>
<li>Export functionality</li>
<li>Pagination controls</li>
</ul>
<p><strong>Configuration Example:</strong></p>
<pre><code class="language-javascript"><span class="hljs-keyword">const</span> gridOptions = <span class="hljs-title class_">AGGridResponsiveConfig</span>.<span class="hljs-title function_">getDefaultGridOptions</span>({
    <span class="hljs-attr">columnDefs</span>: [...],
    <span class="hljs-attr">rowData</span>: [...],
    <span class="hljs-attr">onGridReady</span>: <span class="hljs-function">(<span class="hljs-params">params</span>) =&gt;</span> {...}
});</code></pre><h3>AGGridThemeManager</h3><p><strong>Location:</strong> <code>app/public/scripts/shared/ag-grid-theme-manager.js</code><br><strong>Since:</strong> v1.0.40+</p>
<p>Centralized theme management for all AG-Grid instances across the application.</p>
<p><strong>Key Features:</strong></p>
<ul>
<li><strong>Unified Theme Control</strong>: Single source of truth for grid themes across all pages</li>
<li><strong>Dynamic Theme Switching</strong>: Instant theme updates without page reload</li>
<li><strong>Cross-Tab Synchronization</strong>: Theme changes propagate across browser tabs via localStorage events</li>
<li><strong>Grid Instance Registry</strong>: Tracks all active grid instances for coordinated updates</li>
<li><strong>Dark Mode Surface Hierarchy</strong>: Implements proper surface elevation for dark mode (base → surface-1 → surface-2)</li>
</ul>
<p><strong>Architecture Pattern:</strong></p>
<pre><code class="language-javascript"><span class="hljs-comment">// Register grid instance on creation</span>
<span class="hljs-title class_">AGGridThemeManager</span>.<span class="hljs-title function_">registerGrid</span>(gridApi, <span class="hljs-string">&#x27;vulnerabilities-grid&#x27;</span>);

<span class="hljs-comment">// Theme changes automatically update all registered grids</span>
<span class="hljs-title class_">AGGridThemeManager</span>.<span class="hljs-title function_">applyTheme</span>(<span class="hljs-string">&#x27;dark&#x27;</span>); <span class="hljs-comment">// Updates all grids instantly</span></code></pre><p><strong>Core Methods:</strong></p>
<ul>
<li><code>registerGrid(gridApi, gridId)</code> - Register new grid instance for theme management</li>
<li><code>unregisterGrid(gridId)</code> - Remove grid from theme tracking</li>
<li><code>applyTheme(theme)</code> - Apply theme to all registered grids</li>
<li><code>getCurrentTheme()</code> - Get active theme (&#39;light&#39; or &#39;dark&#39;)</li>
<li><code>setupCrossTabSync()</code> - Enable theme synchronization across browser tabs</li>
</ul>
<p><strong>Surface Hierarchy (Dark Mode):</strong></p>
<pre><code class="language-css"><span class="hljs-comment">/* Grid theme uses proper surface elevation */</span>
<span class="hljs-attr">--ag-background-color</span>: <span class="hljs-built_in">var</span>(--hextrackr-surface-<span class="hljs-number">2</span>);     <span class="hljs-comment">/* Table body */</span>
<span class="hljs-attr">--ag-header-background-color</span>: <span class="hljs-built_in">var</span>(--hextrackr-surface-<span class="hljs-number">1</span>); <span class="hljs-comment">/* Headers */</span>
<span class="hljs-attr">--ag-row-hover-color</span>: <span class="hljs-built_in">var</span>(--hextrackr-surface-<span class="hljs-number">3</span>);     <span class="hljs-comment">/* Hover state */</span></code></pre><p><strong>Cross-Tab Sync:</strong></p>
<pre><code class="language-javascript"><span class="hljs-comment">// Automatic sync via localStorage events</span>
<span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;storage&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (e.<span class="hljs-property">key</span> === <span class="hljs-string">&#x27;hextrackr-theme&#x27;</span>) {
        <span class="hljs-title class_">AGGridThemeManager</span>.<span class="hljs-title function_">applyTheme</span>(e.<span class="hljs-property">newValue</span>);
    }
});</code></pre><h3>PaginationController</h3><p><strong>Location:</strong> <code>app/public/scripts/shared/pagination-controller.js</code><br><strong>Since:</strong> v1.0.42 (HEX-112)</p>
<p>User-facing pagination controls for device cards and large datasets.</p>
<p><strong>Key Features:</strong></p>
<ul>
<li><strong>Dynamic Page Size</strong>: User-selectable rows per page (10, 25, 50, 100)</li>
<li><strong>Page Navigation</strong>: First, Previous, Next, Last buttons with keyboard shortcuts</li>
<li><strong>Status Display</strong>: &quot;Showing X-Y of Z results&quot; with real-time updates</li>
<li><strong>Responsive Design</strong>: Mobile-friendly pagination controls</li>
<li><strong>State Persistence</strong>: Remembers user&#39;s page size preference</li>
</ul>
<p><strong>Usage:</strong></p>
<pre><code class="language-javascript"><span class="hljs-keyword">const</span> pagination = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PaginationController</span>({
    <span class="hljs-attr">itemsPerPage</span>: <span class="hljs-number">25</span>,
    <span class="hljs-attr">onPageChange</span>: <span class="hljs-function">(<span class="hljs-params">page, pageSize</span>) =&gt;</span> {
        <span class="hljs-title function_">renderPage</span>(page, pageSize);
    }
});

pagination.<span class="hljs-title function_">setTotalItems</span>(<span class="hljs-number">1245</span>); <span class="hljs-comment">// Update total count</span>
pagination.<span class="hljs-title function_">goToPage</span>(<span class="hljs-number">3</span>);         <span class="hljs-comment">// Navigate to specific page</span></code></pre><p><strong>Core Methods:</strong></p>
<ul>
<li><code>setTotalItems(count)</code> - Update total item count and recalculate pages</li>
<li><code>goToPage(pageNumber)</code> - Navigate to specific page</li>
<li><code>nextPage()</code> - Move to next page</li>
<li><code>previousPage()</code> - Move to previous page</li>
<li><code>setPageSize(size)</code> - Change items per page</li>
<li><code>getCurrentPage()</code> - Get active page number</li>
<li><code>getTotalPages()</code> - Get total page count</li>
</ul>
<p><strong>HTML Structure:</strong></p>
<pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;pagination-controls&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;pagination-info&quot;</span>&gt;</span>Showing 1-25 of 1,245 results<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;pagination-buttons&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn-first&quot;</span>&gt;</span>First<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn-prev&quot;</span>&gt;</span>Previous<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;page-indicator&quot;</span>&gt;</span>Page 1 of 50<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn-next&quot;</span>&gt;</span>Next<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn-last&quot;</span>&gt;</span>Last<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;page-size-selector&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;10&quot;</span>&gt;</span>10 per page<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;25&quot;</span> <span class="hljs-attr">selected</span>&gt;</span>25 per page<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;50&quot;</span>&gt;</span>50 per page<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;100&quot;</span>&gt;</span>100 per page<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></code></pre><h3>VulnerabilityDataManager</h3><p><strong>Location:</strong> <code>app/public/scripts/shared/vulnerability-data.js</code></p>
<p>Core data management for vulnerabilities.</p>
<p><strong>Responsibilities:</strong></p>
<ul>
<li>API communication</li>
<li>Data caching</li>
<li>Filter application</li>
<li>Sort operations</li>
<li>Export preparation</li>
</ul>
<p><strong>Key Methods:</strong></p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Purpose</th>
</tr>
</thead>
<tbody><tr>
<td><code>fetchVulnerabilities()</code></td>
<td>Load data from API</td>
</tr>
<tr>
<td><code>filterData()</code></td>
<td>Apply client-side filters</td>
</tr>
<tr>
<td><code>sortData()</code></td>
<td>Sort by various criteria</td>
</tr>
<tr>
<td><code>exportToCSV()</code></td>
<td>Generate CSV export</td>
</tr>
<tr>
<td><code>getCachedData()</code></td>
<td>Retrieve cached results</td>
</tr>
</tbody></table>
<h3>WebSocketClient</h3><p><strong>Location:</strong> <code>app/public/scripts/shared/websocket-client.js</code></p>
<p>Real-time communication handler.</p>
<p><strong>Features:</strong></p>
<ul>
<li>Auto-reconnection</li>
<li>Event-based messaging</li>
<li>Progress tracking</li>
<li>Error recovery</li>
<li>Connection state management</li>
</ul>
<p><strong>Events:</strong></p>
<table>
<thead>
<tr>
<th>Event</th>
<th>Purpose</th>
</tr>
</thead>
<tbody><tr>
<td><code>import-progress</code></td>
<td>CSV import updates</td>
</tr>
<tr>
<td><code>vulnerability-added</code></td>
<td>New vulnerability notification</td>
</tr>
<tr>
<td><code>ticket-updated</code></td>
<td>Ticket status change</td>
</tr>
<tr>
<td><code>connection-status</code></td>
<td>Connection state changes</td>
</tr>
</tbody></table>
<h3>ModalManager Classes</h3><p>Multiple modal components for different purposes:</p>
<h4>VulnerabilityDetailsModal</h4><p><strong>Location:</strong> <code>app/public/scripts/shared/vulnerability-details-modal.js</code><br><strong>Since:</strong> v1.0.22 (Enhanced v2.0 in HEX-151)</p>
<p>Displays detailed vulnerability information with integrated KEV checking and Cisco PSIRT lookup.</p>
<p><strong>Features:</strong></p>
<ul>
<li><strong>CVE Links and References</strong>: Direct links to NVD, MITRE, and vendor advisories</li>
<li><strong>CVSS Score Breakdown</strong>: Visual representation of CVSS metrics with explanations</li>
<li><strong>Remediation Guidance</strong>: Solution steps and patching recommendations</li>
<li><strong>Plugin Output Display</strong>: Raw scanner output with syntax highlighting</li>
<li><strong>Related Vulnerabilities</strong>: Shows other CVEs affecting the same device</li>
<li><strong>KEV Integration (v1.0.51)</strong>: Automatic CISA KEV lookup with visual indicators</li>
<li><strong>Cisco PSIRT Integration</strong>: Fixed version information for Cisco CVEs</li>
</ul>
<p><strong>KEV Modal Features (HEX-151 Enhancement):</strong></p>
<pre><code class="language-javascript"><span class="hljs-comment">// Automatic KEV lookup when modal opens</span>
<span class="hljs-keyword">async</span> <span class="hljs-title function_">showVulnerabilityDetails</span>(<span class="hljs-params">vulnId</span>) {
    <span class="hljs-keyword">const</span> vuln = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchVulnerability</span>(vulnId);

    <span class="hljs-comment">// Check if this CVE is in CISA KEV catalog</span>
    <span class="hljs-keyword">if</span> (vuln.<span class="hljs-property">cve</span>) {
        <span class="hljs-keyword">const</span> kevData = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetchKEVData</span>(vuln.<span class="hljs-property">cve</span>);
        <span class="hljs-keyword">if</span> (kevData.<span class="hljs-property">isKEV</span>) {
            <span class="hljs-title function_">displayKEVBanner</span>(kevData);
        }
    }

    <span class="hljs-title function_">displayVulnerabilityDetails</span>(vuln);
}</code></pre><p><strong>KEV Data Display:</strong></p>
<ul>
<li><strong>Ransomware Flag</strong>: Highlighted if CVE is known to be used in ransomware attacks</li>
<li><strong>Vendor Project</strong>: Shows affected vendor/product from CISA</li>
<li><strong>Date Added</strong>: When CISA added to KEV catalog</li>
<li><strong>Required Action</strong>: CISA&#39;s mandated remediation action</li>
<li><strong>Due Date</strong>: Federal agency remediation deadline</li>
<li><strong>Notes</strong>: Additional CISA context and warnings</li>
</ul>
<p><strong>Cisco PSIRT Display:</strong></p>
<ul>
<li><strong>Fixed Versions</strong>: Shows which software versions patch the vulnerability</li>
<li><strong>Advisory Link</strong>: Direct link to Cisco security advisory</li>
<li><strong>Platform Coverage</strong>: Lists affected platforms and fixed versions per platform</li>
</ul>
<h4>ProgressModal</h4><p><strong>Location:</strong> <code>app/public/scripts/shared/progress-modal.js</code></p>
<p>Shows progress for long-running operations.</p>
<p><strong>Features:</strong></p>
<ul>
<li>Real-time percentage updates</li>
<li>ETA calculation</li>
<li>Cancel capability</li>
<li>WebSocket integration</li>
</ul>
<h4>SettingsModal</h4><p><strong>Location:</strong> <code>app/public/scripts/shared/settings-modal.js</code></p>
<p>Global application settings interface.</p>
<p><strong>Features:</strong></p>
<ul>
<li>Theme preferences</li>
<li>Grid configuration</li>
<li>Export settings</li>
<li>Data management operations</li>
<li>Backup/restore functionality</li>
</ul>
<h4>DeviceSecurityModal</h4><p><strong>Location:</strong> <code>app/public/scripts/shared/device-security-modal.js</code></p>
<p>Device management for tickets.</p>
<p><strong>Features:</strong></p>
<ul>
<li>Device list editing</li>
<li>Bulk operations</li>
<li>Validation</li>
<li>Auto-save</li>
</ul>
<h3>ChartManager Components</h3><h4>VulnerabilityChartManager</h4><p><strong>Location:</strong> <code>app/public/scripts/shared/vulnerability-chart-manager.js</code></p>
<p>Manages ApexCharts visualizations.</p>
<p><strong>Charts:</strong></p>
<ul>
<li>Severity distribution (donut)</li>
<li>Trend analysis (line)</li>
<li>Top vulnerabilities (bar)</li>
<li>Risk matrix (heatmap)</li>
</ul>
<p><strong>Features:</strong></p>
<ul>
<li>Dynamic theme adaptation</li>
<li>Responsive sizing</li>
<li>Interactive tooltips</li>
<li>Export to image</li>
</ul>
<h4>VulnerabilityStatistics</h4><p><strong>Location:</strong> <code>app/public/scripts/shared/vulnerability-statistics.js</code></p>
<p>Statistical calculations and displays.</p>
<p><strong>Metrics:</strong></p>
<ul>
<li>Total vulnerabilities</li>
<li>Critical/High/Medium/Low counts</li>
<li>Average CVSS score</li>
<li>VPR distribution</li>
<li>Remediation progress</li>
</ul>
<h3>ToastManager</h3><p><strong>Location:</strong> <code>app/public/scripts/shared/toast-manager.js</code></p>
<p>Notification system for user feedback.</p>
<p><strong>Features:</strong></p>
<ul>
<li>Multiple severity levels</li>
<li>Auto-dismiss</li>
<li>Action buttons</li>
<li>Queue management</li>
<li>Accessibility support</li>
</ul>
<p><strong>Usage:</strong></p>
<pre><code class="language-javascript"><span class="hljs-title class_">ToastManager</span>.<span class="hljs-title function_">show</span>(<span class="hljs-string">&#x27;Operation successful&#x27;</span>, <span class="hljs-string">&#x27;success&#x27;</span>);
<span class="hljs-title class_">ToastManager</span>.<span class="hljs-title function_">show</span>(<span class="hljs-string">&#x27;Error occurred&#x27;</span>, <span class="hljs-string">&#x27;error&#x27;</span>, { <span class="hljs-attr">duration</span>: <span class="hljs-number">5000</span> });</code></pre><h3>HeaderManager</h3><p><strong>Location:</strong> <code>app/public/scripts/shared/header.js</code></p>
<p>Dynamic header with theme toggle and user menu.</p>
<p><strong>Components:</strong></p>
<ul>
<li>Theme toggle button</li>
<li>User dropdown</li>
<li>Navigation state</li>
<li>Notification badges</li>
</ul>
<h3>PreferencesService</h3><p><strong>Location:</strong> <code>app/public/scripts/shared/preferences-service.js</code><br><strong>Since:</strong> v1.0.48</p>
<p>Frontend client for user preferences API with local caching and synchronization.</p>
<p><strong>Key Features:</strong></p>
<ul>
<li><strong>API Integration</strong>: Communicates with <code>/api/preferences</code> endpoints</li>
<li><strong>Local Caching</strong>: IndexedDB storage for offline access</li>
<li><strong>Cross-Tab Sync</strong>: Preferences sync across browser tabs via storage events</li>
<li><strong>Automatic Save</strong>: Debounced saves to reduce API calls</li>
<li><strong>Typed Preferences</strong>: TypeScript-style preference definitions</li>
</ul>
<p><strong>Core Methods:</strong></p>
<pre><code class="language-javascript"><span class="hljs-comment">// Get preference (returns from cache if available)</span>
<span class="hljs-keyword">const</span> theme = <span class="hljs-keyword">await</span> <span class="hljs-title class_">PreferencesService</span>.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;dashboard.theme&#x27;</span>);
<span class="hljs-comment">// Returns: { mode: &quot;dark&quot;, accent: &quot;blue&quot; }</span>

<span class="hljs-comment">// Set preference (auto-saves to server)</span>
<span class="hljs-keyword">await</span> <span class="hljs-title class_">PreferencesService</span>.<span class="hljs-title function_">set</span>(<span class="hljs-string">&#x27;dashboard.theme&#x27;</span>, { <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;dark&#x27;</span>, <span class="hljs-attr">accent</span>: <span class="hljs-string">&#x27;blue&#x27;</span> });

<span class="hljs-comment">// Bulk update (single API call)</span>
<span class="hljs-keyword">await</span> <span class="hljs-title class_">PreferencesService</span>.<span class="hljs-title function_">bulkUpdate</span>({
    <span class="hljs-string">&#x27;dashboard.theme&#x27;</span>: { <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;dark&#x27;</span> },
    <span class="hljs-string">&#x27;dashboard.defaultView&#x27;</span>: <span class="hljs-string">&#x27;grid&#x27;</span>,
    <span class="hljs-string">&#x27;notifications.enabled&#x27;</span>: <span class="hljs-literal">true</span>
});

<span class="hljs-comment">// Reset to defaults</span>
<span class="hljs-keyword">await</span> <span class="hljs-title class_">PreferencesService</span>.<span class="hljs-title function_">reset</span>();

<span class="hljs-comment">// Clear cache</span>
<span class="hljs-title class_">PreferencesService</span>.<span class="hljs-title function_">clearCache</span>();</code></pre><p><strong>Preference Keys:</strong></p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>dashboard.theme</code></td>
<td>Object</td>
<td>Theme settings (mode, accent)</td>
</tr>
<tr>
<td><code>dashboard.defaultView</code></td>
<td>String</td>
<td>Default view (&#39;grid&#39; or &#39;cards&#39;)</td>
</tr>
<tr>
<td><code>dashboard.chartMetric</code></td>
<td>String</td>
<td>Chart metric (&#39;vpr&#39; or &#39;count&#39;)</td>
</tr>
<tr>
<td><code>vulnerabilities.filters</code></td>
<td>Object</td>
<td>Saved filter configurations</td>
</tr>
<tr>
<td><code>vulnerabilities.pageSize</code></td>
<td>Number</td>
<td>Rows per page (10, 25, 50, 100)</td>
</tr>
<tr>
<td><code>notifications.enabled</code></td>
<td>Boolean</td>
<td>Enable/disable notifications</td>
</tr>
<tr>
<td><code>export.defaultFormat</code></td>
<td>String</td>
<td>Default export format (&#39;csv&#39;, &#39;json&#39;, &#39;pdf&#39;)</td>
</tr>
<tr>
<td><code>grid.columnState</code></td>
<td>Array</td>
<td>AG-Grid column visibility/order</td>
</tr>
</tbody></table>
<p><strong>Cross-Tab Synchronization:</strong></p>
<pre><code class="language-javascript"><span class="hljs-comment">// Automatic sync via storage events</span>
<span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;storage&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (e.<span class="hljs-property">key</span> === <span class="hljs-string">&#x27;hextrackr-preferences&#x27;</span>) {
        <span class="hljs-title class_">PreferencesService</span>.<span class="hljs-title function_">refreshFromStorage</span>();
        <span class="hljs-comment">// Trigger UI updates</span>
        <span class="hljs-title function_">applyPreferences</span>();
    }
});</code></pre><p><strong>Caching Strategy:</strong></p>
<ul>
<li><strong>IndexedDB</strong>: Primary cache for preferences (survives page reload)</li>
<li><strong>Memory Cache</strong>: In-memory map for fast reads during session</li>
<li><strong>TTL</strong>: Cache entries expire after 1 hour, force refresh from server</li>
<li><strong>Invalidation</strong>: Automatic cache invalidation on set/update operations</li>
</ul>
<h3>AuthState</h3><p><strong>Location:</strong> <code>app/public/scripts/shared/auth-state.js</code><br><strong>Since:</strong> v1.0.46</p>
<p>Frontend authentication state management with session monitoring.</p>
<p><strong>Key Features:</strong></p>
<ul>
<li><strong>Session Monitoring</strong>: Periodic checks for session validity</li>
<li><strong>Auto-Redirect</strong>: Redirects to login on session expiration</li>
<li><strong>User Profile Caching</strong>: Cached user data for performance</li>
<li><strong>CSRF Token Management</strong>: Automatic CSRF token refresh</li>
<li><strong>State Change Events</strong>: Emits events when auth state changes</li>
</ul>
<p><strong>Core Methods:</strong></p>
<pre><code class="language-javascript"><span class="hljs-comment">// Check authentication status</span>
<span class="hljs-keyword">const</span> isAuthenticated = <span class="hljs-keyword">await</span> <span class="hljs-title class_">AuthState</span>.<span class="hljs-title function_">checkAuth</span>();
<span class="hljs-comment">// Returns: true/false</span>

<span class="hljs-comment">// Get current user</span>
<span class="hljs-keyword">const</span> user = <span class="hljs-title class_">AuthState</span>.<span class="hljs-title function_">getCurrentUser</span>();
<span class="hljs-comment">// Returns: { id: 1, username: &quot;admin&quot;, email: &quot;...&quot;, ... }</span>

<span class="hljs-comment">// Get CSRF token for forms</span>
<span class="hljs-keyword">const</span> csrfToken = <span class="hljs-keyword">await</span> <span class="hljs-title class_">AuthState</span>.<span class="hljs-title function_">getCsrfToken</span>();
<span class="hljs-comment">// Returns: &quot;abc123...&quot;</span>

<span class="hljs-comment">// Logout</span>
<span class="hljs-keyword">await</span> <span class="hljs-title class_">AuthState</span>.<span class="hljs-title function_">logout</span>();
<span class="hljs-comment">// Clears session, redirects to login</span>

<span class="hljs-comment">// Session monitoring (auto-starts on page load)</span>
<span class="hljs-title class_">AuthState</span>.<span class="hljs-title function_">startSessionMonitor</span>(); <span class="hljs-comment">// Checks every 5 minutes</span>
<span class="hljs-title class_">AuthState</span>.<span class="hljs-title function_">stopSessionMonitor</span>();</code></pre><p><strong>Authentication Events:</strong></p>
<pre><code class="language-javascript"><span class="hljs-comment">// Listen for auth state changes</span>
<span class="hljs-title class_">AuthState</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;auth-changed&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (e.<span class="hljs-property">detail</span>.<span class="hljs-property">authenticated</span>) {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;User logged in:&#x27;</span>, e.<span class="hljs-property">detail</span>.<span class="hljs-property">user</span>);
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;User logged out&#x27;</span>);
        <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span> = <span class="hljs-string">&#x27;/login.html&#x27;</span>;
    }
});

<span class="hljs-comment">// Listen for session expiration</span>
<span class="hljs-title class_">AuthState</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;session-expired&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-title class_">ToastManager</span>.<span class="hljs-title function_">show</span>(<span class="hljs-string">&#x27;Session expired. Please log in again.&#x27;</span>, <span class="hljs-string">&#x27;warning&#x27;</span>);
    <span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span> = <span class="hljs-string">&#x27;/login.html&#x27;</span>;
});</code></pre><p><strong>Session Monitor:</strong></p>
<pre><code class="language-javascript"><span class="hljs-comment">// Automatic session checking (every 5 minutes)</span>
<span class="hljs-built_in">setInterval</span>(<span class="hljs-title function_">async</span> () =&gt; {
    <span class="hljs-keyword">const</span> status = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;/api/auth/status&#x27;</span>);
    <span class="hljs-keyword">if</span> (!status.<span class="hljs-property">authenticated</span>) {
        <span class="hljs-title class_">AuthState</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">&#x27;session-expired&#x27;</span>);
    }
}, <span class="hljs-number">300000</span>); <span class="hljs-comment">// 5 minutes</span></code></pre><p><strong>CSRF Token Integration:</strong></p>
<pre><code class="language-javascript"><span class="hljs-comment">// Automatically adds CSRF token to API requests</span>
<span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">apiCall</span>(<span class="hljs-params">endpoint, method, data</span>) {
    <span class="hljs-keyword">const</span> token = <span class="hljs-keyword">await</span> <span class="hljs-title class_">AuthState</span>.<span class="hljs-title function_">getCsrfToken</span>();

    <span class="hljs-keyword">return</span> <span class="hljs-title function_">fetch</span>(endpoint, {
        method,
        <span class="hljs-attr">headers</span>: {
            <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;application/json&#x27;</span>,
            <span class="hljs-string">&#x27;X-CSRF-Token&#x27;</span>: token
        },
        <span class="hljs-attr">body</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data)
    });
}</code></pre><hr>
<h2 id="utilities">Utilities</h2><p>Helper functions and security utilities.</p>
<h3>VendorFilterUI</h3><p><strong>Location:</strong> <code>app/public/scripts/shared/vendor-filter-ui.js</code><br><strong>Since:</strong> v1.0.53 (HEX-156)</p>
<p>Manages vendor filtering UI with bidirectional synchronization between radio buttons and dropdown.</p>
<p><strong>Key Features:</strong></p>
<ul>
<li><strong>Dual Control Sync</strong>: Radio button toggles and dropdown select stay synchronized</li>
<li><strong>Infinite Loop Prevention</strong>: Smart event handling prevents circular updates</li>
<li><strong>Dashboard Integration</strong>: Updates statistics cards and charts when vendor changes</li>
<li><strong>Table/Card Filtering</strong>: Synchronizes with AG-Grid and card view filters</li>
<li><strong>URL State Persistence</strong>: Maintains filter state in query parameters</li>
</ul>
<p><strong>Architecture Pattern:</strong></p>
<pre><code class="language-javascript"><span class="hljs-comment">// Radio buttons → Dropdown sync</span>
vendorRadios.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">radio</span> =&gt;</span> {
    radio.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;change&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
        <span class="hljs-keyword">const</span> vendor = e.<span class="hljs-property">target</span>.<span class="hljs-property">dataset</span>.<span class="hljs-property">vendor</span>;

        <span class="hljs-comment">// Sync dropdown (prevent infinite loop)</span>
        <span class="hljs-keyword">if</span> (vendorDropdown.<span class="hljs-property">value</span> !== vendor) {
            vendorDropdown.<span class="hljs-property">value</span> = vendor;
            vendorDropdown.<span class="hljs-title function_">dispatchEvent</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Event</span>(<span class="hljs-string">&#x27;change&#x27;</span>));
        }

        <span class="hljs-comment">// Update dashboard</span>
        <span class="hljs-title function_">updateStatistics</span>(vendor);
        <span class="hljs-title function_">updateChart</span>(vendor);
    });
});

<span class="hljs-comment">// Dropdown → Radio buttons sync</span>
vendorDropdown.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;change&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> vendor = e.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>;

    <span class="hljs-comment">// Find matching radio button</span>
    <span class="hljs-keyword">const</span> matchingRadio = <span class="hljs-title function_">findRadioByVendor</span>(vendor);
    <span class="hljs-keyword">if</span> (matchingRadio &amp;&amp; !matchingRadio.<span class="hljs-property">checked</span>) {
        matchingRadio.<span class="hljs-property">checked</span> = <span class="hljs-literal">true</span>;
        matchingRadio.<span class="hljs-title function_">dispatchEvent</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Event</span>(<span class="hljs-string">&#x27;change&#x27;</span>));
    }
});</code></pre><p><strong>Vendor Values:</strong></p>
<ul>
<li>`` (empty string) - All Vendors</li>
<li><code>CISCO</code> - Cisco Systems</li>
<li><code>Palo Alto</code> - Palo Alto Networks</li>
<li><code>Other</code> - All other vendors</li>
</ul>
<p><strong>getCurrentVendor() Helper:</strong></p>
<pre><code class="language-javascript"><span class="hljs-comment">/**
 * Get currently selected vendor from radio buttons
 * <span class="hljs-doctag">@returns</span> {<span class="hljs-type">string</span>} Current vendor (&quot;&quot;, &quot;CISCO&quot;, &quot;Palo Alto&quot;, or &quot;Other&quot;)
 */</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">getCurrentVendor</span>(<span class="hljs-params"></span>) {
    <span class="hljs-keyword">const</span> checkedRadio = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;input[name=&quot;vendor-filter&quot;]:checked&#x27;</span>);
    <span class="hljs-keyword">if</span> (!checkedRadio) <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;

    <span class="hljs-keyword">const</span> label = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">`label[for=&quot;<span class="hljs-subst">${checkedRadio.id}</span>&quot;]`</span>);
    <span class="hljs-keyword">return</span> label ? (label.<span class="hljs-property">dataset</span>.<span class="hljs-property">vendor</span> || <span class="hljs-string">&quot;&quot;</span>) : <span class="hljs-string">&quot;&quot;</span>;
}</code></pre><p><strong>Integration Points:</strong></p>
<ul>
<li><strong>Statistics Cards</strong>: <code>updateStatisticsDisplay(vendor)</code> updates VPR card metrics</li>
<li><strong>Charts</strong>: <code>chartManager.update(false, vendor)</code> filters trend data</li>
<li><strong>Grid/Cards</strong>: <code>applyVendorFilter(vendor)</code> filters table/card results</li>
<li><strong>Chart Metric Toggle</strong>: Passes vendor to maintain filter when switching VPR sum ↔ vuln count</li>
</ul>
<h3>CVEUtilities</h3><p><strong>Location:</strong> <code>app/public/scripts/utils/cve-utilities.js</code><br><strong>Since:</strong> v1.0.22</p>
<p>CVE data processing, validation, and external API integration.</p>
<p><strong>Key Features:</strong></p>
<ul>
<li><strong>CVE ID Validation</strong>: Regex-based format validation (CVE-YYYY-NNNNN)</li>
<li><strong>External Links Generation</strong>: Creates links to NVD, MITRE, vendor databases</li>
<li><strong>KEV Integration</strong>: CISA KEV catalog lookup and caching</li>
<li><strong>Cisco PSIRT</strong>: Cisco security advisory lookup for CVE fixed versions</li>
<li><strong>Batch Processing</strong>: Efficient handling of multiple CVE lookups</li>
</ul>
<p><strong>Core Functions:</strong></p>
<pre><code class="language-javascript"><span class="hljs-comment">// CVE ID validation</span>
<span class="hljs-title class_">CVEUtilities</span>.<span class="hljs-title function_">isValidCVE</span>(<span class="hljs-string">&#x27;CVE-2024-12345&#x27;</span>)  <span class="hljs-comment">// true</span>
<span class="hljs-title class_">CVEUtilities</span>.<span class="hljs-title function_">isValidCVE</span>(<span class="hljs-string">&#x27;CVE-24-123&#x27;</span>)      <span class="hljs-comment">// false</span>

<span class="hljs-comment">// External link generation</span>
<span class="hljs-title class_">CVEUtilities</span>.<span class="hljs-title function_">getNVDLink</span>(<span class="hljs-string">&#x27;CVE-2024-12345&#x27;</span>)
<span class="hljs-comment">// → https://nvd.nist.gov/vuln/detail/CVE-2024-12345</span>

<span class="hljs-title class_">CVEUtilities</span>.<span class="hljs-title function_">getMITRELink</span>(<span class="hljs-string">&#x27;CVE-2024-12345&#x27;</span>)
<span class="hljs-comment">// → https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-12345</span>

<span class="hljs-comment">// KEV lookup</span>
<span class="hljs-keyword">const</span> kevData = <span class="hljs-keyword">await</span> <span class="hljs-title class_">CVEUtilities</span>.<span class="hljs-title function_">checkKEV</span>(<span class="hljs-string">&#x27;CVE-2024-12345&#x27;</span>);
<span class="hljs-comment">// Returns: { isKEV: true, dateAdded: &quot;2024-10-01&quot;, ransomware: true, ... }</span>

<span class="hljs-comment">// Cisco PSIRT lookup</span>
<span class="hljs-keyword">const</span> ciscoData = <span class="hljs-keyword">await</span> <span class="hljs-title class_">CVEUtilities</span>.<span class="hljs-title function_">lookupCiscoPSIRT</span>(<span class="hljs-string">&#x27;CVE-2024-12345&#x27;</span>);
<span class="hljs-comment">// Returns: { advisory: &quot;cisco-sa-xxx&quot;, fixedVersions: [...], ... }</span></code></pre><p><strong>KEV Cache:</strong></p>
<pre><code class="language-javascript"><span class="hljs-comment">// Local storage cache for KEV lookups (24h TTL)</span>
<span class="hljs-keyword">const</span> kevCache = {
    <span class="hljs-string">&#x27;CVE-2024-12345&#x27;</span>: {
        <span class="hljs-attr">data</span>: { <span class="hljs-attr">isKEV</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">dateAdded</span>: <span class="hljs-string">&#x27;2024-10-01&#x27;</span>, ... },
        <span class="hljs-attr">timestamp</span>: <span class="hljs-number">1696435200000</span>
    }
};

<span class="hljs-comment">// Cache management</span>
<span class="hljs-title class_">CVEUtilities</span>.<span class="hljs-title function_">clearKEVCache</span>()      <span class="hljs-comment">// Clear all cached KEV data</span>
<span class="hljs-title class_">CVEUtilities</span>.<span class="hljs-title function_">refreshKEV</span>(cveId)    <span class="hljs-comment">// Force fresh lookup</span></code></pre><p><strong>Batch Processing:</strong></p>
<pre><code class="language-javascript"><span class="hljs-comment">// Efficient batch KEV lookups</span>
<span class="hljs-keyword">const</span> cveList = [<span class="hljs-string">&#x27;CVE-2024-1&#x27;</span>, <span class="hljs-string">&#x27;CVE-2024-2&#x27;</span>, <span class="hljs-string">&#x27;CVE-2024-3&#x27;</span>];
<span class="hljs-keyword">const</span> kevResults = <span class="hljs-keyword">await</span> <span class="hljs-title class_">CVEUtilities</span>.<span class="hljs-title function_">batchKEVLookup</span>(cveList);
<span class="hljs-comment">// Returns: Map&lt;cveId, kevData&gt;</span></code></pre><h3>Security Module</h3><p><strong>Location:</strong> <code>app/public/scripts/utils/security.js</code></p>
<p>Security utilities for input validation and sanitization.</p>
<p><strong>Functions:</strong></p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Purpose</th>
</tr>
</thead>
<tbody><tr>
<td><code>escapeHtml()</code></td>
<td>Prevent XSS attacks</td>
</tr>
<tr>
<td><code>sanitizeInput()</code></td>
<td>Clean user input</td>
</tr>
<tr>
<td><code>validatePath()</code></td>
<td>Prevent path traversal</td>
</tr>
<tr>
<td><code>sanitizeCSV()</code></td>
<td>Clean CSV data</td>
</tr>
</tbody></table>
<h3>AccessibilityAnnouncer</h3><p><strong>Location:</strong> <code>app/public/scripts/utils/accessibility-announcer.js</code></p>
<p>ARIA live region management for screen readers.</p>
<p><strong>Features:</strong></p>
<ul>
<li>Dynamic announcements</li>
<li>Priority levels</li>
<li>Queue management</li>
<li>Automatic cleanup</li>
</ul>
<p><strong>Usage:</strong></p>
<pre><code class="language-javascript"><span class="hljs-title class_">AccessibilityAnnouncer</span>.<span class="hljs-title function_">announce</span>(<span class="hljs-string">&#x27;Data loaded&#x27;</span>, <span class="hljs-string">&#x27;polite&#x27;</span>);
<span class="hljs-title class_">AccessibilityAnnouncer</span>.<span class="hljs-title function_">announce</span>(<span class="hljs-string">&#x27;Error occurred&#x27;</span>, <span class="hljs-string">&#x27;assertive&#x27;</span>);</code></pre><h3>WCAGContrastValidator</h3><p><strong>Location:</strong> <code>app/public/scripts/utils/wcag-contrast-validator.js</code></p>
<p>Validates color contrast for WCAG compliance.</p>
<p><strong>Features:</strong></p>
<ul>
<li>AA/AAA level checking</li>
<li>Dynamic theme validation</li>
<li>Suggestion generation</li>
<li>Batch validation</li>
</ul>
<h3>ChartThemeAdapter</h3><p><strong>Location:</strong> <code>app/public/scripts/utils/chart-theme-adapter.js</code></p>
<p>Adapts chart colors to current theme.</p>
<p><strong>Responsibilities:</strong></p>
<ul>
<li>Color palette management</li>
<li>Dynamic theme switching</li>
<li>Contrast optimization</li>
<li>ApexCharts configuration</li>
</ul>
<h3>ValidationUtils</h3><p><strong>Location:</strong> <code>app/public/scripts/validation-utils.js</code></p>
<p>Form and data validation utilities.</p>
<p><strong>Functions:</strong></p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Purpose</th>
</tr>
</thead>
<tbody><tr>
<td><code>validateEmail()</code></td>
<td>Email format validation</td>
</tr>
<tr>
<td><code>validateURL()</code></td>
<td>URL format checking</td>
</tr>
<tr>
<td><code>validateIPAddress()</code></td>
<td>IP address validation</td>
</tr>
<tr>
<td><code>validateCVE()</code></td>
<td>CVE ID format validation</td>
</tr>
<tr>
<td><code>validateDate()</code></td>
<td>Date format and range</td>
</tr>
</tbody></table>
<hr>
<h2 id="constants">Constants and Configuration</h2><h3>VulnerabilityConstants</h3><p><strong>Location:</strong> <code>app/public/scripts/shared/vulnerability-constants.js</code></p>
<p>Central configuration for vulnerability features.</p>
<p><strong>Includes:</strong></p>
<ul>
<li>Severity levels and colors</li>
<li>Risk thresholds</li>
<li>API endpoints</li>
<li>Grid column definitions</li>
<li>Chart configurations</li>
</ul>
<h3>ConfigLoader</h3><p><strong>Location:</strong> <code>app/public/scripts/shared/config-loader.js</code></p>
<p>Loads and manages application configuration.</p>
<p><strong>Features:</strong></p>
<ul>
<li>Environment-based config</li>
<li>Default fallbacks</li>
<li>Runtime updates</li>
<li>Validation</li>
</ul>
<hr>
<h2 id="initialization">Initialization Scripts</h2><h3>Database Initializer</h3><p><strong>Location:</strong> <code>app/public/scripts/init-database.js</code></p>
<p>Sets up initial database schema and data.</p>
<p><strong>Operations:</strong></p>
<ul>
<li>Schema creation</li>
<li>Index setup</li>
<li>Default data insertion</li>
<li>Migration running</li>
</ul>
<hr>
<h2>Module Loading Pattern</h2><p>All modules follow a consistent loading pattern:</p>
<pre><code class="language-javascript"><span class="hljs-comment">// Module definition</span>
<span class="hljs-keyword">class</span> <span class="hljs-title class_">ComponentName</span> {
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options = {}</span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span> = { ...<span class="hljs-variable language_">this</span>.<span class="hljs-property">defaultOptions</span>, ...options };
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">init</span>();
    }

    <span class="hljs-title function_">init</span>(<span class="hljs-params"></span>) {
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setupDOM</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">attachEventListeners</span>();
        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadData</span>();
    }

    <span class="hljs-title function_">setupDOM</span>(<span class="hljs-params"></span>) {
        <span class="hljs-comment">// DOM references</span>
    }

    <span class="hljs-title function_">attachEventListeners</span>(<span class="hljs-params"></span>) {
        <span class="hljs-comment">// Event bindings</span>
    }

    <span class="hljs-title function_">loadData</span>(<span class="hljs-params"></span>) {
        <span class="hljs-comment">// Initial data load</span>
    }

    <span class="hljs-title function_">destroy</span>(<span class="hljs-params"></span>) {
        <span class="hljs-comment">// Cleanup</span>
    }
}

<span class="hljs-comment">// Auto-initialization</span>
<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;DOMContentLoaded&#x27;</span>, <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">window</span>.<span class="hljs-property">component</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ComponentName</span>();
});

<span class="hljs-comment">// Export for module use</span>
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-variable language_">module</span> !== <span class="hljs-string">&#x27;undefined&#x27;</span> &amp;&amp; <span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span>) {
    <span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-title class_">ComponentName</span>;
}</code></pre><hr>
<h2>Event System</h2><h3>Custom Events</h3><p>The application uses custom events for component communication:</p>
<table>
<thead>
<tr>
<th>Event</th>
<th>Triggered When</th>
<th>Data</th>
</tr>
</thead>
<tbody><tr>
<td><code>theme-changed</code></td>
<td>Theme toggles</td>
<td>`{ theme: &#39;light&#39;</td>
</tr>
<tr>
<td><code>data-refresh</code></td>
<td>Data needs reload</td>
<td>`{ type: &#39;vulnerabilities&#39;</td>
</tr>
<tr>
<td><code>filter-applied</code></td>
<td>Filters change</td>
<td><code>{ filters: {...} }</code></td>
</tr>
<tr>
<td><code>grid-ready</code></td>
<td>AG-Grid initializes</td>
<td><code>{ gridApi: api }</code></td>
</tr>
</tbody></table>
<h3>Global Functions</h3><p>Available on <code>window</code> object:</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Purpose</th>
</tr>
</thead>
<tbody><tr>
<td><code>refreshPageData(type)</code></td>
<td>Trigger data refresh</td>
</tr>
<tr>
<td><code>showNotification(msg, type)</code></td>
<td>Display notification</td>
</tr>
<tr>
<td><code>exportCurrentView()</code></td>
<td>Export visible data</td>
</tr>
<tr>
<td><code>toggleTheme()</code></td>
<td>Switch theme</td>
</tr>
</tbody></table>
<hr>
<h2>CSS Custom Properties</h2><p>The frontend relies on CSS custom properties for theming:</p>
<pre><code class="language-css"><span class="hljs-comment">/* Surface hierarchy for dark mode */</span>
<span class="hljs-attr">--hextrackr-surface-base</span>: <span class="hljs-number">#0f172a</span>;  <span class="hljs-comment">/* Background */</span>
<span class="hljs-attr">--hextrackr-surface-1</span>: <span class="hljs-number">#1a2332</span>;     <span class="hljs-comment">/* Cards */</span>
<span class="hljs-attr">--hextrackr-surface-2</span>: <span class="hljs-number">#253241</span>;     <span class="hljs-comment">/* Tables */</span>
<span class="hljs-attr">--hextrackr-surface-3</span>: <span class="hljs-number">#2f3f50</span>;     <span class="hljs-comment">/* Modals */</span>
<span class="hljs-attr">--hextrackr-surface-4</span>: <span class="hljs-number">#526880</span>;     <span class="hljs-comment">/* Overlays */</span>

<span class="hljs-comment">/* Severity colors */</span>
<span class="hljs-attr">--hextrackr-critical</span>: <span class="hljs-number">#d63939</span>;
<span class="hljs-attr">--hextrackr-high</span>: <span class="hljs-number">#f76707</span>;
<span class="hljs-attr">--hextrackr-medium</span>: <span class="hljs-number">#f59f00</span>;
<span class="hljs-attr">--hextrackr-low</span>: <span class="hljs-number">#74b816</span>;</code></pre><hr>
<h2>Performance Considerations</h2><h3>Optimization Strategies</h3><ol>
<li><strong>Lazy Loading</strong>: Components load on demand</li>
<li><strong>Virtual Scrolling</strong>: AG-Grid handles large datasets</li>
<li><strong>Debouncing</strong>: Search and filter inputs are debounced</li>
<li><strong>Caching</strong>: API responses cached for 5 minutes</li>
<li><strong>Web Workers</strong>: CSV parsing in background (large files)</li>
</ol>
<h3>Memory Management</h3><ul>
<li>Event listeners cleaned up on component destroy</li>
<li>WebSocket connections properly closed</li>
<li>Chart instances disposed when not needed</li>
<li>Grid data virtualized for large datasets</li>
</ul>

    <!-- Note: This file is intentionally minimal. The full page scaffold, header, footer, and scripts
             are provided by docs-html/index.html. Content generated using this template will be
             fetched and injected into #content-container by docs-html/js/docs-portal-v2.js. -->
</section>
