<!-- Fragment template for documentation content injected by docs-tabler.js -->
<section class="doc-fragment">
    <h1>Tickets API</h1>
<p>The Tickets API provides CRUD operations for managing tickets. For general API information, see the <a href="#api-reference/overview">API Overview</a>.</p>
<p><strong>Data Model</strong>: For detailed information on the <code>tickets</code> table schema, see the <a href="#architecture/data-model">Data Model documentation</a>.</p>
<hr>
<h2>Endpoints</h2>
<h3>GET /api/tickets</h3>
<ul>
<li><strong>Description</strong>: Retrieves a list of all tickets, ordered by creation date in descending order.</li>
<li><strong>Query Parameters</strong>: None</li>
<li><strong>Response</strong>: <code>200 OK</code><ul>
<li><p><strong>Note</strong>: The <code>devices</code> and <code>attachments</code> fields are returned as JSON strings.</p>
<pre><code class="language-json"><span class="hljs-punctuation">[</span>
  <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;TICK-123&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;xt_number&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;XT001&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;date_submitted&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-20T12:00:00.000Z&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;date_due&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-30T12:00:00.000Z&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;hexagon_ticket&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;HX-456&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;service_now_ticket&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;INC0000123&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;location&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;HQ-1&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;devices&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;[\&quot;Device 1\&quot;,\&quot;Device 2\&quot;]&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;supervisor&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Jane Doe&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;tech&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;John Smith&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;status&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Open&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;notes&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Initial ticket creation.&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;attachments&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;[]&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;created_at&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-20T12:00:00.000Z&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;updated_at&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-20T12:00:00.000Z&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;site&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;HQ&quot;</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">]</span></code></pre></li>
</ul>
</li>
</ul>
<h3>POST /api/tickets</h3>
<ul>
<li><p><strong>Description</strong>: Creates a new ticket. The server expects camelCase keys in the request body and maps them to snake_case for the database.</p>
</li>
<li><p><strong>Request Body</strong>: <code>application/json</code></p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;TICK-124&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;xt_number&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;XT002&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;dateSubmitted&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-21T10:00:00.000Z&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;dateDue&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-31T10:00:00.000Z&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;hexagonTicket&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;HX-457&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;serviceNowTicket&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;INC0000124&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;location&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;HQ-2&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;devices&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;Device 3&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;Device 4&quot;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;supervisor&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;John Doe&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;tech&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Jane Smith&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;status&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Open&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;notes&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;This is a new ticket.&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;attachments&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;createdAt&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-21T10:00:00.000Z&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;updatedAt&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-21T10:00:00.000Z&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;site&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;HQ&quot;</span>
<span class="hljs-punctuation">}</span></code></pre></li>
<li><p><strong>Response</strong>: <code>200 OK</code></p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;success&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;TICK-124&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;message&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Ticket saved successfully&quot;</span>
<span class="hljs-punctuation">}</span></code></pre></li>
</ul>
<h3>PUT /api/tickets/:id</h3>
<ul>
<li><p><strong>Description</strong>: Updates an existing ticket by its <code>id</code>.</p>
</li>
<li><p><strong>URL Parameters</strong>:</p>
<ul>
<li><code>id</code> (string, required): The ID of the ticket to update.</li>
</ul>
</li>
<li><p><strong>Request Body</strong>: <code>application/json</code> (Same shape as <code>POST /api/tickets</code>)</p>
</li>
<li><p><strong>Response</strong>: <code>200 OK</code></p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;success&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;TICK-123&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;message&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Ticket updated successfully&quot;</span>
<span class="hljs-punctuation">}</span></code></pre></li>
</ul>
<h3>DELETE /api/tickets/:id</h3>
<ul>
<li><p><strong>Description</strong>: Deletes a ticket by its <code>id</code>.</p>
</li>
<li><p><strong>URL Parameters</strong>:</p>
<ul>
<li><code>id</code> (string, required): The ID of the ticket to delete.</li>
</ul>
</li>
<li><p><strong>Response</strong>: <code>200 OK</code></p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;success&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;deleted&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span>
<span class="hljs-punctuation">}</span></code></pre></li>
</ul>
<hr>
<h2>Data Import Endpoints</h2>
<h3>POST /api/import/tickets</h3>
<ul>
<li><p><strong>Description</strong>: Imports a batch of tickets from a JSON array. This is typically used after parsing a CSV file on the frontend. The operation performs an <code>INSERT OR REPLACE</code> into the database.</p>
</li>
<li><p><strong>Request Body</strong>: <code>application/json</code></p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;data&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ticket_1&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;xt_number&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;XT001&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;date_submitted&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-20&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;date_due&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-30&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;hexagon_ticket&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;HX-456&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;service_now_ticket&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;INC0000123&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;location&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;HQ-1&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;devices&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;[\&quot;Device 1\&quot;]&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;supervisor&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Jane&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;tech&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;John&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;status&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Open&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;notes&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Notes from import.&quot;</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span></code></pre></li>
<li><p><strong>Response</strong>: <code>200 OK</code></p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;success&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;imported&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;total&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span>
<span class="hljs-punctuation">}</span></code></pre></li>
</ul>
<h3>POST /api/tickets/migrate</h3>
<ul>
<li><p><strong>Description</strong>: A legacy endpoint to bulk migrate tickets from an old <code>localStorage</code> format. It performs an <code>INSERT OR REPLACE</code> operation.</p>
</li>
<li><p><strong>Note</strong>: The schema for this endpoint is different from the standard ticket format and should only be used for migrating legacy data.</p>
</li>
<li><p><strong>Request Body</strong>: <code>application/json</code></p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;tickets&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;legacy-1&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;start_date&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-01&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;end_date&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-05&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;primary_number&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;PR-1&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;incident_number&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;INC-1&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;site_code&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;HQ&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;affected_devices&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;DEV-1&quot;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;assignee&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Tech&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;status&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Open&quot;</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span></code></pre></li>
<li><p><strong>Response</strong>: <code>200 OK</code></p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;success&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;message&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Migration completed: 1 tickets migrated, 0 errors&quot;</span>
<span class="hljs-punctuation">}</span></code></pre></li>
</ul>
<hr>
<h2>Reference Data Endpoints</h2>
<h3>GET /api/sites</h3>
<ul>
<li><strong>Description</strong>: Retrieves a list of unique sites from the database.</li>
<li><strong>Response</strong>: <code>200 OK</code> - An array of site records.</li>
</ul>
<h3>GET /api/locations</h3>
<ul>
<li><strong>Description</strong>: Retrieves a list of unique locations from the database.</li>
<li><strong>Response</strong>: <code>200 OK</code> - An array of location records.</li>
</ul>
<hr>
<h2>Error Responses</h2>
<ul>
<li><p><strong><code>400 Bad Request</code></strong>: The request body is missing or contains invalid data.</p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;error&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;No data provided&quot;</span>
<span class="hljs-punctuation">}</span></code></pre></li>
<li><p><strong><code>500 Internal Server Error</code></strong>: An error occurred during a database operation.</p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;error&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Failed to save ticket&quot;</span>
<span class="hljs-punctuation">}</span></code></pre></li>
</ul>

    <!-- Note: This file is intentionally minimal. The full page scaffold, header, footer, and scripts
             are provided by docs-html/index.html. Content generated using this template will be
             fetched and injected into #content-container by docs-html/js/docs-portal-v2.js. -->
</section>
