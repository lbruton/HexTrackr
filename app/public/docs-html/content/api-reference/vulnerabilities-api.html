<!-- Fragment template for documentation content injected by docs-tabler.js -->
<section class="doc-fragment">
    <h1>Vulnerabilities API</h1>
<p>HexTrackr exposes a set of REST endpoints for reporting, trending, and importing vulnerability data. The API operates on the rollover pipeline described in <a href="#architecture/database">Database Architecture</a> and surfaces both the deduplicated current state (<code>vulnerabilities_current</code>) and supporting metadata.</p>
<p><strong>Related reading</strong>: <a href="#architecture/data-model">Data Model</a> for table layouts and column notes.</p>
<hr>
<h2>Endpoints</h2>
<h3>GET /api/vulnerabilities</h3>
<ul>
<li><strong>Description</strong>: Returns active and reopened vulnerabilities ordered by VPR score. Resolved rows are excluded automatically (<code>lifecycle_state IN (&#39;active&#39;,&#39;reopened&#39;)</code>).</li>
<li><strong>Query Parameters</strong>:<ul>
<li><code>page</code> (number, default <code>1</code>)</li>
<li><code>limit</code> (number, default <code>50</code>)</li>
<li><code>search</code> (string): case-insensitive substring match against hostname, CVE, or plugin name</li>
<li><code>severity</code> (string): one of <code>Critical</code>, <code>High</code>, <code>Medium</code>, <code>Low</code></li>
</ul>
</li>
<li><strong>Response</strong>: <code>200 OK</code></li>
</ul>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;data&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">42</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;import_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">9</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;scan_date&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-20&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;hostname&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;core-switch-01&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;ip_address&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;10.0.10.5&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;cve&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;CVE-2024-0001&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;severity&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;High&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;vpr_score&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">8.6</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;cvss_score&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">9.0</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;plugin_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;12345&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;plugin_name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Example Vulnerability Name&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Example Vulnerability Name (CVE-2024-0001)&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;solution&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Update firmware to version 18.5&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;state&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ACTIVE&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;lifecycle_state&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;active&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;first_seen&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-10&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;last_seen&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-20&quot;</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;pagination&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;page&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;limit&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">50</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;total&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">312</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;pages&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">7</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre><h3>GET /api/vulnerabilities/stats</h3>
<ul>
<li><strong>Description</strong>: Aggregated metrics derived from <code>vulnerabilities_current</code> grouped by severity.</li>
<li><strong>Response</strong>: <code>200 OK</code></li>
</ul>
<pre><code class="language-json"><span class="hljs-punctuation">[</span>
  <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;severity&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Critical&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">12</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;total_vpr&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">100.1</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;avg_vpr&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">8.34</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;earliest&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-01&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;latest&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-20&quot;</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">]</span></code></pre><h3>GET /api/vulnerabilities/recent-trends</h3>
<ul>
<li><strong>Description</strong>: Compares the most recent daily totals with the previous day to highlight deltas. Uses <code>vulnerability_daily_totals</code>.</li>
<li><strong>Response</strong>: <code>200 OK</code></li>
</ul>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;Critical&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;current&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">&quot;count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">12</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;total_vpr&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">115.8</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;trend&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">&quot;count_change&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;vpr_change&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">10.2</span> <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;High&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;current&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">&quot;count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">40</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;total_vpr&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">320.1</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;trend&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">&quot;count_change&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">-5</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;vpr_change&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">-34.5</span> <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre><h3>GET /api/vulnerabilities/trends</h3>
<ul>
<li><strong>Description</strong>: Historical trend series for each severity with optional start/end date filters. Defaults to the last 14 days.</li>
<li><strong>Query Parameters</strong>: <code>startDate</code>, <code>endDate</code> (<code>YYYY-MM-DD</code>)</li>
<li><strong>Response</strong>: <code>200 OK</code></li>
</ul>
<pre><code class="language-json"><span class="hljs-punctuation">[</span>
  <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;date&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-20&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;Critical&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">&quot;count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">12</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;total_vpr&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">115.8</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;High&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">&quot;count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">85</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;total_vpr&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">722.5</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;Medium&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">&quot;count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">210</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;total_vpr&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1050.0</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;Low&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">&quot;count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">50</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;total_vpr&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">50.0</span> <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">]</span></code></pre><h3>GET /api/vulnerabilities/resolved</h3>
<ul>
<li><strong>Description</strong>: Paginated access to resolved vulnerabilities (<code>lifecycle_state = &#39;resolved&#39;</code>). Useful for audits and verification workflows.</li>
<li><strong>Response</strong>: <code>200 OK</code></li>
</ul>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;data&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;hostname&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;server-01&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;cve&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;CVE-2023-1234&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;severity&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;High&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;lifecycle_state&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;resolved&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;resolved_date&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-15&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;last_seen&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-10&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;resolution_reason&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;No longer detected in latest scan&quot;</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;pagination&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">&quot;page&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;limit&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">50</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;total&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">45</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;pages&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span> <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre><h3>GET /api/imports</h3>
<ul>
<li><strong>Description</strong>: Returns import history from <code>vulnerability_imports</code> with derived vulnerability counts.</li>
<li><strong>Response</strong>: <code>200 OK</code></li>
</ul>
<pre><code class="language-json"><span class="hljs-punctuation">[</span>
  <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">12</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;filename&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;cisco_scan_2025-08-20.csv&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;import_date&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-20T15:04:00.000Z&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;row_count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">9850</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;vendor&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;cisco&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;file_size&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1048576</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;processing_time&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2340</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;raw_headers&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;[\&quot;asset.name\&quot;,\&quot;definition.cve\&quot;]&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;created_at&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-20T15:04:00.000Z&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;vulnerability_count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">9850</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">]</span></code></pre><h3>DELETE /api/vulnerabilities/clear</h3>
<ul>
<li><strong>Description</strong>: Removes all rollover data (current, snapshots, daily totals, staging, import history). Also clears many-to-many ticket links.</li>
<li><strong>Warning</strong>: Irreversible destructive operation.</li>
<li><strong>Response</strong>: <code>200 OK</code></li>
</ul>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;success&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;message&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;All vulnerability data cleared from rollover architecture&quot;</span>
<span class="hljs-punctuation">}</span></code></pre><hr>
<h2>System Management</h2>
<h3>GET /health</h3>
<ul>
<li><strong>Description</strong>: Lightweight health probe that reports application version, database availability, and uptime.</li>
<li><strong>Response</strong>: <code>200 OK</code></li>
</ul>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;status&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ok&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;version&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1.2.0&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;db&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;uptime&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">8645.32</span>
<span class="hljs-punctuation">}</span></code></pre><h3>GET /api/sites</h3>
<ul>
<li><strong>Description</strong>: Lists known sites used for ticket context.</li>
<li><strong>Response</strong>: <code>200 OK</code></li>
</ul>
<pre><code class="language-json"><span class="hljs-punctuation">[</span>
  <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;code&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;HQ&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Main Campus&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Primary operations center&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;created_at&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-01T10:00:00.000Z&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;updated_at&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-01T10:00:00.000Z&quot;</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">]</span></code></pre><h3>GET /api/locations</h3>
<ul>
<li><strong>Description</strong>: Lists normalized locations associated with tickets.</li>
<li><strong>Response</strong>: <code>200 OK</code></li>
</ul>
<pre><code class="language-json"><span class="hljs-punctuation">[</span>
  <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;code&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;HQ-WEST&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Building A&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;West wing&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;created_at&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-01T10:00:00.000Z&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;updated_at&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-01T10:00:00.000Z&quot;</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">]</span></code></pre><hr>
<h2>Data Import &amp; History</h2>
<p>HexTrackr supports three ingestion paths. All flows normalise hostname/IP data, split multi-CVE rows, and update lifecycle states automatically.</p>
<h3>POST /api/vulnerabilities/import</h3>
<ul>
<li><strong>Use case</strong>: Standard CSV uploads from the dashboard.</li>
<li><strong>Form fields</strong>: <code>csvFile</code> (required), optional <code>vendor</code>, <code>scanDate</code>.</li>
<li><strong>Processing</strong>: Parses CSV via PapaParse, maps rows, updates rollover tables sequentially, and recalculates daily totals.</li>
<li><strong>Response</strong>: <code>200 OK</code></li>
</ul>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;success&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;importId&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">12</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;filename&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;export.csv&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;rowsProcessed&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">250</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;recordsCreated&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">250</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;inserted&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">200</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;updated&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">30</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;reopened&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">20</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;resolvedCount&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">10</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;scanDate&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-20&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;rolloverComplete&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;enhancedLifecycle&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;performanceMetrics&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;totalImportTimeMs&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2340</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;rowsPerSecond&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">106.8</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;memoryDeltaMB&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">12</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;dbOperations&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;total&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1800</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;snapshotInserts&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">250</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;currentChecks&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">250</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;currentUpdates&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">200</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;currentInserts&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">50</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;avgTimeMs&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1.5</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;avgRowTimeMs&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0.9</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre><h3>POST /api/vulnerabilities/import-staging</h3>
<ul>
<li><strong>Use case</strong>: High-volume CSV uploads that need progress feedback.</li>
<li><strong>Form fields</strong>: <code>csvFile</code> (required), optional <code>vendor</code>, <code>scanDate</code>, <code>sessionId</code>.</li>
<li><strong>Behavior</strong>:<ul>
<li>Immediately returns <code>{ success, sessionId }</code>.</li>
<li>Streams Socket.io events (<code>progress-update</code>, <code>progress-error</code>, <code>progress-complete</code>) in the room <code>progress-{sessionId}</code> managed by <code>ProgressTracker</code>.</li>
<li>Bulk loads data into <code>vulnerability_staging</code> before promoting to final tables.</li>
</ul>
</li>
</ul>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;success&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;sessionId&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1f4bba9b-3f8c-4d13-8cb8-4dedc1b7a9a2&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;message&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;CSV import started&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;filename&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;scan.csv&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;vendor&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;cisco&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;scanDate&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-20&quot;</span>
<span class="hljs-punctuation">}</span></code></pre><h3>POST /api/import/vulnerabilities</h3>
<ul>
<li><strong>Use case</strong>: Automated integrations that pre-parse CSV to JSON.</li>
<li><strong>Request Body</strong>: <code>{ &quot;data&quot;: VulnerabilityRow[] }</code></li>
<li><strong>Response</strong>: <code>200 OK</code></li>
</ul>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;success&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;imported&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;total&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;errors&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span></code></pre><ul>
<li><strong>Supported fields</strong>: <code>hostname</code>, <code>ip_address</code>, <code>cve</code>, <code>severity</code>, <code>vpr_score</code>, <code>cvss_score</code>, <code>plugin_id</code>, <code>plugin_name</code>, <code>description</code>, <code>solution</code>, <code>vendor</code>, <code>state</code>.</li>
</ul>
<hr>
<h2>Error Handling</h2>
<p>Typical error formats follow Express conventions:</p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;error&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;CSV parsing failed: Unexpected column count&quot;</span>
<span class="hljs-punctuation">}</span></code></pre><ul>
<li><code>400 Bad Request</code>: invalid payloads or missing files</li>
<li><code>409 Conflict</code>: conflicts raised during import mode checks</li>
<li><code>500 Internal Server Error</code>: database or file-processing failures</li>
</ul>

    <!-- Note: This file is intentionally minimal. The full page scaffold, header, footer, and scripts
             are provided by docs-html/index.html. Content generated using this template will be
             fetched and injected into #content-container by docs-html/js/docs-portal-v2.js. -->
</section>
