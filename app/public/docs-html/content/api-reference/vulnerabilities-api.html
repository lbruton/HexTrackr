<!-- Fragment template for documentation content injected by docs-tabler.js -->
<section class="doc-fragment">
    <h1>Vulnerabilities API</h1>
<p>This API provides endpoints for managing and analyzing vulnerability data. It features a <a href="#architecture/rollover-mechanism">rollover architecture</a> for historical trend analysis.</p>
<p><strong>Data Model</strong>: For detailed information on the vulnerability-related tables, see the <a href="#architecture/data-model">Data Model documentation</a>.</p>
<hr>
<h2>Endpoints</h2>
<h3>GET /api/vulnerabilities</h3>
<ul>
<li><p><strong>Description</strong>: Retrieves a paginated list of active vulnerabilities. Automatically filters by lifecycle_state IN (&#39;active&#39;, &#39;reopened&#39;) to exclude resolved vulnerabilities.</p>
</li>
<li><p><strong>Query Parameters</strong>:</p>
<ul>
<li><code>page</code> (number, optional, default: 1): The page number to retrieve.</li>
<li><code>limit</code> (number, optional, default: 50): The number of items per page.</li>
<li><code>search</code> (string, optional): A search term to filter by hostname, CVE, or plugin name.</li>
<li><code>severity</code> (string, optional): Filter by severity (<code>Critical</code>, <code>High</code>, <code>Medium</code>, <code>Low</code>).</li>
</ul>
</li>
<li><p><strong>Note</strong>: This endpoint only returns active and reopened vulnerabilities. Use <code>/api/vulnerabilities/resolved</code> for resolved vulnerabilities.</p>
</li>
<li><p><strong>Response</strong>: <code>200 OK</code></p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;data&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">10</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;import_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;hostname&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;host-1&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;cve&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;CVE-2024-0001&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;severity&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;High&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;vpr_score&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">8.6</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;last_seen&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-20&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;plugin_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;12345&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;plugin_name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Example Vulnerability Name&quot;</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;pagination&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">&quot;page&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;limit&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">50</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;total&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1234</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;pages&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">25</span> <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre></li>
</ul>
<h3>GET /api/vulnerabilities/stats</h3>
<ul>
<li><p><strong>Description</strong>: Retrieves aggregated statistics for current vulnerabilities, grouped by severity.</p>
</li>
<li><p><strong>Response</strong>: <code>200 OK</code></p>
<pre><code class="language-json"><span class="hljs-punctuation">[</span>
  <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;severity&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Critical&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">12</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;total_vpr&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">100.1</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;avg_vpr&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">8.34</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;earliest&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-01&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;latest&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-20&quot;</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">]</span></code></pre></li>
</ul>
<h3>GET /api/vulnerabilities/recent-trends</h3>
<ul>
<li><p><strong>Description</strong>: Retrieves statistics for the most recent scan date and compares them with the previous day to show trends.</p>
</li>
<li><p><strong>Response</strong>: <code>200 OK</code></p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;Critical&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;current&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">&quot;count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">12</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;total_vpr&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">115.8</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;trend&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">&quot;count_change&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;vpr_change&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">10.2</span> <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre></li>
</ul>
<h3>GET /api/vulnerabilities/trends</h3>
<ul>
<li><p><strong>Description</strong>: Provides historical data on vulnerability counts and VPR scores, aggregated by day and severity.</p>
</li>
<li><p><strong>Query Parameters</strong>:</p>
<ul>
<li><code>startDate</code> (string, optional): Start date in <code>YYYY-MM-DD</code> format.</li>
<li><code>endDate</code> (string, optional): End date in <code>YYYY-MM-DD</code> format.</li>
</ul>
</li>
<li><p><strong>Response</strong>: <code>200 OK</code></p>
<pre><code class="language-json"><span class="hljs-punctuation">[</span>
  <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;date&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-20&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;Critical&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">&quot;count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">12</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;total_vpr&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">115.8</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;High&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">&quot;count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">85</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;total_vpr&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">722.5</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;Medium&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">&quot;count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">210</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;total_vpr&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1050.0</span> <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;Low&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">&quot;count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">50</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;total_vpr&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">50.0</span> <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">]</span></code></pre></li>
</ul>
<h3>GET /api/vulnerabilities/resolved</h3>
<ul>
<li><p><strong>Description</strong>: Retrieves a paginated list of resolved vulnerabilities (lifecycle_state = &#39;resolved&#39;).</p>
</li>
<li><p><strong>Query Parameters</strong>:</p>
<ul>
<li><code>page</code> (number, optional, default: 1): The page number to retrieve.</li>
<li><code>limit</code> (number, optional, default: 50): The number of items per page.</li>
<li><code>search</code> (string, optional): A search term to filter by hostname, CVE, or plugin name.</li>
</ul>
</li>
<li><p><strong>Response</strong>: <code>200 OK</code></p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;data&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;hostname&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;server-01&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;cve&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;CVE-2023-1234&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;severity&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;High&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;lifecycle_state&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;resolved&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;resolved_date&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-15&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;last_seen&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-10&quot;</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;pagination&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> <span class="hljs-attr">&quot;page&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;limit&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">50</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;total&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">45</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;pages&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span> <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre></li>
</ul>
<hr>
<h2>System Management</h2>
<h3>GET /health</h3>
<ul>
<li><p><strong>Description</strong>: Health check endpoint that provides system status information including version, database availability, and uptime.</p>
</li>
<li><p><strong>Response</strong>: <code>200 OK</code></p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;status&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ok&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;version&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1.0.0&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;db&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;uptime&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">3600.5</span>
<span class="hljs-punctuation">}</span></code></pre></li>
</ul>
<h3>GET /api/sites</h3>
<ul>
<li><p><strong>Description</strong>: Retrieves all sites from the database, ordered alphabetically by name.</p>
</li>
<li><p><strong>Response</strong>: <code>200 OK</code></p>
<pre><code class="language-json"><span class="hljs-punctuation">[</span>
  <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Main Office&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;created_at&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-01T10:00:00.000Z&quot;</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Branch Office&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;created_at&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-02T14:30:00.000Z&quot;</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">]</span></code></pre></li>
</ul>
<h3>GET /api/locations</h3>
<ul>
<li><p><strong>Description</strong>: Retrieves all locations from the database, ordered alphabetically by name.</p>
</li>
<li><p><strong>Response</strong>: <code>200 OK</code></p>
<pre><code class="language-json"><span class="hljs-punctuation">[</span>
  <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Building A&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;created_at&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-01T10:00:00.000Z&quot;</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Building B&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;created_at&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-02T14:30:00.000Z&quot;</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">]</span></code></pre></li>
</ul>
<hr>
<h2>Data Import &amp; History</h2>
<p>HexTrackr provides three distinct methods for importing vulnerability data:</p>
<ol>
<li><strong>CSV File Upload</strong> (<code>/api/vulnerabilities/import</code>): Server-side CSV parsing - upload raw CSV files and let the server handle all parsing logic.</li>
<li><strong>Staging Import</strong> (<code>/api/vulnerabilities/import-staging</code>): Server-side staged import with enhanced performance for large datasets.</li>
<li><strong>JSON Payload</strong> (<code>/api/import/vulnerabilities</code>): Client-side CSV parsing - parse CSV into JSON on the frontend before sending to server.</li>
</ol>
<p><strong>Key Differences:</strong></p>
<ul>
<li><strong>Server-side parsing</strong> (<code>/import</code>): Upload CSV directly, server handles format detection and parsing</li>
<li><strong>Client-side parsing</strong> (<code>/api/import/vulnerabilities</code>): Frontend parses CSV to JSON, then sends structured data</li>
</ul>
<p>The appropriate method depends on your integration needs and client-side capabilities.</p>
<h3>POST /api/vulnerabilities/import</h3>
<ul>
<li><strong>Description</strong>: Imports vulnerabilities from an uploaded CSV file. This is the primary endpoint for server-side processing of vulnerability scans.</li>
<li><strong>Enhanced Features</strong>:<ul>
<li><strong>Multi-format Support</strong>: Automatically detects and processes various CSV export formats</li>
<li><strong>Cisco SA Support</strong>: Extracts and processes Cisco Security Advisory identifiers (<code>cisco-sa-*</code> patterns)</li>
<li><strong>CVE Extraction</strong>: Multi-tier CVE identification from various column sources</li>
<li><strong>Intelligent Parsing</strong>: Handles both direct CVE columns and embedded CVE patterns in vulnerability names</li>
</ul>
</li>
<li><strong>Request Body</strong>: <code>multipart/form-data</code><ul>
<li><code>csvFile</code> (file, required): The CSV file to import.</li>
<li><code>vendor</code> (string, optional): The source of the data (e.g., &quot;cisco&quot;).</li>
<li><code>scanDate</code> (string, optional): The date of the scan in <code>YYYY-MM-DD</code> format. Defaults to the current date.</li>
</ul>
</li>
<li><strong>Response</strong>: <code>200 OK</code></li>
</ul>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;success&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;importId&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">7</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;rowsProcessed&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">250</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;filename&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;export.csv&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;insertCount&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">200</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;updateCount&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">50</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;removedStale&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">10</span>
<span class="hljs-punctuation">}</span></code></pre><h3>POST /api/vulnerabilities/import-staging</h3>
<ul>
<li><strong>Description</strong>: Enhanced staging import endpoint for vulnerability data with performance optimizations and advanced processing features.</li>
<li><strong>Request Body</strong>: <code>multipart/form-data</code><ul>
<li><code>csvFile</code> (file, required): The CSV file to import.</li>
<li><code>vendor</code> (string, optional): The source of the data (e.g., &quot;cisco&quot;, &quot;tenable&quot;).</li>
<li><code>scanDate</code> (string, optional): The date of the scan in <code>YYYY-MM-DD</code> format. Auto-extracted from filename if not provided.</li>
</ul>
</li>
<li><strong>Enhanced Features</strong>:<ul>
<li><strong>Staging Table Processing</strong>: Uses temporary staging table for improved performance on large datasets</li>
<li><strong>Filename Date Extraction</strong>: Automatically extracts scan dates from common filename patterns</li>
<li><strong>Enhanced Performance Monitoring</strong>: Detailed timing and processing statistics</li>
</ul>
</li>
<li><strong>Response</strong>: <code>200 OK</code></li>
</ul>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;success&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;importId&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">12</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;stagingRowsProcessed&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">10000</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;finalRowsInserted&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">9850</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;filename&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;cisco_scan_2025-08-20.csv&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;processingTime&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2340</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;performance&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;stagingTime&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1200</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;processingTime&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1140</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre><h3>POST /api/import/vulnerabilities</h3>
<ul>
<li><strong>Description</strong>: Imports vulnerabilities from a JSON array. This endpoint is intended for use when a CSV file is parsed on the frontend before being sent to the server.</li>
<li><strong>Request Body</strong>: <code>application/json</code></li>
</ul>
<pre><code class="language-json">    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;data&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
        <span class="hljs-punctuation">{</span> <span class="hljs-attr">&quot;hostname&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;host-1&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;cve&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;CVE-2024-0001&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;severity&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;High&quot;</span> <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span>
    ```

-   **Response**<span class="hljs-punctuation">:</span> `<span class="hljs-number">200</span> OK`

    ```json
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;success&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;imported&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;total&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;importId&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">8</span>
    <span class="hljs-punctuation">}</span>
    ```

### GET /api/imports

-   **Description**<span class="hljs-punctuation">:</span> Retrieves the history of all vulnerability import events from the `vulnerability_imports` table.
-   **Note**<span class="hljs-punctuation">:</span> The `vulnerability_count` field is a calculated value representing the number of vulnerabilities associated with each import.
-   **Response**<span class="hljs-punctuation">:</span> `<span class="hljs-number">200</span> OK`

    ```json
    <span class="hljs-punctuation">[</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">7</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;filename&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;export.csv&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;import_date&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-20T10:30:00.000Z&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;rows_processed&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">250</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;status&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;completed&quot;</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">6</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;filename&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;cisco_scan_2025-08-19.csv&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;import_date&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-08-19T14:15:00.000Z&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;rows_processed&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1200</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;status&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;completed&quot;</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span>
    ```

---

## Data Deletion

### DELETE /api/vulnerabilities/clear

-   **Description**<span class="hljs-punctuation">:</span> Deletes all vulnerability-related data from the database. This includes the current state<span class="hljs-punctuation">,</span> historical snapshots<span class="hljs-punctuation">,</span> daily totals<span class="hljs-punctuation">,</span> import history<span class="hljs-punctuation">,</span> and links between tickets and vulnerabilities.
-   **Warning**<span class="hljs-punctuation">:</span> This is a destructive operation and cannot be undone.
-   **Response**<span class="hljs-punctuation">:</span> `<span class="hljs-number">200</span> OK`

    ```json
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;success&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;message&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;All vulnerability data cleared from rollover architecture&quot;</span>
    <span class="hljs-punctuation">}</span>
    ```</code></pre>
    <!-- Note: This file is intentionally minimal. The full page scaffold, header, footer, and scripts
             are provided by docs-html/index.html. Content generated using this template will be
             fetched and injected into #content-container by docs-html/js/docs-portal-v2.js. -->
</section>
