<!-- Fragment template for documentation content injected by docs-tabler.js -->
<section class="doc-fragment">
    <h1>Import API</h1>
<p>The Import API provides endpoints for importing vulnerability and ticket data from various sources including CSV files and JSON payloads. It supports both standard and high-performance staging imports with progress tracking via WebSocket.</p>
<h2>Overview</h2>
<p>The import system handles:</p>
<ul>
<li>CSV vulnerability imports from security scanners (Tenable, Qualys, etc.)</li>
<li>JSON-based vulnerability and ticket imports</li>
<li>High-performance staging imports for large datasets</li>
<li>Real-time progress tracking</li>
<li>Import history and metadata tracking</li>
</ul>
<h2>Endpoints</h2>
<h3>Import Vulnerabilities (Standard)</h3>
<p><strong>POST</strong> <code>/api/vulnerabilities/import</code></p>
<p>Standard vulnerability CSV import with enhanced lifecycle management. Processes vulnerabilities row-by-row with immediate deduplication.</p>
<h4>Request</h4>
<p><strong>Headers:</strong></p>
<ul>
<li><code>Content-Type: multipart/form-data</code></li>
</ul>
<p><strong>Body (multipart/form-data):</strong></p>
<ul>
<li><code>csvFile</code> (file, required) - CSV file containing vulnerability data</li>
<li><code>vendor</code> (string, optional) - Vendor name (auto-extracted from filename if not provided)</li>
<li><code>scanDate</code> (string, optional) - Scan date in YYYY-MM-DD format (auto-extracted if not provided)</li>
</ul>
<h4>Response</h4>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;success&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;importId&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;imp_20240315_143022_abc123&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;filename&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;tenable_scan_2024-03-15.csv&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;vendor&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Tenable&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;scanDate&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2024-03-15&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;totalRows&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">5000</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;imported&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">4500</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;skipped&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">500</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;duplicates&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">450</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;errors&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;processingTime&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">15000</span>
<span class="hljs-punctuation">}</span></code></pre><h4>Error Response</h4>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;success&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;error&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Import failed&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;details&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;CSV parsing failed: Unexpected column count&quot;</span>
<span class="hljs-punctuation">}</span></code></pre><hr>
<h3>Import Vulnerabilities (Staging)</h3>
<p><strong>POST</strong> <code>/api/vulnerabilities/import-staging</code></p>
<p>High-performance vulnerability import using staging table for batch processing. Optimized for large CSV files (10,000+ rows).</p>
<h4>Request</h4>
<p><strong>Headers:</strong></p>
<ul>
<li><code>Content-Type: multipart/form-data</code></li>
</ul>
<p><strong>Body (multipart/form-data):</strong></p>
<ul>
<li><code>csvFile</code> (file, required) - CSV file containing vulnerability data</li>
<li><code>vendor</code> (string, optional) - Vendor name (auto-extracted from filename if not provided)</li>
<li><code>scanDate</code> (string, optional) - Scan date in YYYY-MM-DD format (auto-extracted if not provided)</li>
<li><code>sessionId</code> (string, optional) - Session ID for progress tracking (auto-generated if not provided)</li>
</ul>
<h4>Response</h4>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;success&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;message&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Import completed successfully&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;sessionId&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;import-1710515422123-abc123&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;filename&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;large_scan_2024-03-15.csv&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;vendor&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Qualys&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;scanDate&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2024-03-15&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;stats&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;totalRows&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">50000</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;imported&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">48500</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;duplicates&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1500</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;newVulnerabilities&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">48500</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;updatedVulnerabilities&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;errors&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;processingTime&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">45000</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;performance&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;csvParsing&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">5000</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;stagingLoad&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">10000</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;processing&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">30000</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;rowsPerSecond&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1111</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre><h4>Progress Tracking</h4>
<p>Progress updates are sent via WebSocket to connected clients:</p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;sessionId&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;import-1710515422123-abc123&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;progress&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">75</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;message&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Processing batch 3 of 4&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;currentStep&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;totalSteps&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;details&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;processedRows&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">37500</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;totalRows&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">50000</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre><hr>
<h3>Import Vulnerabilities (JSON)</h3>
<p><strong>POST</strong> <code>/api/import/vulnerabilities</code></p>
<p>JSON-based vulnerability import for frontend data restoration and programmatic imports.</p>
<h4>Request</h4>
<p><strong>Headers:</strong></p>
<ul>
<li><code>Content-Type: application/json</code></li>
</ul>
<p><strong>Body:</strong></p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;vulnerabilities&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;vulnerability_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;VULN-001&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;title&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Critical Security Update&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;severity&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Critical&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;cvss&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">9.8</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;cve_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;CVE-2024-1234&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;affected_hosts&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;server01.example.com&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;remediation&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Apply security patch&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;vendor&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Microsoft&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;scan_date&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2024-03-15&quot;</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;metadata&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;source&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;backup_restore&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;importDate&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2024-03-15T14:30:00Z&quot;</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre><h4>Response</h4>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;success&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;message&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Vulnerabilities imported successfully&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;imported&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;skipped&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;duplicates&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span>
<span class="hljs-punctuation">}</span></code></pre><hr>
<h3>Import Tickets (JSON)</h3>
<p><strong>POST</strong> <code>/api/import/tickets</code></p>
<p>JSON-based ticket import for backup restoration and bulk ticket creation.</p>
<h4>Request</h4>
<p><strong>Headers:</strong></p>
<ul>
<li><code>Content-Type: application/json</code></li>
</ul>
<p><strong>Body:</strong></p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;tickets&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;ticket_number&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;INC0012345&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;xt_number&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;XT24-001&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;title&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Network Maintenance&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Scheduled maintenance window&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;priority&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Medium&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;status&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Open&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;assignee&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;John Doe&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;devices&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;switch01&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;router02&quot;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;location&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Data Center A&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;created_date&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2024-03-15T10:00:00Z&quot;</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;metadata&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;source&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;servicenow_export&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;importDate&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2024-03-15T14:30:00Z&quot;</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre><h4>Response</h4>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;success&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;message&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Tickets imported successfully&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;imported&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;skipped&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;errors&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span></code></pre><hr>
<h3>Get Import History</h3>
<p><strong>GET</strong> <code>/api/imports</code></p>
<p>Retrieve history of all imports with statistics and metadata.</p>
<h4>Request</h4>
<p>No parameters required.</p>
<h4>Response</h4>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;imports&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;import_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;imp_20240315_143022_abc123&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;filename&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;tenable_scan_2024-03-15.csv&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;import_date&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2024-03-15T14:30:22Z&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;vendor&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Tenable&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;scan_date&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2024-03-15&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;total_rows&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">5000</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;imported_count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">4500</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;vulnerability_count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">4500</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;file_size&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2048576</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;processing_time&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">15000</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;status&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;completed&quot;</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;total&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">25</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;summary&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;totalImports&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">25</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;totalVulnerabilities&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">112500</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;lastImport&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2024-03-15T14:30:22Z&quot;</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre><hr>
<h3>Check Import Progress</h3>
<p><strong>GET</strong> <code>/api/import/progress/:sessionId</code></p>
<p>Check the progress of an ongoing import operation.</p>
<h4>Request</h4>
<p><strong>Path Parameters:</strong></p>
<ul>
<li><code>sessionId</code> (string, required) - Session ID from import response</li>
</ul>
<h4>Response</h4>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;sessionId&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;import-1710515422123-abc123&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;status&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;processing&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;progress&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">75</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;message&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Processing vulnerabilities&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;currentStep&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;totalSteps&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;details&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;filename&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;large_scan.csv&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;processedRows&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">37500</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;totalRows&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">50000</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;estimatedTimeRemaining&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">15000</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre><h2>File Size Limits</h2>
<ul>
<li>Maximum file size: 100MB</li>
<li>Recommended to use staging import for files &gt; 10MB or &gt; 10,000 rows</li>
</ul>
<h2>Supported CSV Formats</h2>
<p>The import system automatically detects and maps columns from various security scanner formats:</p>
<h3>Tenable/Nessus</h3>
<ul>
<li>Required columns: <code>Plugin ID</code>, <code>Plugin Name</code>, <code>Severity</code>, <code>Host</code>, <code>Port</code></li>
<li>Optional: <code>CVE</code>, <code>CVSS</code>, <code>Solution</code>, <code>Synopsis</code>, <code>Description</code></li>
</ul>
<h3>Qualys</h3>
<ul>
<li>Required columns: <code>QID</code>, <code>Title</code>, <code>Severity</code>, <code>IP</code>, <code>Port</code></li>
<li>Optional: <code>CVE ID</code>, <code>CVSS Score</code>, <code>Solution</code>, <code>Threat</code>, <code>Impact</code></li>
</ul>
<h3>Generic Format</h3>
<ul>
<li>Required columns: <code>vulnerability_id</code>, <code>title</code>, <code>severity</code>, <code>host</code></li>
<li>Optional: <code>cve</code>, <code>cvss</code>, <code>port</code>, <code>remediation</code>, <code>description</code></li>
</ul>
<h2>Error Handling</h2>
<p>All endpoints return consistent error responses:</p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;success&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;error&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Error type&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;details&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Detailed error message&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;code&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ERROR_CODE&quot;</span>
<span class="hljs-punctuation">}</span></code></pre><p>Common error codes:</p>
<ul>
<li><code>NO_FILE</code>: No file uploaded</li>
<li><code>INVALID_FORMAT</code>: File format not supported</li>
<li><code>PARSE_ERROR</code>: CSV parsing failed</li>
<li><code>DB_ERROR</code>: Database operation failed</li>
<li><code>VALIDATION_ERROR</code>: Data validation failed</li>
</ul>
<h2>Performance Considerations</h2>
<h3>Standard Import (<code>/api/vulnerabilities/import</code>)</h3>
<ul>
<li>Best for: Small to medium files (&lt; 10,000 rows)</li>
<li>Processing: Row-by-row with immediate deduplication</li>
<li>Memory usage: Moderate</li>
<li>Speed: ~500-1000 rows/second</li>
</ul>
<h3>Staging Import (<code>/api/vulnerabilities/import-staging</code>)</h3>
<ul>
<li>Best for: Large files (&gt; 10,000 rows)</li>
<li>Processing: Batch processing via staging table</li>
<li>Memory usage: Optimized for large datasets</li>
<li>Speed: ~1000-2000 rows/second</li>
</ul>
<h2>WebSocket Progress Updates</h2>
<p>For real-time progress tracking, connect to the WebSocket endpoint:</p>
<pre><code class="language-javascript"><span class="hljs-keyword">const</span> ws = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WebSocket</span>(<span class="hljs-string">&#x27;ws://localhost:8989/ws&#x27;</span>);

ws.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;message&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> update = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(data);
  <span class="hljs-keyword">if</span> (update.<span class="hljs-property">type</span> === <span class="hljs-string">&#x27;import-progress&#x27;</span>) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`Import <span class="hljs-subst">${update.sessionId}</span>: <span class="hljs-subst">${update.progress}</span>%`</span>);
  }
});</code></pre><p>Progress updates include:</p>
<ul>
<li>Current progress percentage</li>
<li>Processing step details</li>
<li>Estimated time remaining</li>
<li>Row processing statistics</li>
</ul>
<h2>Rate Limiting</h2>
<p>Import endpoints are subject to rate limiting:</p>
<ul>
<li>10 imports per hour per IP address</li>
<li>Maximum 3 concurrent imports</li>
</ul>
<h2>Security</h2>
<ul>
<li>All file uploads are validated for type and size</li>
<li>File paths are validated using <code>PathValidator</code> to prevent directory traversal</li>
<li>Uploaded files are automatically deleted after processing</li>
<li>Input data is sanitized before database insertion</li>
<li>CSV parsing uses safe parsing options to prevent injection attacks</li>
</ul>

    <!-- Note: This file is intentionally minimal. The full page scaffold, header, footer, and scripts
             are provided by docs-html/index.html. Content generated using this template will be
             fetched and injected into #content-container by docs-html/js/docs-portal-v2.js. -->
</section>
