<!-- Fragment template for documentation content injected by docs-tabler.js -->
<section class="doc-fragment">
    <h1>Complete API Reference</h1>
<p>Comprehensive documentation of all HexTrackr API endpoints with detailed request/response examples, error handling, and integration guidelines.</p>
<hr>
<h2>API Overview</h2>
<p><strong>Base URL</strong>: <code>http://localhost:8989</code><br><strong>Content-Type</strong>: <code>application/json</code> (unless specified otherwise)<br><strong>Rate Limiting</strong>: 100 requests per 15-minute window per IP<br><strong>WebSocket</strong>: <code>ws://localhost:8988</code> for real-time updates</p>
<hr>
<h2>Authentication &amp; Security</h2>
<h3>Current State</h3>
<ul>
<li><strong>Authentication</strong>: Not implemented (open API)</li>
<li><strong>Authorization</strong>: Not implemented</li>
<li><strong>Security Headers</strong>: Enabled (HSTS, XSS Protection, Content-Type Options)</li>
<li><strong>CORS</strong>: Configurable (default: all origins)</li>
<li><strong>Rate Limiting</strong>: IP-based with configurable thresholds</li>
</ul>
<h3>Planned Security Features</h3>
<ul>
<li>JWT-based authentication</li>
<li>Role-based access control (RBAC)</li>
<li>API key authentication for integrations</li>
<li>OAuth 2.0 support</li>
</ul>
<hr>
<h2>Health &amp; Status</h2>
<h3>GET /health</h3>
<p>System health check and status information.</p>
<p><strong>Request</strong>:</p>
<pre><code class="language-http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/health</span> <span class="hljs-meta">HTTP/1.1</span>
<span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost:8989</code></pre><p><strong>Response</strong> <code>200 OK</code>:</p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;status&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;healthy&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;version&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1.0.13&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;database&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;status&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;connected&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;tables&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;vulnerabilities&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;tickets&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;vulnerability_imports&quot;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;lastBackup&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-01-12T10:30:00Z&quot;</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;websocket&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;status&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;running&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;port&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">8988</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;connections&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">3</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;uptime&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2d 4h 15m 32s&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;memory&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;used&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;156.2 MB&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;total&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;512 MB&quot;</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;disk&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;available&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;15.2 GB&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;database_size&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;42.3 MB&quot;</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre><hr>
<h2>Vulnerability Management API</h2>
<h3>GET /api/vulnerabilities</h3>
<p>Retrieve paginated list of active vulnerabilities.</p>
<p><strong>Query Parameters</strong>:</p>
<ul>
<li><code>page</code> (integer, optional): Page number (default: 1)</li>
<li><code>limit</code> (integer, optional): Items per page (default: 50, max: 200)</li>
<li><code>search</code> (string, optional): Search term for hostname, CVE, or plugin name</li>
<li><code>severity</code> (string, optional): Filter by severity (<code>Critical</code>, <code>High</code>, <code>Medium</code>, <code>Low</code>)</li>
<li><code>lifecycle_state</code> (string, optional): Filter by state (<code>active</code>, <code>reopened</code>, <code>resolved</code>)</li>
<li><code>host</code> (string, optional): Filter by specific hostname</li>
<li><code>date_range</code> (string, optional): Format &quot;YYYY-MM-DD,YYYY-MM-DD&quot;</li>
</ul>
<p><strong>Request</strong>:</p>
<pre><code class="language-http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/api/vulnerabilities?page=1&amp;limit=25&amp;severity=Critical&amp;search=SSH</span> <span class="hljs-meta">HTTP/1.1</span>
<span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost:8989</code></pre><p><strong>Response</strong> <code>200 OK</code>:</p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;data&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1245</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;import_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">42</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;hostname&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;web-server-01.corp.local&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;ip_address&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;10.0.1.15&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;cve&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;CVE-2024-0001&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;severity&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Critical&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;vpr_score&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">9.2</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;cvss_base_score&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">9.8</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;cvss_temporal_score&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">8.7</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;plugin_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;12345&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;plugin_name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;OpenSSH Remote Code Execution&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Remote code execution vulnerability in OpenSSH server&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;solution&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Update OpenSSH to version 9.6 or later&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;first_seen&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-01-10T08:30:00Z&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;last_seen&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-01-12T14:20:00Z&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;lifecycle_state&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;active&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;scan_date&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-01-12T14:20:00Z&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;vendor&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;tenable&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;port&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">22</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;protocol&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;TCP&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;exploit_available&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;patch_publication_date&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-01-08T00:00:00Z&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;vulnerability_publication_date&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-01-05T00:00:00Z&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;tags&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;ssh&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;rce&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;critical-infrastructure&quot;</span><span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;pagination&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;page&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;limit&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">25</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;total&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1847</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;pages&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">74</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;has_next&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;has_prev&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;filters_applied&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;severity&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Critical&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;search&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;SSH&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;active_filters_count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;meta&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;query_time&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;0.045s&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;cache_hit&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;total_without_filters&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">5234</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre><h3>GET /api/vulnerabilities/stats</h3>
<p>Aggregate vulnerability statistics and metrics.</p>
<p><strong>Request</strong>:</p>
<pre><code class="language-http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/api/vulnerabilities/stats</span> <span class="hljs-meta">HTTP/1.1</span>
<span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost:8989</code></pre><p><strong>Response</strong> <code>200 OK</code>:</p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;by_severity&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;severity&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Critical&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">89</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;percentage&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">4.2</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;avg_vpr_score&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">9.1</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;avg_age_days&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">12.5</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;severity&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;High&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">342</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;percentage&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">16.3</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;avg_vpr_score&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">7.8</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;avg_age_days&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">28.3</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;severity&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Medium&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1108</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;percentage&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">52.7</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;avg_vpr_score&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">5.2</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;avg_age_days&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">45.2</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;severity&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Low&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">563</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;percentage&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">26.8</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;avg_vpr_score&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2.1</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;avg_age_days&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">67.8</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;totals&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;active_vulnerabilities&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2102</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;resolved_last_30_days&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">456</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;newly_discovered_last_7_days&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">78</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;unique_hosts&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">245</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;unique_cves&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1847</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;trends&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;total_change_7_days&quot;</span><span class="hljs-punctuation">:</span> +<span class="hljs-number">23</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;critical_change_7_days&quot;</span><span class="hljs-punctuation">:</span> +<span class="hljs-number">5</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;resolution_rate_30_days&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0.178</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;top_vulnerability_families&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;family&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Web Application Vulnerabilities&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">423</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;percentage&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">20.1</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;family&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Operating System Vulnerabilities&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">389</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;percentage&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">18.5</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span></code></pre><h3>GET /api/vulnerabilities/trends</h3>
<p>Historical vulnerability trends and analytics.</p>
<p><strong>Query Parameters</strong>:</p>
<ul>
<li><code>period</code> (string, optional): Time period (<code>7d</code>, <code>30d</code>, <code>90d</code>, <code>1y</code>) (default: 30d)</li>
<li><code>granularity</code> (string, optional): Data granularity (<code>daily</code>, <code>weekly</code>, <code>monthly</code>) (default: daily)</li>
</ul>
<p><strong>Request</strong>:</p>
<pre><code class="language-http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/api/vulnerabilities/trends?period=30d&amp;granularity=daily</span> <span class="hljs-meta">HTTP/1.1</span>
<span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost:8989</code></pre><p><strong>Response</strong> <code>200 OK</code>:</p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;period&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;30d&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;granularity&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;daily&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;data_points&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">30</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;trends&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;date&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-01-12&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;total_active&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2102</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;new_discoveries&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">12</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;resolved&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">8</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;critical&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">89</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;high&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">342</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;medium&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1108</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;low&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">563</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;net_change&quot;</span><span class="hljs-punctuation">:</span> +<span class="hljs-number">4</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;summary&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;avg_daily_discoveries&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">14.2</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;avg_daily_resolutions&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">11.8</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;peak_vulnerabilities&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;date&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-01-03&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2156</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;best_resolution_day&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;date&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-01-08&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;resolved&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">34</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre><h3>POST /api/vulnerabilities/import</h3>
<p>Import vulnerability data from CSV file with rollover processing.</p>
<p><strong>Content-Type</strong>: <code>multipart/form-data</code></p>
<p><strong>Request</strong>:</p>
<pre><code class="language-http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/api/vulnerabilities/import</span> <span class="hljs-meta">HTTP/1.1</span>
<span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost:8989
<span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundary

<span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundary</span>
Content-Disposition: form-data; <span class="hljs-type">name</span>=&quot;csvFile&quot;; filename=&quot;vulnerabilities_2025-01-12.csv&quot;
Content-<span class="hljs-keyword">Type</span>: <span class="hljs-type">text</span>/csv

hostname,cve,severity,vpr_score,plugin_id,plugin_name
web-<span class="hljs-keyword">server</span><span class="hljs-number">-01</span>,CVE<span class="hljs-number">-2024</span><span class="hljs-number">-0001</span>,Critical,<span class="hljs-number">9.2</span>,<span class="hljs-number">12345</span>,&quot;OpenSSH RCE&quot;
<span class="hljs-comment">------WebKitFormBoundary</span>
Content-Disposition: form-data; <span class="hljs-type">name</span>=&quot;vendor&quot;

tenable
<span class="hljs-comment">------WebKitFormBoundary</span>
Content-Disposition: form-data; <span class="hljs-type">name</span>=&quot;scanDate&quot;

<span class="hljs-number">2025</span><span class="hljs-number">-01</span><span class="hljs-number">-12</span>T14:<span class="hljs-number">20</span>:<span class="hljs-number">00</span>Z
<span class="hljs-comment">------WebKitFormBoundary--</span></span></code></pre><p><strong>Success Response</strong> <code>200 OK</code>:</p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;success&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;import_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">47</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;processing_stats&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;total_rows_processed&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1847</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;new_vulnerabilities&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">78</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;updated_vulnerabilities&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">234</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;resolved_vulnerabilities&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">45</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;skipped_duplicates&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">12</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;processing_time_ms&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">3420</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;scan_metadata&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;scan_date&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-01-12T14:20:00Z&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;vendor&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;tenable&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;filename&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;vulnerabilities_2025-01-12.csv&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;file_size&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2048576</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;data_quality&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;valid_cves&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1835</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;invalid_cves&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">12</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;missing_fields&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;data_quality_score&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0.993</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;rollover_results&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;snapshot_created&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;current_table_updated&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;daily_totals_updated&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;stale_entries_removed&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">23</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre><p><strong>Error Response</strong> <code>400 Bad Request</code>:</p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;success&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;error&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;code&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;INVALID_CSV_FORMAT&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;message&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;CSV file contains invalid format or missing required columns&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;details&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;required_columns&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;hostname&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;cve&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;severity&quot;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;missing_columns&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;hostname&quot;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;invalid_rows&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">7</span><span class="hljs-punctuation">,</span> <span class="hljs-number">12</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;line_errors&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
        <span class="hljs-punctuation">{</span>
          <span class="hljs-attr">&quot;line&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span>
          <span class="hljs-attr">&quot;error&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Missing hostname field&quot;</span>
        <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre><h3>DELETE /api/vulnerabilities/clear</h3>
<p>Clear all vulnerability data (admin operation).</p>
<p><strong>Request</strong>:</p>
<pre><code class="language-http"><span class="hljs-keyword">DELETE</span> <span class="hljs-string">/api/vulnerabilities/clear</span> <span class="hljs-meta">HTTP/1.1</span>
<span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost:8989
<span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/json

<span class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;confirm&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;backup_before_clear&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
<span class="hljs-punctuation">}</span></span></code></pre><p><strong>Response</strong> <code>200 OK</code>:</p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;success&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;message&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;All vulnerability data cleared successfully&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;backup_created&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;backup_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;backup_2025-01-12_10-30-45&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;records_backed_up&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2102</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;backup_size_bytes&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">15728640</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;cleared_tables&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-string">&quot;vulnerabilities&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">&quot;vulnerability_snapshots&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">&quot;vulnerabilities_current&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">&quot;vulnerability_daily_totals&quot;</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span></code></pre><hr>
<h2>Ticket Management API</h2>
<h3>GET /api/tickets</h3>
<p>Retrieve tickets with filtering and pagination.</p>
<p><strong>Query Parameters</strong>:</p>
<ul>
<li><code>page</code> (integer, optional): Page number (default: 1)</li>
<li><code>limit</code> (integer, optional): Items per page (default: 50)</li>
<li><code>status</code> (string, optional): Filter by status (<code>Open</code>, <code>In Progress</code>, <code>Resolved</code>, <code>Closed</code>)</li>
<li><code>urgency</code> (string, optional): Filter by urgency (<code>Low</code>, <code>Medium</code>, <code>High</code>, <code>Critical</code>)</li>
<li><code>assigned_to</code> (string, optional): Filter by assignee</li>
<li><code>location</code> (string, optional): Filter by location</li>
<li><code>created_after</code> (string, optional): ISO date string</li>
<li><code>created_before</code> (string, optional): ISO date string</li>
</ul>
<p><strong>Request</strong>:</p>
<pre><code class="language-http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/api/tickets?status=Open&amp;urgency=High&amp;page=1&amp;limit=25</span> <span class="hljs-meta">HTTP/1.1</span>
<span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost:8989</code></pre><p><strong>Response</strong> <code>200 OK</code>:</p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;data&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;TKT-2025-0234&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;location&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Data Center 1 - Rack A3&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;devices&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
        <span class="hljs-string">&quot;web-server-01.corp.local&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-string">&quot;db-server-02.corp.local&quot;</span>
      <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Critical SSH vulnerabilities requiring immediate patching&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;urgency&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;High&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;category&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Security&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;status&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Open&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;assigned_to&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;john.doe@company.com&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;created_date&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-01-12T09:15:00Z&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;updated_date&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-01-12T14:30:00Z&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;notes&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Coordinated with security team. Maintenance window scheduled for tonight.&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;related_vulnerabilities&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
        <span class="hljs-string">&quot;CVE-2024-0001&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-string">&quot;CVE-2024-0002&quot;</span>
      <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;estimated_resolution&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-01-13T02:00:00Z&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;priority_score&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">8.5</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;tags&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;ssh&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;critical&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;infrastructure&quot;</span><span class="hljs-punctuation">]</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;pagination&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;page&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;limit&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">25</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;total&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">127</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;pages&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">6</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;has_next&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;has_prev&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;summary&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;total_open&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">45</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;total_in_progress&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">23</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;total_high_urgency&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">12</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;avg_resolution_time_hours&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">18.5</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre><h3>POST /api/tickets</h3>
<p>Create a new support ticket.</p>
<p><strong>Request</strong>:</p>
<pre><code class="language-http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/api/tickets</span> <span class="hljs-meta">HTTP/1.1</span>
<span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost:8989
<span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/json

<span class="language-prolog">{
  <span class="hljs-string">&quot;location&quot;</span>: <span class="hljs-string">&quot;Data Center 1 - Rack A3&quot;</span>,
  <span class="hljs-string">&quot;devices&quot;</span>: [
    <span class="hljs-string">&quot;web-server-01.corp.local&quot;</span>,
    <span class="hljs-string">&quot;db-server-02.corp.local&quot;</span>
  ],
  <span class="hljs-string">&quot;description&quot;</span>: <span class="hljs-string">&quot;Critical SSH vulnerabilities requiring immediate patching&quot;</span>,
  <span class="hljs-string">&quot;urgency&quot;</span>: <span class="hljs-string">&quot;High&quot;</span>,
  <span class="hljs-string">&quot;category&quot;</span>: <span class="hljs-string">&quot;Security&quot;</span>,
  <span class="hljs-string">&quot;assigned_to&quot;</span>: <span class="hljs-string">&quot;john.doe@company.com&quot;</span>,
  <span class="hljs-string">&quot;related_vulnerabilities&quot;</span>: [
    <span class="hljs-string">&quot;CVE-2024-0001&quot;</span>,
    <span class="hljs-string">&quot;CVE-2024-0002&quot;</span>
  ],
  <span class="hljs-string">&quot;estimated_resolution&quot;</span>: <span class="hljs-string">&quot;2025-01-13T02:00:00Z&quot;</span>,
  <span class="hljs-string">&quot;tags&quot;</span>: [<span class="hljs-string">&quot;ssh&quot;</span>, <span class="hljs-string">&quot;critical&quot;</span>, <span class="hljs-string">&quot;infrastructure&quot;</span>]
}</span></code></pre><p><strong>Response</strong> <code>201 Created</code>:</p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;success&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;ticket&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;TKT-2025-0235&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;location&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Data Center 1 - Rack A3&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;devices&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-string">&quot;web-server-01.corp.local&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-string">&quot;db-server-02.corp.local&quot;</span>
    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Critical SSH vulnerabilities requiring immediate patching&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;urgency&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;High&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;category&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Security&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;status&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Open&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;assigned_to&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;john.doe@company.com&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;created_date&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-01-12T15:45:00Z&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;updated_date&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-01-12T15:45:00Z&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;notes&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;related_vulnerabilities&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-string">&quot;CVE-2024-0001&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-string">&quot;CVE-2024-0002&quot;</span>
    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;estimated_resolution&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-01-13T02:00:00Z&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;priority_score&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">8.5</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;tags&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;ssh&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;critical&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;infrastructure&quot;</span><span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre><h3>PUT /api/tickets/:id</h3>
<p>Update an existing ticket.</p>
<p><strong>Request</strong>:</p>
<pre><code class="language-http"><span class="hljs-keyword">PUT</span> <span class="hljs-string">/api/tickets/TKT-2025-0234</span> <span class="hljs-meta">HTTP/1.1</span>
<span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost:8989
<span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/json

<span class="language-perl">{
  <span class="hljs-string">&quot;status&quot;</span>: <span class="hljs-string">&quot;In Progress&quot;</span>,
  <span class="hljs-string">&quot;notes&quot;</span>: <span class="hljs-string">&quot;Started patching process. Web-server-01 completed successfully.&quot;</span>,
  <span class="hljs-string">&quot;assigned_to&quot;</span>: <span class="hljs-string">&quot;jane.smith<span class="hljs-variable">@company</span>.com&quot;</span>
}</span></code></pre><p><strong>Response</strong> <code>200 OK</code>:</p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;success&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;ticket&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;TKT-2025-0234&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;status&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;In Progress&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;notes&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Started patching process. Web-server-01 completed successfully.&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;assigned_to&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;jane.smith@company.com&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;updated_date&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-01-12T16:20:00Z&quot;</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre><h3>DELETE /api/tickets/:id</h3>
<p>Delete a ticket (soft delete).</p>
<p><strong>Request</strong>:</p>
<pre><code class="language-http"><span class="hljs-keyword">DELETE</span> <span class="hljs-string">/api/tickets/TKT-2025-0234</span> <span class="hljs-meta">HTTP/1.1</span>
<span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost:8989</code></pre><p><strong>Response</strong> <code>200 OK</code>:</p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;success&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;message&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Ticket TKT-2025-0234 deleted successfully&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;deleted_at&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-01-12T16:25:00Z&quot;</span>
<span class="hljs-punctuation">}</span></code></pre><hr>
<h2>Backup &amp; Restore API</h2>
<h3>GET /api/backup/all</h3>
<p>Export complete database backup.</p>
<p><strong>Query Parameters</strong>:</p>
<ul>
<li><code>format</code> (string, optional): Export format (<code>json</code>, <code>csv</code>) (default: json)</li>
<li><code>include_resolved</code> (boolean, optional): Include resolved vulnerabilities (default: false)</li>
<li><code>compress</code> (boolean, optional): Compress response (default: true)</li>
</ul>
<p><strong>Request</strong>:</p>
<pre><code class="language-http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/api/backup/all?format=json&amp;compress=true</span> <span class="hljs-meta">HTTP/1.1</span>
<span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost:8989</code></pre><p><strong>Response</strong> <code>200 OK</code>:</p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;backup_metadata&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;backup_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;backup_2025-01-12_16-30-00&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;created_at&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-01-12T16:30:00Z&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;version&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1.0.13&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;format&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;json&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;compressed&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;total_records&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2229</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;data&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;vulnerabilities&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1245</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;hostname&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;web-server-01.corp.local&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;cve&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;CVE-2024-0001&quot;</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;tickets&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;TKT-2025-0234&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;location&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Data Center 1&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;status&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Open&quot;</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;vulnerability_imports&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
      <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">47</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;filename&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;vulnerabilities_2025-01-12.csv&quot;</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">&quot;import_date&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-01-12T14:20:00Z&quot;</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">]</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre><h3>POST /api/restore</h3>
<p>Restore data from backup file.</p>
<p><strong>Content-Type</strong>: <code>multipart/form-data</code></p>
<p><strong>Request</strong>:</p>
<pre><code class="language-http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/api/restore</span> <span class="hljs-meta">HTTP/1.1</span>
<span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost:8989
<span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundary

<span class="language-pgsql"><span class="hljs-comment">------WebKitFormBoundary</span>
Content-Disposition: form-data; <span class="hljs-type">name</span>=&quot;file&quot;; filename=&quot;backup_2025-01-12.json&quot;
Content-<span class="hljs-keyword">Type</span>: application/<span class="hljs-type">json</span>

{backup data}
<span class="hljs-comment">------WebKitFormBoundary</span>
Content-Disposition: form-data; <span class="hljs-type">name</span>=&quot;options&quot;

{
  &quot;clear_existing&quot;: <span class="hljs-keyword">true</span>,
  &quot;validate_data&quot;: <span class="hljs-keyword">true</span>,
  &quot;create_backup_before_restore&quot;: <span class="hljs-keyword">true</span>
}
<span class="hljs-comment">------WebKitFormBoundary--</span></span></code></pre><p><strong>Response</strong> <code>200 OK</code>:</p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;success&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;restore_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;restore_2025-01-12_16-45-00&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;backup_created&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;backup_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;pre_restore_backup_2025-01-12_16-44-30&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;records_backed_up&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2102</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;restoration_stats&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;vulnerabilities_restored&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1847</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;tickets_restored&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">234</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;imports_restored&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">45</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;total_records&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2126</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;validation_errors&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;processing_time_ms&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">5420</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;warnings&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span></code></pre><hr>
<h2>Reference Data API</h2>
<h3>GET /api/sites</h3>
<p>List all available sites/locations.</p>
<p><strong>Response</strong> <code>200 OK</code>:</p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;sites&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;DC1&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Data Center 1&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;location&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;New York, NY&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;active_devices&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">45</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;total_vulnerabilities&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">234</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;DC2&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Data Center 2&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;location&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;San Francisco, CA&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;active_devices&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">67</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;total_vulnerabilities&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">189</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span></code></pre><h3>GET /api/locations</h3>
<p>List all device locations within sites.</p>
<p><strong>Response</strong> <code>200 OK</code>:</p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;locations&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;site_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;DC1&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;location&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Rack A1&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;device_count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">8</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;vulnerability_count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">23</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;site_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;DC1&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;location&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Rack A2&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;device_count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">6</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;vulnerability_count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">31</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span></code></pre><hr>
<h2>WebSocket API</h2>
<h3>Connection</h3>
<p>Connect to WebSocket server for real-time updates.</p>
<p><strong>Connection</strong>:</p>
<pre><code class="language-javascript"><span class="hljs-keyword">const</span> socket = <span class="hljs-title function_">io</span>(<span class="hljs-string">&#x27;ws://localhost:8988&#x27;</span>);</code></pre><h3>Events</h3>
<h4>Progress Updates</h4>
<p>Real-time progress for long-running operations.</p>
<p><strong>Event</strong>: <code>import_progress</code></p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;session_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;session_12345&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;operation&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;vulnerability_import&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;progress&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0.65</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;current_step&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Processing CSV data&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;processed_rows&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1200</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;total_rows&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1847</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;eta_seconds&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">45</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;status&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;processing&quot;</span>
<span class="hljs-punctuation">}</span></code></pre><h4>Import Complete</h4>
<p>Notification when import operations finish.</p>
<p><strong>Event</strong>: <code>import_complete</code></p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;session_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;session_12345&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;operation&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;vulnerability_import&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;success&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;import_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">47</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;total_processed&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1847</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;processing_time_ms&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">3420</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;summary&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;new&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">78</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;updated&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">234</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;resolved&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">45</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre><h4>Data Updates</h4>
<p>Broadcast when vulnerability or ticket data changes.</p>
<p><strong>Event</strong>: <code>data_updated</code></p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;vulnerabilities&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;action&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;created&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">12</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;affected_hosts&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;web-server-01&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;db-server-02&quot;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;timestamp&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-01-12T16:50:00Z&quot;</span>
<span class="hljs-punctuation">}</span></code></pre><h4>System Alerts</h4>
<p>Critical system notifications.</p>
<p><strong>Event</strong>: <code>system_alert</code></p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;level&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;warning&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;message&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Database backup recommended - last backup was 7 days ago&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;category&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;maintenance&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;action_required&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;timestamp&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-01-12T16:55:00Z&quot;</span>
<span class="hljs-punctuation">}</span></code></pre><hr>
<h2>Error Handling</h2>
<h3>Standard Error Format</h3>
<p>All API endpoints return errors in consistent format:</p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;success&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;error&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;code&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ERROR_CODE&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;message&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Human readable error message&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;details&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;field&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;specific field that caused error&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;received&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;invalid_value&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;expected&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;valid_format&quot;</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;request_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;req_12345&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;timestamp&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-01-12T17:00:00Z&quot;</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre><h3>Common Error Codes</h3>
<h4>400 Bad Request</h4>
<ul>
<li><code>INVALID_REQUEST_FORMAT</code>: Request body format invalid</li>
<li><code>MISSING_REQUIRED_FIELD</code>: Required field missing</li>
<li><code>INVALID_FIELD_VALUE</code>: Field value doesn&#39;t meet validation requirements</li>
<li><code>INVALID_CSV_FORMAT</code>: CSV file format errors</li>
<li><code>FILE_TOO_LARGE</code>: Uploaded file exceeds size limit</li>
</ul>
<h4>429 Too Many Requests</h4>
<ul>
<li><code>RATE_LIMIT_EXCEEDED</code>: IP has exceeded rate limit</li>
</ul>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;success&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;error&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;code&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;RATE_LIMIT_EXCEEDED&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;message&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Rate limit exceeded. Try again in 15 minutes.&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;details&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;limit&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">100</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;window_minutes&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;reset_time&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-01-12T17:15:00Z&quot;</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre><h4>500 Internal Server Error</h4>
<ul>
<li><code>DATABASE_ERROR</code>: Database operation failed</li>
<li><code>PROCESSING_ERROR</code>: Data processing error</li>
<li><code>WEBSOCKET_ERROR</code>: WebSocket communication error</li>
</ul>
<hr>
<h2>Additional API Endpoints</h2>
<h3>GET /api/vulnerabilities/resolved</h3>
<p>Retrieve resolved vulnerabilities with pagination.</p>
<p><strong>Query Parameters</strong>:</p>
<ul>
<li><code>page</code> (integer, optional): Page number (default: 1)</li>
<li><code>limit</code> (integer, optional): Items per page (default: 50)</li>
<li><code>resolved_after</code> (string, optional): ISO date string</li>
<li><code>resolved_before</code> (string, optional): ISO date string</li>
</ul>
<p><strong>Request</strong>:</p>
<pre><code class="language-http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/api/vulnerabilities/resolved?page=1&amp;limit=25</span> <span class="hljs-meta">HTTP/1.1</span>
<span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost:8989</code></pre><p><strong>Response</strong> <code>200 OK</code>:</p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;data&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1156</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;hostname&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;web-server-03.corp.local&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;cve&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;CVE-2024-0003&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;severity&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;High&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;lifecycle_state&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;resolved&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;resolved_date&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-01-10T14:30:00Z&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;resolution_time_hours&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">72.5</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;pagination&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;page&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;limit&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">25</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;total&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">456</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;pages&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">19</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre><h3>GET /api/vulnerabilities/recent-trends</h3>
<p>Get recent vulnerability trend analysis (current vs previous period).</p>
<p><strong>Response</strong> <code>200 OK</code>:</p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;current_period&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;total&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2102</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;critical&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">89</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;high&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">342</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;date_range&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-01-06 to 2025-01-12&quot;</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;previous_period&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;total&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2079</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;critical&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">84</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;high&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">339</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;date_range&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2024-12-30 to 2025-01-05&quot;</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;changes&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;total_change&quot;</span><span class="hljs-punctuation">:</span> +<span class="hljs-number">23</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;critical_change&quot;</span><span class="hljs-punctuation">:</span> +<span class="hljs-number">5</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;high_change&quot;</span><span class="hljs-punctuation">:</span> +<span class="hljs-number">3</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;trend&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;increasing&quot;</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre><h3>POST /api/vulnerabilities/import-staging</h3>
<p>Import vulnerabilities to staging table for preview/validation.</p>
<p><strong>Content-Type</strong>: <code>multipart/form-data</code></p>
<p><strong>Response</strong> <code>200 OK</code>:</p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;success&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;staging_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;staging_12345&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;preview_stats&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;total_rows&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1847</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;valid_rows&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1835</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;invalid_rows&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">12</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;estimated_new&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">78</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;estimated_updates&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">234</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre><h3>GET /api/imports</h3>
<p>List import history with metadata.</p>
<p><strong>Query Parameters</strong>:</p>
<ul>
<li><code>page</code> (integer, optional): Page number (default: 1)</li>
<li><code>limit</code> (integer, optional): Items per page (default: 20)</li>
<li><code>vendor</code> (string, optional): Filter by vendor</li>
</ul>
<p><strong>Response</strong> <code>200 OK</code>:</p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;imports&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">47</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;filename&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;vulnerabilities_2025-01-12.csv&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;vendor&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;tenable&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;import_date&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-01-12T14:20:00Z&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;row_count&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1847</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;processing_time&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">3420</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;file_size&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2048576</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;status&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;completed&quot;</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;pagination&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;page&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;limit&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">20</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;total&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">47</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre><h3>POST /api/tickets/migrate</h3>
<p>Migrate tickets from external systems.</p>
<p><strong>Request</strong>:</p>
<pre><code class="language-http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/api/tickets/migrate</span> <span class="hljs-meta">HTTP/1.1</span>
<span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost:8989
<span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/json

<span class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;tickets&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">&quot;external_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;SN-12345&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;system&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;servicenow&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;location&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Data Center 1&quot;</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">&quot;status&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Open&quot;</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;migration_options&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;update_existing&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;preserve_ids&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></span></code></pre><p><strong>Response</strong> <code>200 OK</code>:</p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;success&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;migration_stats&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;total_processed&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">25</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;created&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">18</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;updated&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">7</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;skipped&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;errors&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre><h3>DELETE /api/backup/clear/:type</h3>
<p>Clear specific data types (vulnerabilities, tickets, imports).</p>
<p><strong>Path Parameters</strong>:</p>
<ul>
<li><code>type</code> (string): Data type to clear (<code>vulnerabilities</code>, <code>tickets</code>, <code>imports</code>)</li>
</ul>
<p><strong>Request</strong>:</p>
<pre><code class="language-http"><span class="hljs-keyword">DELETE</span> <span class="hljs-string">/api/backup/clear/vulnerabilities</span> <span class="hljs-meta">HTTP/1.1</span>
<span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost:8989
<span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/json

<span class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;confirm&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;backup_before_clear&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span>
<span class="hljs-punctuation">}</span></span></code></pre><p><strong>Response</strong> <code>200 OK</code>:</p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;success&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;vulnerabilities&quot;</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;records_cleared&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2102</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;backup_created&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;backup_2025-01-12_17-15-30&quot;</span>
<span class="hljs-punctuation">}</span></code></pre><h3>GET /api/backup/stats</h3>
<p>Get backup and database statistics.</p>
<p><strong>Response</strong> <code>200 OK</code>:</p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;database&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;vulnerabilities&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2102</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;tickets&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">234</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;imports&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">47</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;total_size_mb&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">42.3</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;last_backup&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;date&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-01-12T10:30:00Z&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;size_mb&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">38.7</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;automatic&quot;</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;recommendations&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-string">&quot;Consider backup - last backup was 7 hours ago&quot;</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span></code></pre><h3>GET /api/docs/stats</h3>
<p>Documentation system statistics and health.</p>
<p><strong>Response</strong> <code>200 OK</code>:</p>
<pre><code class="language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">&quot;documentation&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;total_files&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">45</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;total_size_kb&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1024</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;last_updated&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2025-01-12T16:00:00Z&quot;</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;api_endpoints_documented&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">32</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;coverage_percentage&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">95.8</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">&quot;health&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">&quot;broken_links&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;outdated_content&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">&quot;missing_examples&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span>
  <span class="hljs-punctuation">}</span>
<span class="hljs-punctuation">}</span></code></pre><hr>
<h2>Development and Testing Endpoints</h2>
<h3>GET /docs-html</h3>
<p>Serve documentation portal (HTML interface).</p>
<h3>GET /docs-html/:section.html</h3>
<p>Serve specific documentation sections.</p>
<p><strong>Path Parameters</strong>:</p>
<ul>
<li><code>section</code> (string): Documentation section name</li>
</ul>
<hr>
<h2>File Upload Specifications</h2>
<h3>CSV Import Format</h3>
<p><strong>Supported Columns</strong> (case-insensitive):</p>
<ul>
<li><code>hostname</code> (required): Device hostname or FQDN</li>
<li><code>ip_address</code> (optional): Device IP address</li>
<li><code>cve</code> (optional): CVE identifier</li>
<li><code>severity</code> (required): Critical, High, Medium, Low</li>
<li><code>vpr_score</code> (optional): Vulnerability Priority Rating (0-10)</li>
<li><code>cvss_score</code> (optional): CVSS Base Score (0-10)</li>
<li><code>plugin_id</code> (optional): Scanner plugin identifier</li>
<li><code>plugin_name</code> (optional): Scanner plugin name</li>
<li><code>description</code> (optional): Vulnerability description</li>
<li><code>solution</code> (optional): Remediation guidance</li>
<li><code>first_seen</code> (optional): ISO date string</li>
<li><code>last_seen</code> (optional): ISO date string</li>
</ul>
<p><strong>File Constraints</strong>:</p>
<ul>
<li>Maximum file size: 50MB</li>
<li>Supported formats: CSV, TXT</li>
<li>Encoding: UTF-8</li>
<li>Maximum rows: 100,000 per import</li>
</ul>
<h3>Backup/Restore Format</h3>
<p><strong>Supported Formats</strong>:</p>
<ul>
<li>JSON: Complete structured export</li>
<li>CSV: Individual table exports</li>
<li>ZIP: Compressed multi-table exports</li>
</ul>
<p><strong>Restore Options</strong>:</p>
<ul>
<li><code>clear_existing</code>: Remove existing data before restore</li>
<li><code>validate_data</code>: Validate data integrity during restore</li>
<li><code>create_backup_before_restore</code>: Safety backup before operation</li>
</ul>
<hr>
<p>This comprehensive API reference provides complete technical specifications for integrating with HexTrackr, suitable for security review and development planning.</p>

    <!-- Note: This file is intentionally minimal. The full page scaffold, header, footer, and scripts
             are provided by docs-html/index.html. Content generated using this template will be
             fetched and injected into #content-container by docs-html/js/docs-portal-v2.js. -->
</section>
