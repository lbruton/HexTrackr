<!-- Fragment template for documentation content injected by docs-tabler.js -->
<section class="doc-fragment">
    <h1>Vulnerability Management Guide</h1>
<p>The Vulnerability Management dashboard (<code>vulnerabilities.html</code>) is a powerful tool for analyzing, tracking, and managing security vulnerabilities across your assets.</p>
<h2>Importing Vulnerability Data</h2>
<p>The primary way to populate the dashboard is by importing CSV files from vulnerability scanners. HexTrackr supports multiple CSV formats with advanced processing capabilities.</p>
<h3>Basic Import Process</h3>
<ol>
<li>From the dashboard, click the <strong>Import</strong> button.</li>
<li>You will be prompted to select a <strong>Scan Date</strong>. This date is critical for accurate historical trending. It should be the date the vulnerability scan was performed.</li>
<li>After confirming the date, select the CSV file from your computer.</li>
</ol>
<p>The system will then upload and process the file. Thanks to the <a href="#architecture/rollover-mechanism">rollover architecture</a>, the new data will be integrated, and the dashboard will automatically refresh.</p>
<h3>Supported CSV Formats</h3>
<p>HexTrackr automatically detects and processes multiple CSV export formats from various vulnerability scanners:</p>
<h4>Format 1: Legacy Cisco Export (aug28 style)</h4>
<h2>Key Characteristics</h2>
<ul>
<li>Missing <code>definition.cve</code> column</li>
<li>CVE data extracted from <code>definition.name</code> using intelligent regex patterns</li>
<li>Cisco vulnerability IDs extracted from parentheses in vulnerability names</li>
</ul>
<h2>Supported Columns</h2>
<ul>
<li><code>asset.display_ipv4_address</code> - Primary IP address of the asset</li>
<li><code>asset.id</code> - Unique asset identifier</li>
<li><code>asset.name</code> - Hostname of the affected device</li>
<li><code>definition.family</code> - Vulnerability family (e.g., &quot;CISCO&quot;, &quot;Misc.&quot;)</li>
<li><code>definition.id</code> - Plugin/vulnerability identifier</li>
<li><code>definition.name</code> - Full vulnerability name with embedded identifiers</li>
<li><code>definition.vpr.score</code> - Vulnerability Priority Rating score</li>
<li><code>id</code> - Unique vulnerability instance identifier</li>
<li><code>severity</code> - Risk severity level</li>
<li><code>state</code> - Vulnerability state (typically &quot;ACTIVE&quot;)</li>
</ul>
<h2>CVE Extraction Examples</h2>
<ul>
<li><code>Cisco IOS XE Software Bootstrap (cisco-sa-bootstrap-KfgxYgdh)</code> → extracts <code>cisco-sa-bootstrap-KfgxYgdh</code></li>
<li><code>SSH Weak MAC Algorithms Enabled</code> → no CVE extracted (handled via plugin ID)</li>
</ul>
<h4>Format 2: Standard Cisco Export (sept01/sept02 style)</h4>
<h2>Key Characteristics: (2)</h2>
<ul>
<li>Direct <code>definition.cve</code> column mapping (recommended format)</li>
<li>Enhanced metadata including plugin publication dates</li>
<li>Support for resurfaced vulnerability tracking</li>
</ul>
<h2>Additional Columns</h2>
<ul>
<li><code>definition.cve</code> - Direct CVE identifier mapping</li>
<li><code>definition.plugin_published</code> - Plugin publication date (ISO format)</li>
<li><code>definition.plugin_updated</code> - Plugin last update date (ISO format)</li>
<li><code>resurfaced_date</code> - Date when vulnerability reappeared (if applicable)</li>
</ul>
<p><strong>This is the recommended export format</strong> for optimal data quality and processing efficiency.</p>
<h4>Format 3: Full Tenable Export (comprehensive format)</h4>
<h2>Key Characteristics: (3)</h2>
<ul>
<li>Support for <code>asset.ipv4_addresses</code> with multiple comma-separated IPs</li>
<li>Comprehensive vulnerability metadata and risk scoring</li>
<li>Enhanced fields for advanced vulnerability management</li>
<li>Handles large files (60MB+) efficiently</li>
</ul>
<h2>Extended Columns</h2>
<ul>
<li><code>asset.ipv4_addresses</code> - Multiple IP addresses (comma-separated)</li>
<li><code>definition.description</code> - Detailed vulnerability description</li>
<li><code>definition.vpr_v2.score</code> - Enhanced VPR scoring</li>
<li><code>definition.vpr_v2.drivers_cve_id</code> - CVE drivers for VPR calculation</li>
<li><code>definition.vulnerability_published</code> - CVE publication date</li>
<li><code>vuln_age</code> - Age of vulnerability in days</li>
<li><code>vuln_sla_date</code> - SLA target date for remediation</li>
<li><code>port</code> - Affected network port</li>
<li><code>protocol</code> - Network protocol</li>
<li><code>age_in_days</code> - Asset exposure duration</li>
</ul>
<h3>Advanced Import Features</h3>
<h4>CVE and Vulnerability ID Extraction Logic</h4>
<p>The import system uses a comprehensive multi-tier approach to identify vulnerability information:</p>
<ol>
<li><strong>Primary CVE</strong>: Direct mapping from <code>definition.cve</code> column</li>
<li><strong>CVE Fallback</strong>: Regex extraction from <code>definition.name</code> using pattern <code>(CVE-\d{4}-\d+)</code></li>
<li><strong>Cisco Vulnerability IDs</strong>: Extract Cisco Security Advisory IDs from parentheses <code>(cisco-sa-[\w-]+)</code> patterns</li>
<li><strong>Plugin Fallback</strong>: Use <code>definition.id</code> + <code>definition.name</code> for unique identification</li>
</ol>
<h5>Cisco Security Advisory Support</h5>
<p>HexTrackr now provides enhanced support for Cisco vulnerability identifiers:</p>
<ul>
<li><strong>Pattern Recognition</strong>: Automatically detects <code>cisco-sa-*</code> patterns in vulnerability names</li>
<li><strong>Link Generation</strong>: Cisco SA IDs link directly to Cisco&#39;s security advisory portal</li>
<li><strong>Display Priority</strong>: Cisco SA IDs are displayed prominently in the &quot;Vulnerability&quot; column (renamed from &quot;CVE&quot;)</li>
<li><strong>Fallback Handling</strong>: When neither CVE nor Cisco SA is available, displays plugin ID with descriptive styling</li>
</ul>
<h2>Examples</h2>
<ul>
<li><strong>CVE Direct</strong>: <code>CVE-2025-20155</code> → <code>CVE-2025-20155</code> (links to CVE.org)</li>
<li><strong>CVE Extracted</strong>: <code>Cisco IOS Software DoS (CVE-2020-3200)</code> → <code>CVE-2020-3200</code> (links to CVE.org)</li>
<li><strong>Cisco SA</strong>: <code>Bootstrap Vulnerability (cisco-sa-bootstrap-KfgxYgdh)</code> → <code>cisco-sa-bootstrap-KfgxYgdh</code> (links to cisco.com)</li>
<li><strong>Plugin ID</strong>: <code>SSH Weak Encryption</code> → <code>Plugin 12345</code> (plugin ID with styling)</li>
</ul>
<h4>Multiple Value Handling</h4>
<p><strong>CVEs (Comma-separated)</strong>:</p>
<ul>
<li>Input: <code>&quot;CVE-2023-1234, CVE-2023-5678, CVE-2023-9012&quot;</code></li>
<li>Processing: Uses first CVE (<code>CVE-2023-1234</code>) as primary identifier</li>
<li>Additional CVEs stored in description for reference</li>
</ul>
<p><strong>IP Addresses (Comma-separated)</strong>:</p>
<ul>
<li>Input: <code>&quot;10.95.12.1, 10.40.12.1, 10.50.12.1&quot;</code></li>
<li>Processing: Uses first IP (<code>10.95.12.1</code>) as primary address</li>
<li>Complete list maintained for device correlation</li>
</ul>
<h4>Hostname Normalization</h4>
<p>Automatic hostname processing for consistent device identification:</p>
<ul>
<li><strong>Domain Stripping</strong>: <code>server01.domain.com</code> → <code>server01</code></li>
<li><strong>IP Preservation</strong>: <code>192.168.1.1</code> → <code>192.168.1.1</code> (no modification)</li>
<li><strong>Invalid Format Handling</strong>: Gracefully handles malformed hostnames</li>
</ul>
<h4>Enhanced Deduplication</h4>
<p>Multi-tier unique key generation with confidence scoring:</p>
<ol>
<li><strong>Tier 1</strong>: <code>asset.id</code> + <code>definition.id</code> (95% confidence - most stable)</li>
<li><strong>Tier 2</strong>: <code>normalized_hostname</code> + <code>cve</code> (90% confidence)</li>
<li><strong>Tier 3</strong>: <code>definition.id</code> + <code>normalized_hostname</code> + <code>vendor</code> (85% confidence)</li>
<li><strong>Tier 4</strong>: <code>plugin_id</code> + <code>description</code> hash (80% confidence - fallback)</li>
</ol>
<h3>Rollover Architecture Behavior</h3>
<p>HexTrackr implements a sophisticated rollover system that manages vulnerability lifecycles:</p>
<h4>Import Processing Flow</h4>
<ol>
<li><strong>File Upload</strong>: CSV files uploaded via the dashboard import button trigger server-side processing</li>
<li><strong>Data Parsing</strong>: Advanced CSV parsing handles multiple formats with intelligent column detection</li>
<li><strong>Vulnerability ID Extraction</strong>: System extracts CVE, Cisco SA, or plugin identifiers using multi-tier logic</li>
<li><strong>New Import Storage</strong>: CSV data processed and stored in <code>vulnerability_snapshots</code> (historical record)</li>
<li><strong>Current State Update</strong>: <code>vulnerabilities_current</code> table updated with latest vulnerability state</li>
<li><strong>Lifecycle Management</strong>: System automatically determines vulnerability lifecycle states</li>
<li><strong>UI Refresh</strong>: Dashboard automatically updates to display new data with enhanced vulnerability column</li>
<li><strong>Aggregation</strong>: Daily totals updated for trend analysis</li>
</ol>
<h4>Lifecycle States</h4>
<ul>
<li><strong><code>active</code></strong>: Newly discovered or currently present vulnerabilities</li>
<li><strong><code>reopened</code></strong>: Previously resolved vulnerabilities that have reappeared</li>
<li><strong><code>resolved</code></strong>: Vulnerabilities no longer detected in latest scan</li>
</ul>
<h4>Expected Behavior After Import</h4>
<p><strong>New Vulnerabilities</strong>:</p>
<ul>
<li>Immediately appear in dashboard with <code>lifecycle_state = &#39;active&#39;</code></li>
<li>Included in current vulnerability counts and statistics</li>
<li>Available in all dashboard views (Table, Devices, Vulnerabilities)</li>
</ul>
<p><strong>Missing Vulnerabilities</strong>:</p>
<ul>
<li>Vulnerabilities not found in new scan marked as <code>lifecycle_state = &#39;resolved&#39;</code></li>
<li>Hidden from main dashboard views (maintains clean current state)</li>
<li>Historical data preserved for trend analysis</li>
</ul>
<p><strong>Reappearing Vulnerabilities</strong>:</p>
<ul>
<li>Previously resolved vulnerabilities that reappear marked as <code>lifecycle_state = &#39;reopened&#39;</code></li>
<li>Displayed prominently in dashboard with reopened status</li>
<li>Lifecycle history maintained for audit purposes</li>
</ul>
<h3>Import Troubleshooting</h3>
<h4>Common Issues and Solutions</h4>
<h2>Empty Dashboard After Import</h2>
<ul>
<li><strong>Issue</strong>: No vulnerabilities visible despite successful import</li>
<li><strong>Cause</strong>: Default view filters show only <code>active</code> and <code>reopened</code> states</li>
<li><strong>Solution</strong>: Check <code>lifecycle_state</code> filtering; resolved vulnerabilities are hidden by design</li>
<li><strong>Verification</strong>: Use <code>/api/vulnerabilities/resolved</code> endpoint to verify resolved items</li>
</ul>
<h2>Missing CVE Information</h2>
<ul>
<li><strong>Issue</strong>: CVE fields appear blank in dashboard</li>
<li><strong>Cause</strong>: CVE extraction failed from <code>definition.name</code> field</li>
<li><strong>Solution</strong>: Verify vulnerability names contain recognizable CVE patterns</li>
<li><strong>Workaround</strong>: System uses plugin ID + description for unique identification</li>
</ul>
<h2>Hostname Duplicates</h2>
<ul>
<li><strong>Issue</strong>: Same device appears multiple times with slight name variations</li>
<li><strong>Cause</strong>: Hostname normalization not handling specific domain patterns</li>
<li><strong>Solution</strong>: Check normalized hostname rules; may need custom normalization</li>
<li><strong>Example</strong>: <code>server01.corp.com</code> and <code>server01.internal.com</code> both normalize to <code>server01</code></li>
</ul>
<h2>Large File Performance</h2>
<ul>
<li><strong>Issue</strong>: Import appears slow or times out with large CSV files</li>
<li><strong>Cause</strong>: Client-side processing limitations with files over 10MB</li>
<li><strong>Solution</strong>: System automatically switches to server-side processing for large files</li>
<li><strong>Expected</strong>: Files over 60MB process successfully with progress indicators</li>
</ul>
<h2>Incomplete Data After Import</h2>
<ul>
<li><strong>Issue</strong>: Some vulnerability records missing key fields</li>
<li><strong>Cause</strong>: CSV column mapping mismatch or unsupported format</li>
<li><strong>Solution</strong>: Verify CSV format matches supported column structures</li>
<li><strong>Debugging</strong>: Check server logs for field mapping warnings</li>
</ul>
<h2>CSV Import Returns 404 Error (Fixed in v1.0.5)</h2>
<ul>
<li><strong>Issue</strong>: CSV file upload fails with 404 &quot;Cannot POST /undefined/import&quot; error</li>
<li><strong>Root Cause</strong>: Missing <code>apiBase</code> property in ModernVulnManager class causing undefined API endpoint URLs</li>
<li><strong>Symptoms</strong>: Import button clicks result in 404 errors, CSV files not processed</li>
<li><strong>Resolution</strong>: Fixed in version 1.0.5 by adding <code>this.apiBase = &quot;/api&quot;</code> property to ModernVulnManager constructor</li>
<li><strong>Verification</strong>: Import functionality now properly routes to <code>/api/vulnerabilities/import</code> endpoint</li>
<li><strong>Impact</strong>: Resolves complete CSV import functionality breakdown that prevented all vulnerability data uploads</li>
</ul>
<h4>Supported Column Mapping Reference</h4>
<table>
<thead>
<tr>
<th>Source Column</th>
<th>Internal Mapping</th>
<th>Purpose</th>
<th>Required</th>
</tr>
</thead>
<tbody><tr>
<td><code>asset.display_ipv4_address</code></td>
<td><code>ip_address</code></td>
<td>Primary device IP</td>
<td>Yes</td>
</tr>
<tr>
<td><code>asset.ipv4_addresses</code></td>
<td><code>ip_address</code></td>
<td>Multi-IP support (first used)</td>
<td>Alternative</td>
</tr>
<tr>
<td><code>asset.name</code></td>
<td><code>hostname</code></td>
<td>Device hostname</td>
<td>Yes</td>
</tr>
<tr>
<td><code>asset.id</code></td>
<td><code>asset_id</code></td>
<td>Unique asset identifier</td>
<td>Recommended</td>
</tr>
<tr>
<td><code>definition.cve</code></td>
<td><code>cve</code></td>
<td>Direct CVE mapping</td>
<td>Preferred</td>
</tr>
<tr>
<td><code>definition.name</code></td>
<td><code>plugin_name</code></td>
<td>Vulnerability name/CVE source</td>
<td>Yes</td>
</tr>
<tr>
<td><code>definition.id</code></td>
<td><code>plugin_id</code></td>
<td>Plugin identifier</td>
<td>Yes</td>
</tr>
<tr>
<td><code>definition.family</code></td>
<td><code>vendor</code></td>
<td>Vulnerability vendor/family</td>
<td>Yes</td>
</tr>
<tr>
<td><code>definition.vpr.score</code></td>
<td><code>vpr_score</code></td>
<td>Risk priority score</td>
<td>Recommended</td>
</tr>
<tr>
<td><code>definition.description</code></td>
<td><code>description</code></td>
<td>Detailed vulnerability info</td>
<td>Optional</td>
</tr>
<tr>
<td><code>severity</code></td>
<td><code>severity</code></td>
<td>Risk severity level</td>
<td>Yes</td>
</tr>
<tr>
<td><code>state</code></td>
<td><code>state</code></td>
<td>Current vulnerability state</td>
<td>Yes</td>
</tr>
</tbody></table>
<h4>Performance Optimization</h4>
<p><strong>Large File Handling</strong>:</p>
<ul>
<li>Files under 10MB: Client-side parsing with Papa.parse</li>
<li>Files over 10MB: Automatic server-side processing</li>
<li>Memory management: Streaming processing prevents memory exhaustion</li>
<li>Progress tracking: Real-time import progress for large datasets</li>
</ul>
<p><strong>Database Optimization</strong>:</p>
<ul>
<li>Sequential processing prevents race conditions during import</li>
<li>Batch insertion for improved performance</li>
<li>Automatic cleanup of temporary files after processing</li>
<li>Database transaction handling ensures data integrity</li>
</ul>
<h2>The Dashboard</h2>
<p>The dashboard provides multiple ways to analyze your vulnerability data.</p>
<h3>Statistics Cards</h3>
<p>At the top of the page, you&#39;ll find cards summarizing the current vulnerability state by severity. You can <strong>click on any card</strong> to flip it and view the data in two ways:</p>
<ul>
<li><strong>Vulnerability Counts</strong>: The total number of vulnerabilities for that severity.</li>
<li><strong>VPR Totals</strong>: The sum of the Vulnerability Priority Rating (VPR) scores for that severity, giving you a risk-based perspective.</li>
</ul>
<h3>Historical Trend Chart</h3>
<p>The main chart visualizes vulnerability trends over time. You can toggle the view to see trends based on:</p>
<ul>
<li><strong>Vulnerability Count</strong></li>
<li><strong>VPR Score Sum</strong></li>
</ul>
<p>This allows you to see whether your overall risk is increasing or decreasing.</p>
<h2>Data Views</h2>
<p>You can switch between three different views to analyze the data from different perspectives:</p>
<h3>1. Table View</h3>
<p>This is the default view, powered by AG Grid. It provides a detailed, sortable, and filterable table of all current vulnerabilities.</p>
<ul>
<li><strong>Sorting</strong>: Click on any column header to sort the data.</li>
<li><strong>Filtering</strong>: Use the search bar and the severity dropdown to filter the data.</li>
<li><strong>Column Resizing</strong>: Drag column borders to resize columns to your preferred width.</li>
<li><strong>Advanced Features</strong>: The table includes grouping, column pinning, and export capabilities for comprehensive data analysis.</li>
</ul>
<h3>2. Devices View</h3>
<p>This view groups all vulnerabilities by the affected device (hostname). Each card represents a device and shows:</p>
<ul>
<li>The total number of vulnerabilities on that device.</li>
<li>The total VPR score for that device.</li>
<li>A breakdown of vulnerabilities by severity.</li>
</ul>
<p>Click <strong>View Device Details</strong> to see a list of all vulnerabilities affecting that specific device. The device modal provides detailed information about the selected device and displays an interactive grid of its vulnerabilities.</p>
<p><strong>Enhanced Modal Aggregation (v1.0.6+)</strong>: The device modal now properly aggregates and displays ALL vulnerabilities affecting the selected device. For example, a device like <code>grimesnswan03</code> will show all 12 vulnerabilities associated with it, providing complete visibility into the device&#39;s vulnerability profile.</p>
<p><strong>Enhanced Navigation</strong>: You can click on hostname links within vulnerability modals to seamlessly navigate to device details. The modal system now properly transitions between views, ensuring a smooth user experience without layering issues.</p>
<h3>3. Vulnerabilities View</h3>
<p>This view groups all findings by vulnerability identifier (CVE, Cisco SA, or plugin ID). Each card represents a unique vulnerability and shows:</p>
<ul>
<li>The number of devices affected by it.</li>
<li>The total VPR score it contributes across all devices.</li>
<li>A breakdown of the severity of the findings.</li>
<li><strong>Enhanced Display</strong>: Vulnerability identifiers are now shown in a dedicated &quot;Vulnerability&quot; column with appropriate linking:<ul>
<li><strong>CVE identifiers</strong> link to the MITRE CVE database</li>
<li><strong>Cisco SA identifiers</strong> link to Cisco&#39;s security advisory portal</li>
<li><strong>Plugin IDs</strong> are styled for easy identification when CVE/SA data is unavailable</li>
</ul>
</li>
</ul>
<p>Click on a card to see a list of all devices affected by that vulnerability.</p>
<p><strong>Enhanced Modal Aggregation (v1.0.6+)</strong>: The vulnerability modal now properly aggregates and displays ALL devices affected by the selected vulnerability. For example, CVE-2017-3881 will show all 24 affected devices in a comprehensive list, providing complete visibility into the vulnerability&#39;s impact across your infrastructure.</p>
<h2>Card Pagination</h2>
<p>Both the Devices View and Vulnerabilities View now include intelligent pagination controls:</p>
<ul>
<li><strong>Default Display</strong>: Shows 6 cards per page for optimal viewing and performance</li>
<li><strong>Navigation Controls</strong>: Use the pagination controls at the bottom to navigate through pages</li>
<li><strong>Responsive Design</strong>: Cards automatically adjust to screen size while maintaining readability</li>
<li><strong>Quick Navigation</strong>: Jump to first, last, or specific page numbers for efficient browsing</li>
</ul>
<p>This pagination system ensures smooth performance even with large datasets while maintaining the visual appeal of the card-based interface.</p>
<h2>Vulnerability Lookup</h2>
<p>From the Table or Vulnerability views, you can click on vulnerability identifiers to access authoritative information:</p>
<ul>
<li><strong>CVE identifiers</strong> (e.g., <code>CVE-2023-12345</code>) link to the <a href="https://cve.mitre.org/">MITRE CVE website</a></li>
<li><strong>Cisco SA identifiers</strong> (e.g., <code>cisco-sa-bootstrap-KfgxYgdh</code>) link to <a href="https://cisco.com/c/en/us/support/docs/csa/">Cisco's Security Advisory portal</a></li>
<li><strong>Plugin IDs</strong> display with distinctive styling for easy identification</li>
</ul>
<p>This provides direct access to detailed vulnerability information from authoritative sources.</p>
<h2>Integration with Other Systems</h2>
<p>The vulnerability management system integrates seamlessly with other HexTrackr components:</p>
<ul>
<li><strong>Ticket System</strong>: Create tickets directly from vulnerability data</li>
<li><strong>ServiceNow Integration</strong>: Automated ticket creation for critical vulnerabilities</li>
<li><strong>Backup System</strong>: All vulnerability data included in system-wide backups</li>
<li><strong>API Access</strong>: RESTful API endpoints for programmatic access to vulnerability data</li>
</ul>

    <!-- Note: This file is intentionally minimal. The full page scaffold, header, footer, and scripts
             are provided by docs-html/index.html. Content generated using this template will be
             fetched and injected into #content-container by docs-html/js/docs-portal-v2.js. -->
</section>
