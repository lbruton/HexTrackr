<!-- Fragment template for documentation content injected by docs-tabler.js -->
<section class="doc-fragment">
    <h1>Security Overview</h1><!-- markdownlint-disable-next-line MD013 -->
<p>HexTrackr is designed with security in mind. This document provides an overview of the security measures in place. For a detailed breakdown of the security implementation, see the <a href="#reference/security-implementation">Security Implementation</a> documentation.</p>
<h2>Data Security</h2><ul>
<li><strong>Database</strong>: The SQLite database is stored locally on the server. Access is restricted to the backend application.</li>
<li><strong>File Uploads</strong>: Uploaded CSV files are stored temporarily and processed securely. They are deleted after processing.</li>
<li><strong>Input Validation</strong>: All user input is validated on the backend to prevent common vulnerabilities such as Cross-Site Scripting (XSS) and SQL Injection.</li>
</ul>
<h2>Secure Development</h2><ul>
<li><strong>Dependencies</strong>: We use <code>npm audit</code> to regularly check for vulnerabilities in our dependencies.</li>
<li><strong>Docker</strong>: The application is containerized using Docker, which provides process isolation and a controlled environment.</li>
<li><strong>Code Analysis</strong>: We use static analysis tools like ESLint and Codacy to identify potential security issues in the codebase.</li>
</ul>
<h1>Security Implementation</h1><p>Comprehensive documentation of all security measures, controls, and implementations in HexTrackr for corporate security review and compliance assessment.</p>
<hr>
<h2>Security Architecture Overview</h2><p>HexTrackr implements a defense-in-depth security strategy with multiple layers of protection:</p>
<ul>
<li><strong>Network Security</strong>: Rate limiting, CORS, security headers</li>
<li><strong>Input Validation</strong>: Comprehensive data sanitization and validation</li>
<li><strong>File Security</strong>: Upload restrictions and path traversal prevention</li>
<li><strong>Data Protection</strong>: SQL injection prevention and secure data handling</li>
<li><strong>Session Management</strong>: Secure session handling (prepared for authentication)</li>
<li><strong>Application Security</strong>: XSS protection and secure coding practices</li>
</ul>
<hr>
<h2>Input Validation and Sanitization</h2><h3>PathValidator Security Class</h3><p><strong>Location</strong>: <code>app/public/server.js</code> (lines 22-79)</p>
<p>The <code>PathValidator</code> class provides comprehensive protection against path traversal attacks and ensures safe file operations.</p>
<p><strong>Core Security Features</strong>:</p>
<pre><code class="language-javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">PathValidator</span> {
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">validatePath</span>(<span class="hljs-params">filePath</span>) {
    <span class="hljs-comment">// 1. Basic validation</span>
    <span class="hljs-keyword">if</span> (!filePath || <span class="hljs-keyword">typeof</span> filePath !== <span class="hljs-string">&quot;string&quot;</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;Invalid file path&quot;</span>);
    }

    <span class="hljs-comment">// 2. Path normalization</span>
    <span class="hljs-keyword">const</span> normalizedPath = path.<span class="hljs-title function_">normalize</span>(filePath);

    <span class="hljs-comment">// 3. Path traversal detection</span>
    <span class="hljs-keyword">if</span> (normalizedPath.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&quot;../&quot;</span>) || normalizedPath.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&quot;..\\&quot;</span>)) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;Path traversal detected&quot;</span>);
    }

    <span class="hljs-comment">// 4. Component validation</span>
    <span class="hljs-keyword">const</span> pathComponents = normalizedPath.<span class="hljs-title function_">split</span>(path.<span class="hljs-property">sep</span>);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> component <span class="hljs-keyword">of</span> pathComponents) {
      <span class="hljs-keyword">if</span> (component === <span class="hljs-string">&quot;..&quot;</span> || (component === <span class="hljs-string">&quot;.&quot;</span> &amp;&amp; pathComponents.<span class="hljs-property">length</span> &gt; <span class="hljs-number">1</span>)) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;Invalid path component&quot;</span>);
      }
    }

    <span class="hljs-keyword">return</span> normalizedPath;
  }
}</code></pre><p><strong>Protected Operations</strong>:</p>
<ul>
<li><code>safeReadFileSync()</code>: Safe file reading with path validation</li>
<li><code>safeWriteFileSync()</code>: Secure file writing operations</li>
<li><code>safeReaddirSync()</code>: Directory listing with validation</li>
<li><code>safeStatSync()</code>: File status checking</li>
<li><code>safeExistsSync()</code>: File existence checking with error handling</li>
<li><code>safeUnlinkSync()</code>: Secure file deletion</li>
</ul>
<p><strong>Security Benefits</strong>:</p>
<ul>
<li>Prevents directory traversal attacks (../, ..\)</li>
<li>Validates all path components</li>
<li>Handles edge cases and malformed paths</li>
<li>Consistent error handling across all file operations</li>
<li>Performance optimized for frequent validation</li>
</ul>
<h3>SQL Injection Prevention</h3><p><strong>Implementation</strong>: Parameterized queries throughout the application</p>
<p><strong>Example Secure Query Pattern</strong>:</p>
<pre><code class="language-javascript"><span class="hljs-comment">// Secure parameterized query</span>
<span class="hljs-keyword">const</span> stmt = db.<span class="hljs-title function_">prepare</span>(<span class="hljs-string">`
  SELECT * FROM vulnerabilities
  WHERE hostname = ? AND severity = ? AND scan_date &gt; ?
`</span>);
<span class="hljs-keyword">const</span> results = stmt.<span class="hljs-title function_">all</span>(hostname, severity, dateThreshold);</code></pre><p><strong>Protection Mechanisms</strong>:</p>
<ul>
<li>All database queries use parameterized statements</li>
<li>No dynamic SQL construction with user input</li>
<li>Input validation before database operations</li>
<li>Type checking for numeric parameters</li>
<li>Length limits on string parameters</li>
</ul>
<p><strong>Vulnerable Operations Secured</strong>:</p>
<ul>
<li>Vulnerability search and filtering</li>
<li>Ticket CRUD operations</li>
<li>Data import processing</li>
<li>Statistics and reporting queries</li>
<li>Backup and restore operations</li>
</ul>
<h3>XSS Protection</h3><p><strong>Primary Defense</strong>: DOMPurify library integration</p>
<p><strong>Implementation</strong>:</p>
<pre><code class="language-javascript"><span class="hljs-comment">// Client-side XSS protection</span>
<span class="hljs-keyword">import</span> <span class="hljs-title class_">DOMPurify</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;dompurify&#x27;</span>;

<span class="hljs-comment">// Sanitize all user-generated content</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">sanitizeHTML</span>(<span class="hljs-params">dirty</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title class_">DOMPurify</span>.<span class="hljs-title function_">sanitize</span>(dirty, {
    <span class="hljs-attr">ALLOWED_TAGS</span>: [<span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;i&#x27;</span>, <span class="hljs-string">&#x27;em&#x27;</span>, <span class="hljs-string">&#x27;strong&#x27;</span>, <span class="hljs-string">&#x27;p&#x27;</span>, <span class="hljs-string">&#x27;br&#x27;</span>],
    <span class="hljs-attr">ALLOWED_ATTR</span>: [<span class="hljs-string">&#x27;class&#x27;</span>],
    <span class="hljs-attr">FORBID_TAGS</span>: [<span class="hljs-string">&#x27;script&#x27;</span>, <span class="hljs-string">&#x27;object&#x27;</span>, <span class="hljs-string">&#x27;embed&#x27;</span>, <span class="hljs-string">&#x27;link&#x27;</span>],
    <span class="hljs-attr">FORBID_ATTR</span>: [<span class="hljs-string">&#x27;onerror&#x27;</span>, <span class="hljs-string">&#x27;onload&#x27;</span>, <span class="hljs-string">&#x27;onclick&#x27;</span>]
  });
}</code></pre><p><strong>Additional XSS Protections</strong>:</p>
<ul>
<li>Content Security Policy (CSP) headers</li>
<li>X-XSS-Protection header enabled</li>
<li>Input validation and encoding</li>
<li>Template escaping in HTML generation</li>
<li>Sanitization of user-provided data before storage</li>
</ul>
<hr>
<h2>Network Security</h2><h3>Rate Limiting</h3><p><strong>Implementation</strong>: Express Rate Limit middleware</p>
<p><strong>Configuration</strong>:</p>
<pre><code class="language-javascript"><span class="hljs-keyword">const</span> rateLimit = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;express-rate-limit&quot;</span>);

<span class="hljs-keyword">const</span> limiter = <span class="hljs-title function_">rateLimit</span>({
  <span class="hljs-attr">windowMs</span>: <span class="hljs-number">15</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>, <span class="hljs-comment">// 15 minutes</span>
  <span class="hljs-attr">max</span>: <span class="hljs-number">100</span>, <span class="hljs-comment">// Limit each IP to 100 requests per windowMs</span>
  <span class="hljs-attr">message</span>: {
    <span class="hljs-attr">error</span>: <span class="hljs-string">&quot;Too many requests from this IP, please try again later.&quot;</span>,
    <span class="hljs-attr">retryAfter</span>: <span class="hljs-string">&quot;15 minutes&quot;</span>
  },
  <span class="hljs-attr">standardHeaders</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// Return rate limit info in headers</span>
  <span class="hljs-attr">legacyHeaders</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">handler</span>: <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
    res.<span class="hljs-title function_">status</span>(<span class="hljs-number">429</span>).<span class="hljs-title function_">json</span>({
      <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">error</span>: {
        <span class="hljs-attr">code</span>: <span class="hljs-string">&quot;RATE_LIMIT_EXCEEDED&quot;</span>,
        <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;Rate limit exceeded. Try again later.&quot;</span>
      }
    });
  }
});

<span class="hljs-comment">// Apply to all API routes</span>
app.<span class="hljs-title function_">use</span>(<span class="hljs-string">&quot;/api/&quot;</span>, limiter);</code></pre><p><strong>Rate Limiting Strategy</strong>:</p>
<ul>
<li><strong>Window</strong>: 15-minute sliding window</li>
<li><strong>Limit</strong>: 100 requests per IP per window</li>
<li><strong>Scope</strong>: Applied to all <code>/api/</code> endpoints</li>
<li><strong>Headers</strong>: Provides rate limit information to clients</li>
<li><strong>Bypass</strong>: No bypass mechanism (prevents abuse)</li>
<li><strong>Storage</strong>: In-memory storage (resets on restart)</li>
</ul>
<h3>CORS Configuration</h3><p><strong>Implementation</strong>: Configurable Cross-Origin Resource Sharing</p>
<p><strong>Default Configuration</strong>:</p>
<pre><code class="language-javascript"><span class="hljs-keyword">const</span> cors = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;cors&quot;</span>);

<span class="hljs-keyword">const</span> corsOptions = {
  <span class="hljs-attr">origin</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">CORS_ORIGIN</span> || <span class="hljs-string">&quot;*&quot;</span>,
  <span class="hljs-attr">methods</span>: [<span class="hljs-string">&quot;GET&quot;</span>, <span class="hljs-string">&quot;POST&quot;</span>, <span class="hljs-string">&quot;PUT&quot;</span>, <span class="hljs-string">&quot;DELETE&quot;</span>, <span class="hljs-string">&quot;OPTIONS&quot;</span>],
  <span class="hljs-attr">allowedHeaders</span>: [
    <span class="hljs-string">&quot;Content-Type&quot;</span>,
    <span class="hljs-string">&quot;Authorization&quot;</span>,
    <span class="hljs-string">&quot;X-Requested-With&quot;</span>,
    <span class="hljs-string">&quot;Accept&quot;</span>,
    <span class="hljs-string">&quot;Origin&quot;</span>
  ],
  <span class="hljs-attr">credentials</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// No credentials by default</span>
  <span class="hljs-attr">maxAge</span>: <span class="hljs-number">86400</span> <span class="hljs-comment">// 24 hours preflight cache</span>
};

app.<span class="hljs-title function_">use</span>(<span class="hljs-title function_">cors</span>(corsOptions));</code></pre><p><strong>Production Recommendations</strong>:</p>
<pre><code class="language-javascript"><span class="hljs-comment">// Production CORS settings</span>
<span class="hljs-keyword">const</span> productionCors = {
  <span class="hljs-attr">origin</span>: <span class="hljs-string">&quot;https://hextrackr.yourdomain.com&quot;</span>,
  <span class="hljs-attr">credentials</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">methods</span>: [<span class="hljs-string">&quot;GET&quot;</span>, <span class="hljs-string">&quot;POST&quot;</span>, <span class="hljs-string">&quot;PUT&quot;</span>, <span class="hljs-string">&quot;DELETE&quot;</span>],
  <span class="hljs-attr">allowedHeaders</span>: [<span class="hljs-string">&quot;Content-Type&quot;</span>, <span class="hljs-string">&quot;X-Requested-With&quot;</span>]
};</code></pre><h3>Security Headers</h3><p><strong>Implementation</strong>: Custom security header middleware</p>
<pre><code class="language-javascript"><span class="hljs-comment">// Security headers middleware</span>
app.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">req, res, next</span>) =&gt;</span> {
  <span class="hljs-comment">// HTTP Strict Transport Security</span>
  res.<span class="hljs-title function_">setHeader</span>(
    <span class="hljs-string">&quot;Strict-Transport-Security&quot;</span>,
    <span class="hljs-string">&quot;max-age=31536000; includeSubDomains&quot;</span>
  );

  <span class="hljs-comment">// Prevent MIME type sniffing</span>
  res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&quot;X-Content-Type-Options&quot;</span>, <span class="hljs-string">&quot;nosniff&quot;</span>);

  <span class="hljs-comment">// Clickjacking protection</span>
  res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&quot;X-Frame-Options&quot;</span>, <span class="hljs-string">&quot;DENY&quot;</span>);

  <span class="hljs-comment">// XSS protection</span>
  res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&quot;X-XSS-Protection&quot;</span>, <span class="hljs-string">&quot;1; mode=block&quot;</span>);

  <span class="hljs-comment">// Referrer policy</span>
  res.<span class="hljs-title function_">setHeader</span>(
    <span class="hljs-string">&quot;Referrer-Policy&quot;</span>,
    <span class="hljs-string">&quot;strict-origin-when-cross-origin&quot;</span>
  );

  <span class="hljs-comment">// Content Security Policy (development - adjust for production)</span>
  res.<span class="hljs-title function_">setHeader</span>(
    <span class="hljs-string">&quot;Content-Security-Policy&quot;</span>,
    <span class="hljs-string">&quot;default-src &#x27;self&#x27;; script-src &#x27;self&#x27; &#x27;unsafe-inline&#x27; &#x27;unsafe-eval&#x27;; style-src &#x27;self&#x27; &#x27;unsafe-inline&#x27;; img-src &#x27;self&#x27; data: https:; font-src &#x27;self&#x27; https:;&quot;</span>
  );

  <span class="hljs-title function_">next</span>();
});</code></pre><hr>
<h2>File Upload Security</h2><h3>Upload Restrictions</h3><p><strong>Configuration</strong>:</p>
<pre><code class="language-javascript"><span class="hljs-keyword">const</span> multer = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;multer&quot;</span>);

<span class="hljs-keyword">const</span> storage = multer.<span class="hljs-title function_">diskStorage</span>({
  <span class="hljs-attr">destination</span>: <span class="hljs-function">(<span class="hljs-params">req, file, cb</span>) =&gt;</span> {
    <span class="hljs-comment">// Validate upload directory exists and is writable</span>
    <span class="hljs-keyword">const</span> uploadDir = process.<span class="hljs-property">env</span>.<span class="hljs-property">UPLOAD_DIR</span> || <span class="hljs-string">&quot;./app/public/uploads&quot;</span>;
    <span class="hljs-title function_">cb</span>(<span class="hljs-literal">null</span>, uploadDir);
  },
  <span class="hljs-attr">filename</span>: <span class="hljs-function">(<span class="hljs-params">req, file, cb</span>) =&gt;</span> {
    <span class="hljs-comment">// Generate secure filename with timestamp</span>
    <span class="hljs-keyword">const</span> timestamp = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
    <span class="hljs-keyword">const</span> sanitizedName = file.<span class="hljs-property">originalname</span>.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/[^a-zA-Z0-9.-]/g</span>, <span class="hljs-string">&#x27;_&#x27;</span>);
    <span class="hljs-title function_">cb</span>(<span class="hljs-literal">null</span>, <span class="hljs-string">`<span class="hljs-subst">${timestamp}</span>-<span class="hljs-subst">${sanitizedName}</span>`</span>);
  }
});

<span class="hljs-keyword">const</span> <span class="hljs-title function_">fileFilter</span> = (<span class="hljs-params">req, file, cb</span>) =&gt; {
  <span class="hljs-comment">// Allowed MIME types</span>
  <span class="hljs-keyword">const</span> allowedMimes = [
    <span class="hljs-string">&#x27;text/csv&#x27;</span>,
    <span class="hljs-string">&#x27;application/json&#x27;</span>,
    <span class="hljs-string">&#x27;application/vnd.ms-excel&#x27;</span>,
    <span class="hljs-string">&#x27;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&#x27;</span>
  ];

  <span class="hljs-comment">// Allowed file extensions</span>
  <span class="hljs-keyword">const</span> allowedExtensions = [<span class="hljs-string">&#x27;.csv&#x27;</span>, <span class="hljs-string">&#x27;.json&#x27;</span>, <span class="hljs-string">&#x27;.xls&#x27;</span>, <span class="hljs-string">&#x27;.xlsx&#x27;</span>];
  <span class="hljs-keyword">const</span> fileExtension = path.<span class="hljs-title function_">extname</span>(file.<span class="hljs-property">originalname</span>).<span class="hljs-title function_">toLowerCase</span>();

  <span class="hljs-keyword">if</span> (allowedMimes.<span class="hljs-title function_">includes</span>(file.<span class="hljs-property">mimetype</span>) &amp;&amp; allowedExtensions.<span class="hljs-title function_">includes</span>(fileExtension)) {
    <span class="hljs-title function_">cb</span>(<span class="hljs-literal">null</span>, <span class="hljs-literal">true</span>);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-title function_">cb</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">`File type not allowed. Allowed types: <span class="hljs-subst">${allowedExtensions.join(<span class="hljs-string">&#x27;, &#x27;</span>)}</span>`</span>), <span class="hljs-literal">false</span>);
  }
};

<span class="hljs-keyword">const</span> upload = <span class="hljs-title function_">multer</span>({
  <span class="hljs-attr">storage</span>: storage,
  <span class="hljs-attr">limits</span>: {
    <span class="hljs-attr">fileSize</span>: <span class="hljs-number">50</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>, <span class="hljs-comment">// 50MB limit</span>
    <span class="hljs-attr">files</span>: <span class="hljs-number">1</span>, <span class="hljs-comment">// Single file upload only</span>
    <span class="hljs-attr">fields</span>: <span class="hljs-number">5</span>, <span class="hljs-comment">// Limit form fields</span>
    <span class="hljs-attr">fieldSize</span>: <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>, <span class="hljs-comment">// 1MB per field</span>
    <span class="hljs-attr">headerPairs</span>: <span class="hljs-number">2000</span> <span class="hljs-comment">// Limit header pairs</span>
  },
  <span class="hljs-attr">fileFilter</span>: fileFilter
});</code></pre><p><strong>Security Controls</strong>:</p>
<ul>
<li><strong>File Size</strong>: 50MB maximum per file</li>
<li><strong>File Types</strong>: CSV, JSON, XLS, XLSX only</li>
<li><strong>MIME Type Validation</strong>: Double validation (MIME + extension)</li>
<li><strong>Filename Sanitization</strong>: Remove special characters</li>
<li><strong>Upload Directory</strong>: Isolated from executable directories</li>
<li><strong>Temporary Storage</strong>: Files moved after validation</li>
<li><strong>Cleanup</strong>: Automatic cleanup of old uploads</li>
</ul>
<h3>File Processing Security</h3><p><strong>CSV Processing with PapaParse</strong>:</p>
<pre><code class="language-javascript"><span class="hljs-keyword">const</span> <span class="hljs-title class_">Papa</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;papaparse&quot;</span>);

<span class="hljs-keyword">function</span> <span class="hljs-title function_">parseCSVSecurely</span>(<span class="hljs-params">fileContent, options = {}</span>) {
  <span class="hljs-keyword">const</span> secureConfig = {
    <span class="hljs-attr">header</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">skipEmptyLines</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">transformHeader</span>: <span class="hljs-function">(<span class="hljs-params">header</span>) =&gt;</span> {
      <span class="hljs-comment">// Sanitize column headers</span>
      <span class="hljs-keyword">return</span> header.<span class="hljs-title function_">trim</span>().<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/[^a-zA-Z0-9_-]/g</span>, <span class="hljs-string">&#x27;_&#x27;</span>);
    },
    <span class="hljs-attr">transform</span>: <span class="hljs-function">(<span class="hljs-params">value, field</span>) =&gt;</span> {
      <span class="hljs-comment">// Sanitize field values</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">&#x27;string&#x27;</span>) {
        <span class="hljs-keyword">return</span> value.<span class="hljs-title function_">trim</span>().<span class="hljs-title function_">substring</span>(<span class="hljs-number">0</span>, <span class="hljs-number">1000</span>); <span class="hljs-comment">// Limit field length</span>
      }
      <span class="hljs-keyword">return</span> value;
    },
    <span class="hljs-attr">error</span>: <span class="hljs-function">(<span class="hljs-params">error, file, inputElem, reason</span>) =&gt;</span> {
      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;CSV parsing error:&#x27;</span>, error, reason);
    },
    <span class="hljs-comment">// Security limits</span>
    <span class="hljs-attr">worker</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// Disable web workers</span>
    <span class="hljs-attr">download</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// No external downloads</span>
    <span class="hljs-attr">delimiter</span>: <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// Auto-detect delimiter</span>
    <span class="hljs-attr">chunkSize</span>: <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>, <span class="hljs-comment">// 1MB chunks</span>
    ...options
  };

  <span class="hljs-keyword">return</span> <span class="hljs-title class_">Papa</span>.<span class="hljs-title function_">parse</span>(fileContent, secureConfig);
}</code></pre><hr>
<h2>Session Management</h2><h3>Current State (Stateless)</h3><p>HexTrackr currently operates in a stateless mode without user authentication. However, the foundation is prepared for secure session management.</p>
<h3>Prepared Session Configuration</h3><pre><code class="language-javascript"><span class="hljs-keyword">const</span> session = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express-session&#x27;</span>);
<span class="hljs-keyword">const</span> <span class="hljs-title class_">SQLiteStore</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;connect-sqlite3&#x27;</span>)(session);

<span class="hljs-keyword">const</span> sessionConfig = {
  <span class="hljs-attr">secret</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">SESSION_SECRET</span> || <span class="hljs-string">&#x27;auto-generated-secret&#x27;</span>,
  <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;hextrackr.sid&#x27;</span>,
  <span class="hljs-attr">store</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">SQLiteStore</span>({
    <span class="hljs-attr">db</span>: <span class="hljs-string">&#x27;sessions.db&#x27;</span>,
    <span class="hljs-attr">dir</span>: <span class="hljs-string">&#x27;./data&#x27;</span>,
    <span class="hljs-attr">table</span>: <span class="hljs-string">&#x27;sessions&#x27;</span>
  }),
  <span class="hljs-attr">resave</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">saveUninitialized</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">cookie</span>: {
    <span class="hljs-attr">secure</span>: process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> === <span class="hljs-string">&#x27;production&#x27;</span>, <span class="hljs-comment">// HTTPS only in production</span>
    <span class="hljs-attr">httpOnly</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// Prevent XSS access to cookies</span>
    <span class="hljs-attr">maxAge</span>: <span class="hljs-number">24</span> * <span class="hljs-number">60</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>, <span class="hljs-comment">// 24 hours</span>
    <span class="hljs-attr">sameSite</span>: <span class="hljs-string">&#x27;strict&#x27;</span> <span class="hljs-comment">// CSRF protection</span>
  },
  <span class="hljs-attr">genid</span>: <span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;crypto&#x27;</span>).<span class="hljs-title function_">randomBytes</span>(<span class="hljs-number">32</span>).<span class="hljs-title function_">toString</span>(<span class="hljs-string">&#x27;hex&#x27;</span>);
  }
};</code></pre><h3>Future Authentication Framework</h3><p><strong>Planned Authentication Methods</strong>:</p>
<ol>
<li><strong>Local Authentication</strong>: Username/password with bcrypt hashing</li>
<li><strong>JWT Tokens</strong>: Stateless authentication for API access</li>
<li><strong>OAuth 2.0</strong>: Integration with enterprise identity providers</li>
<li><strong>API Keys</strong>: Service-to-service authentication</li>
</ol>
<p><strong>Password Security (When Implemented)</strong>:</p>
<ul>
<li>bcrypt with minimum 12 rounds</li>
<li>Password complexity requirements</li>
<li>Account lockout after failed attempts</li>
<li>Password history prevention</li>
<li>Secure password reset flow</li>
</ul>
<hr>
<h2>Data Protection</h2><h3>Database Security</h3><p><strong>SQLite Configuration</strong>:</p>
<pre><code class="language-javascript"><span class="hljs-keyword">const</span> sqlite3 = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;sqlite3&#x27;</span>).<span class="hljs-title function_">verbose</span>();

<span class="hljs-comment">// Secure database connection</span>
<span class="hljs-keyword">const</span> db = <span class="hljs-keyword">new</span> sqlite3.<span class="hljs-title class_">Database</span>(dbPath, sqlite3.<span class="hljs-property">OPEN_READWRITE</span> | sqlite3.<span class="hljs-property">OPEN_CREATE</span>, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (err) {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;Database connection error:&#x27;</span>, err);
    process.<span class="hljs-title function_">exit</span>(<span class="hljs-number">1</span>);
  }
});

<span class="hljs-comment">// Enable WAL mode for better concurrency and recovery</span>
db.<span class="hljs-title function_">exec</span>(<span class="hljs-string">&#x27;PRAGMA journal_mode=WAL&#x27;</span>);

<span class="hljs-comment">// Set secure pragma settings</span>
db.<span class="hljs-title function_">exec</span>(<span class="hljs-string">&#x27;PRAGMA foreign_keys=ON&#x27;</span>); <span class="hljs-comment">// Enforce foreign key constraints</span>
db.<span class="hljs-title function_">exec</span>(<span class="hljs-string">&#x27;PRAGMA secure_delete=ON&#x27;</span>); <span class="hljs-comment">// Securely delete data</span>
db.<span class="hljs-title function_">exec</span>(<span class="hljs-string">&#x27;PRAGMA temp_store=MEMORY&#x27;</span>); <span class="hljs-comment">// Store temporary data in memory</span></code></pre><p><strong>Sensitive Data Handling</strong>:</p>
<ul>
<li>No passwords or secrets stored in database</li>
<li>Input validation before database operations</li>
<li>Prepared statements for all queries</li>
<li>Database file permissions restricted (600)</li>
<li>Regular backup with integrity checks</li>
</ul>
<h3>Data Sanitization</h3><p><strong>Input Sanitization Functions</strong>:</p>
<pre><code class="language-javascript"><span class="hljs-comment">// Comprehensive input sanitization</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">sanitizeInput</span>(<span class="hljs-params">input, type = <span class="hljs-string">&#x27;string&#x27;</span></span>) {
  <span class="hljs-keyword">if</span> (input === <span class="hljs-literal">null</span> || input === <span class="hljs-literal">undefined</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }

  <span class="hljs-keyword">switch</span> (type) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;string&#x27;</span>:
      <span class="hljs-keyword">return</span> <span class="hljs-title class_">String</span>(input)
        .<span class="hljs-title function_">trim</span>()
        .<span class="hljs-title function_">substring</span>(<span class="hljs-number">0</span>, <span class="hljs-number">1000</span>) <span class="hljs-comment">// Limit length</span>
        .<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F]/g</span>, <span class="hljs-string">&#x27;&#x27;</span>); <span class="hljs-comment">// Remove control chars</span>

    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;number&#x27;</span>:
      <span class="hljs-keyword">const</span> num = <span class="hljs-built_in">parseFloat</span>(input);
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">isNaN</span>(num) ? <span class="hljs-number">0</span> : <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">max</span>(-<span class="hljs-number">999999</span>, <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">min</span>(<span class="hljs-number">999999</span>, num));

    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;boolean&#x27;</span>:
      <span class="hljs-keyword">return</span> <span class="hljs-title class_">Boolean</span>(input);

    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;date&#x27;</span>:
      <span class="hljs-keyword">const</span> date = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(input);
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">isNaN</span>(date.<span class="hljs-title function_">getTime</span>()) ? <span class="hljs-literal">null</span> : date.<span class="hljs-title function_">toISOString</span>();

    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;cve&#x27;</span>:
      <span class="hljs-comment">// CVE format validation</span>
      <span class="hljs-keyword">const</span> cveRegex = <span class="hljs-regexp">/^CVE-\d{4}-\d{4,}$/</span>;
      <span class="hljs-keyword">return</span> cveRegex.<span class="hljs-title function_">test</span>(input) ? input : <span class="hljs-literal">null</span>;

    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;severity&#x27;</span>:
      <span class="hljs-keyword">const</span> validSeverities = [<span class="hljs-string">&#x27;Low&#x27;</span>, <span class="hljs-string">&#x27;Medium&#x27;</span>, <span class="hljs-string">&#x27;High&#x27;</span>, <span class="hljs-string">&#x27;Critical&#x27;</span>];
      <span class="hljs-keyword">return</span> validSeverities.<span class="hljs-title function_">includes</span>(input) ? input : <span class="hljs-string">&#x27;Medium&#x27;</span>;

    <span class="hljs-attr">default</span>:
      <span class="hljs-keyword">return</span> <span class="hljs-title function_">sanitizeInput</span>(input, <span class="hljs-string">&#x27;string&#x27;</span>);
  }
}</code></pre><hr>
<h2>Application Security Features</h2><h3>Progress Tracking Security</h3><p><strong>WebSocket Session Management</strong>:</p>
<pre><code class="language-javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ProgressTracker</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">io</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">io</span> = io;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">sessions</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">THROTTLE_INTERVAL</span> = <span class="hljs-number">100</span>; <span class="hljs-comment">// Prevent spam</span>
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">SESSION_CLEANUP_INTERVAL</span> = <span class="hljs-number">30</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>; <span class="hljs-comment">// 30 minutes</span>
  }

  <span class="hljs-title function_">createSession</span>(<span class="hljs-params">metadata = {}</span>) {
    <span class="hljs-keyword">const</span> sessionId = crypto.<span class="hljs-title function_">randomUUID</span>();
    <span class="hljs-keyword">const</span> session = {
      <span class="hljs-attr">id</span>: sessionId,
      <span class="hljs-attr">progress</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">lastUpdate</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>(),
      <span class="hljs-attr">metadata</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">sanitizeMetadata</span>(metadata),
      <span class="hljs-attr">ipAddress</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getClientIP</span>(), <span class="hljs-comment">// Track origin</span>
      <span class="hljs-attr">createdAt</span>: <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>()
    };

    <span class="hljs-variable language_">this</span>.<span class="hljs-property">sessions</span>.<span class="hljs-title function_">set</span>(sessionId, session);
    <span class="hljs-keyword">return</span> sessionId;
  }

  <span class="hljs-title function_">sanitizeMetadata</span>(<span class="hljs-params">metadata</span>) {
    <span class="hljs-comment">// Sanitize all metadata fields</span>
    <span class="hljs-keyword">const</span> sanitized = {};
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [key, value] <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(metadata)) {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> key === <span class="hljs-string">&#x27;string&#x27;</span> &amp;&amp; key.<span class="hljs-property">length</span> &lt;= <span class="hljs-number">50</span>) {
        sanitized[key] = <span class="hljs-title function_">sanitizeInput</span>(value, <span class="hljs-string">&#x27;string&#x27;</span>);
      }
    }
    <span class="hljs-keyword">return</span> sanitized;
  }
}</code></pre><h3>Error Handling Security</h3><p><strong>Secure Error Responses</strong>:</p>
<pre><code class="language-javascript"><span class="hljs-comment">// Error handler that doesn&#x27;t leak sensitive information</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">secureErrorHandler</span>(<span class="hljs-params">err, req, res, next</span>) {
  <span class="hljs-comment">// Log full error internally</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">&#x27;Application Error:&#x27;</span>, {
    <span class="hljs-attr">error</span>: err.<span class="hljs-property">message</span>,
    <span class="hljs-attr">stack</span>: err.<span class="hljs-property">stack</span>,
    <span class="hljs-attr">url</span>: req.<span class="hljs-property">url</span>,
    <span class="hljs-attr">method</span>: req.<span class="hljs-property">method</span>,
    <span class="hljs-attr">ip</span>: req.<span class="hljs-property">ip</span>,
    <span class="hljs-attr">userAgent</span>: req.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;User-Agent&#x27;</span>),
    <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toISOString</span>()
  });

  <span class="hljs-comment">// Generic error response for clients</span>
  <span class="hljs-keyword">const</span> isDevelopment = process.<span class="hljs-property">env</span>.<span class="hljs-property">NODE_ENV</span> === <span class="hljs-string">&#x27;development&#x27;</span>;

  res.<span class="hljs-title function_">status</span>(err.<span class="hljs-property">status</span> || <span class="hljs-number">500</span>).<span class="hljs-title function_">json</span>({
    <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">error</span>: {
      <span class="hljs-attr">code</span>: err.<span class="hljs-property">code</span> || <span class="hljs-string">&#x27;INTERNAL_ERROR&#x27;</span>,
      <span class="hljs-attr">message</span>: isDevelopment ? err.<span class="hljs-property">message</span> : <span class="hljs-string">&#x27;An error occurred&#x27;</span>,
      ...(isDevelopment &amp;&amp; { <span class="hljs-attr">stack</span>: err.<span class="hljs-property">stack</span> }),
      <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toISOString</span>(),
      <span class="hljs-attr">requestId</span>: req.<span class="hljs-property">id</span> || <span class="hljs-string">&#x27;unknown&#x27;</span>
    }
  });
}</code></pre><hr>
<h2>Security Monitoring and Logging</h2><h3>Security Event Logging</h3><p><strong>Audit Log Implementation</strong>:</p>
<pre><code class="language-javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">SecurityAuditLogger</span> {
  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">logFile = <span class="hljs-string">&#x27;./logs/security.log&#x27;</span></span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">logFile</span> = logFile;
    <span class="hljs-variable language_">this</span>.<span class="hljs-property">logLevel</span> = process.<span class="hljs-property">env</span>.<span class="hljs-property">AUDIT_LOG_LEVEL</span> || <span class="hljs-string">&#x27;info&#x27;</span>;
  }

  <span class="hljs-title function_">log</span>(<span class="hljs-params">level, event, details = {}</span>) {
    <span class="hljs-keyword">const</span> logEntry = {
      <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>().<span class="hljs-title function_">toISOString</span>(),
      <span class="hljs-attr">level</span>: level,
      <span class="hljs-attr">event</span>: event,
      <span class="hljs-attr">details</span>: details,
      <span class="hljs-attr">ip</span>: details.<span class="hljs-property">ip</span> || <span class="hljs-string">&#x27;unknown&#x27;</span>,
      <span class="hljs-attr">userAgent</span>: details.<span class="hljs-property">userAgent</span> || <span class="hljs-string">&#x27;unknown&#x27;</span>
    };

    <span class="hljs-comment">// Log to file and/or external service</span>
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`SECURITY: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(logEntry)}</span>`</span>);

    <span class="hljs-comment">// Critical events should trigger alerts</span>
    <span class="hljs-keyword">if</span> (level === <span class="hljs-string">&#x27;critical&#x27;</span>) {
      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">triggerAlert</span>(logEntry);
    }
  }

  <span class="hljs-title function_">logFileUpload</span>(<span class="hljs-params">req, file, success</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;info&#x27;</span>, <span class="hljs-string">&#x27;FILE_UPLOAD&#x27;</span>, {
      <span class="hljs-attr">filename</span>: file.<span class="hljs-property">originalname</span>,
      <span class="hljs-attr">size</span>: file.<span class="hljs-property">size</span>,
      <span class="hljs-attr">mimetype</span>: file.<span class="hljs-property">mimetype</span>,
      <span class="hljs-attr">success</span>: success,
      <span class="hljs-attr">ip</span>: req.<span class="hljs-property">ip</span>,
      <span class="hljs-attr">userAgent</span>: req.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;User-Agent&#x27;</span>)
    });
  }

  <span class="hljs-title function_">logRateLimitExceeded</span>(<span class="hljs-params">req</span>) {
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;warning&#x27;</span>, <span class="hljs-string">&#x27;RATE_LIMIT_EXCEEDED&#x27;</span>, {
      <span class="hljs-attr">ip</span>: req.<span class="hljs-property">ip</span>,
      <span class="hljs-attr">url</span>: req.<span class="hljs-property">url</span>,
      <span class="hljs-attr">method</span>: req.<span class="hljs-property">method</span>,
      <span class="hljs-attr">userAgent</span>: req.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;User-Agent&#x27;</span>)
    });
  }
}</code></pre><h3>Intrusion Detection Patterns</h3><p><strong>Suspicious Activity Detection</strong>:</p>
<ul>
<li>Multiple file upload failures from same IP</li>
<li>Rapid API requests beyond normal usage</li>
<li>Path traversal attempts in file operations</li>
<li>Malformed requests or invalid parameters</li>
<li>Large file uploads outside business hours</li>
<li>WebSocket connection abuse patterns</li>
</ul>
<hr>
<h2>Compliance and Standards</h2><h3>Security Standards Alignment</h3><p><strong>OWASP Top 10 Compliance</strong>:</p>
<ol>
<li><strong>A01 Broken Access Control</strong>: Prepared authentication framework</li>
<li><strong>A02 Cryptographic Failures</strong>: Secure defaults, HTTPS enforcement</li>
<li><strong>A03 Injection</strong>: Parameterized queries, input validation</li>
<li><strong>A04 Insecure Design</strong>: Security-first architecture</li>
<li><strong>A05 Security Misconfiguration</strong>: Secure defaults, hardening guide</li>
<li><strong>A06 Vulnerable Components</strong>: Dependency scanning, regular updates</li>
<li><strong>A07 Identification Failures</strong>: Prepared session management</li>
<li><strong>A08 Software Integrity</strong>: Secure deployment, verification</li>
<li><strong>A09 Security Logging</strong>: Comprehensive audit logging</li>
<li><strong>A10 Server-Side Request Forgery</strong>: Input validation, URL restrictions</li>
</ol>
<h3>Data Privacy Compliance</h3><p><strong>GDPR Readiness</strong>:</p>
<ul>
<li>Data minimization principles applied</li>
<li>Right to data portability (export features)</li>
<li>Right to erasure (delete functionality)</li>
<li>Data processing transparency</li>
<li>Security by design implementation</li>
</ul>
<p><strong>CCPA Compliance</strong>:</p>
<ul>
<li>Consumer rights framework ready</li>
<li>Data collection transparency</li>
<li>Secure data handling practices</li>
</ul>
<hr>
<h2>Security Testing and Validation</h2><h3>Automated Security Testing</h3><p><strong>Security Test Suite</strong>:</p>
<pre><code class="language-bash"><span class="hljs-comment"># Run security tests</span>
npm run security:<span class="hljs-built_in">test</span>

<span class="hljs-comment"># Includes:</span>
<span class="hljs-comment"># - SQL injection testing</span>
<span class="hljs-comment"># - XSS payload testing</span>
<span class="hljs-comment"># - Path traversal testing</span>
<span class="hljs-comment"># - File upload security testing</span>
<span class="hljs-comment"># - Rate limiting validation</span>
<span class="hljs-comment"># - CORS configuration testing</span></code></pre><h3>Penetration Testing Checklist</h3><p><strong>Network Security</strong>:</p>
<ul>
<li><input disabled="" type="checkbox"> Port scanning and service enumeration</li>
<li><input disabled="" type="checkbox"> Rate limiting bypass attempts</li>
<li><input disabled="" type="checkbox"> CORS misconfiguration testing</li>
<li><input disabled="" type="checkbox"> SSL/TLS configuration validation</li>
</ul>
<p><strong>Application Security</strong>:</p>
<ul>
<li><input disabled="" type="checkbox"> SQL injection testing (automated + manual)</li>
<li><input disabled="" type="checkbox"> XSS payload injection testing</li>
<li><input disabled="" type="checkbox"> File upload security testing</li>
<li><input disabled="" type="checkbox"> Path traversal vulnerability testing</li>
<li><input disabled="" type="checkbox"> Business logic security testing</li>
</ul>
<p><strong>Infrastructure Security</strong>:</p>
<ul>
<li><input disabled="" type="checkbox"> Docker container security scanning</li>
<li><input disabled="" type="checkbox"> Dependency vulnerability scanning</li>
<li><input disabled="" type="checkbox"> Configuration security review</li>
<li><input disabled="" type="checkbox"> Access control validation</li>
</ul>
<hr>
<h2>Security Configuration Checklist</h2><h3>Production Deployment Security</h3><p><strong>Required Environment Variables</strong>:</p>
<pre><code class="language-bash"><span class="hljs-comment"># Security configuration</span>
NODE_ENV=production
CORS_ORIGIN=https://yourdomain.com
SESSION_COOKIE_SECURE=<span class="hljs-literal">true</span>
RATE_LIMIT_MAX_REQUESTS=100
MAX_UPLOAD_SIZE=52428800
LOG_LEVEL=warn

<span class="hljs-comment"># Generate secure session secret</span>
SESSION_SECRET=$(openssl rand -hex 32)</code></pre><p><strong>File Permissions</strong>:</p>
<pre><code class="language-bash"><span class="hljs-comment"># Database file</span>
<span class="hljs-built_in">chmod</span> 600 /path/to/hextrackr.db

<span class="hljs-comment"># Configuration files</span>
<span class="hljs-built_in">chmod</span> 600 /path/to/.env

<span class="hljs-comment"># Upload directory</span>
<span class="hljs-built_in">chmod</span> 755 /path/to/uploads
<span class="hljs-built_in">chown</span> www-data:www-data /path/to/uploads

<span class="hljs-comment"># Application directory</span>
<span class="hljs-built_in">chmod</span> -R 755 /path/to/app
<span class="hljs-built_in">chown</span> -R www-data:www-data /path/to/app</code></pre><p><strong>Network Security</strong>:</p>
<pre><code class="language-bash"><span class="hljs-comment"># Firewall configuration</span>
ufw allow 8989/tcp  <span class="hljs-comment"># HTTP API</span>
ufw allow 8988/tcp  <span class="hljs-comment"># WebSocket</span>
ufw <span class="hljs-built_in">enable</span>

<span class="hljs-comment"># Reverse proxy recommended for HTTPS termination</span>
<span class="hljs-comment"># Direct internet exposure not recommended</span></code></pre><p>This comprehensive security implementation documentation provides complete visibility into all security measures for corporate review and compliance assessment.</p>
<h1>Security Configuration</h1><p>This document provides a checklist for configuring the security features of HexTrackr.</p>
<hr>
<h2>Rate Limiting</h2><ul>
<li>The rate limit is currently hardcoded to 100 requests per 15 minutes.</li>
</ul>
<hr>
<h2>CORS</h2><ul>
<li>The allowed origins for CORS are currently hardcoded in <code>server.js</code>.</li>
</ul>
<hr>
<h2>File Uploads</h2><ul>
<li>The maximum file upload size is currently hardcoded to 100MB.</li>
</ul>

    <!-- Note: This file is intentionally minimal. The full page scaffold, header, footer, and scripts
             are provided by docs-html/index.html. Content generated using this template will be
             fetched and injected into #content-container by docs-html/js/docs-portal-v2.js. -->
</section>
