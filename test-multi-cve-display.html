<!DOCTYPE html>
<html>
<head>
    <title>Multi-CVE Display Test</title>
    <style>
        .vulnerability-cve { margin-right: 5px; color: blue; text-decoration: none; }
        .vulnerability-cve:hover { text-decoration: underline; }
        .text-warning { color: orange; }
    </style>
</head>
<body>
    <h2>Multi-CVE Display Test</h2>
    
    <div id="test-results">
        <h3>Test Cases:</h3>
        <div id="test-single"></div>
        <div id="test-comma"></div>
        <div id="test-space"></div>
        <div id="test-mixed"></div>
    </div>

    <script src="app/public/scripts/shared/cve-utilities.js"></script>
    <script>
        // Mock vulnManager for testing
        window.vulnManager = {
            lookupVulnerability: function(cveId) {
                alert('Looking up: ' + cveId);
            }
        };

        // Test cases
        const testCases = [
            { id: 'test-single', label: 'Single CVE', cve: 'CVE-2024-1234' },
            { id: 'test-comma', label: 'Comma-separated', cve: 'CVE-2024-1234, CVE-2024-5678' },
            { id: 'test-space', label: 'Space-separated', cve: 'CVE-2024-9999 CVE-2024-8888 CVE-2024-7777' },
            { id: 'test-mixed', label: 'Mixed format', cve: 'CVE-2024-1111,CVE-2024-2222,CVE-2024-3333' }
        ];

        testCases.forEach(test => {
            const element = document.getElementById(test.id);
            const links = CVEUtilities.createMultipleCVELinks(test.cve, {
                cssClass: "vulnerability-cve",
                clickHandler: "vulnManager.lookupVulnerability"
            });
            element.innerHTML = `<strong>${test.label}:</strong> ${links}`;
        });

        console.log('CVE Utilities test completed');
    </script>
</body>
</html>