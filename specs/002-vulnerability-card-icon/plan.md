# Implementation Plan: Vulnerability Card Icon and Font Color Fix

**Branch**: `002-vulnerability-card-icon` | **Date**: 2025-09-17 | **Spec**: [spec.md](spec.md)
**Input**: Feature specification from `/specs/002-vulnerability-card-icon/spec.md`

## Execution Flow (/plan command scope)
```
1. Load feature spec from Input path
   → If not found: ERROR "No feature spec at {path}"
2. Fill Technical Context (scan for NEEDS CLARIFICATION)
   → Detect Project Type from context (web=frontend+backend, mobile=app+api)
   → Set Structure Decision based on project type
3. Fill the Constitution Check section based on the content of the constitution document.
4. Evaluate Constitution Check section below
   → If violations exist: Document in Complexity Tracking
   → If no justification possible: ERROR "Simplify approach first"
   → Update Progress Tracking: Initial Constitution Check
5. Execute Phase 0 → research.md
   → If NEEDS CLARIFICATION remain: ERROR "Resolve unknowns"
6. Execute Phase 1 → contracts, data-model.md, quickstart.md, agent-specific template file
7. Re-evaluate Constitution Check section
   → If new violations: Refactor design, return to Phase 1
   → Update Progress Tracking: Post-Design Constitution Check
8. Plan Phase 2 → Describe task generation approach (DO NOT create tasks.md)
9. STOP - Ready for /tasks command
```

## Summary
Implement consistent color scheme across vulnerability dashboard components to eliminate visual discordance between stat cards and VPR trends chart. The solution will unify all severity indicators (Critical=Red, High=Orange, Medium=Blue, Low=Green) with proper theme support and WCAG accessibility compliance.

## Technical Context
**Language/Version**: JavaScript ES6+, CSS3
**Primary Dependencies**: Tabler CSS Framework, ApexCharts
**Storage**: N/A (presentation layer only)
**Testing**: Playwright E2E tests, Jest unit tests
**Target Platform**: Web browsers (Chrome, Firefox, Safari, Edge)
**Project Type**: web (frontend focus with CSS variables)
**Performance Goals**: <50ms color update on theme switch
**Constraints**: Must maintain WCAG AA contrast ratios (4.5:1 normal text, 3:1 large)
**Scale/Scope**: 4 stat cards, 1 chart, 2 themes (light/dark)

## Constitution Check
*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

### Article I: Development Framework
- [x] Context gathered from existing codebase
- [x] Documentation will be updated after implementation
- [x] Code will pass ESLint and quality checks
- [x] Using existing copilot branch structure
- [x] Docker container will be used for testing (port 8989)
- [x] Security: No user input processing required

### Article II: Spec-Kit Framework
- [x] Following /specify → /plan → /tasks workflow
- [x] Written specification complete before implementation

### Article III: MCP Tool Usage
- [x] Will use Context7 for CSS/JS framework references if needed
- [x] Codacy quality checks will be enforced

### Article IV: Performance Requirements
- [x] Color changes must update within 50ms (well under 2s page load requirement)
- [x] No impact on API response times (presentation only)
- [x] No database operations involved

## Project Structure

### Documentation (this feature)
```
specs/002-vulnerability-card-icon/
├── plan.md              # This file (/plan command output)
├── research.md          # Phase 0 output (/plan command)
├── data-model.md        # Phase 1 output (/plan command) - minimal for UI feature
├── quickstart.md        # Phase 1 output (/plan command)
├── contracts/           # Phase 1 output (/plan command) - N/A for UI feature
└── tasks.md             # Phase 2 output (/tasks command - NOT created by /plan)
```

### Source Code (repository root)
```
# Existing HexTrackr structure (Option 2: Web application)
app/
├── public/
│   ├── styles/
│   │   ├── pages/vulnerabilities.css    # Severity color definitions
│   │   └── theme/dark.css              # Dark theme overrides
│   ├── scripts/
│   │   ├── shared/
│   │   │   ├── vulnerability-statistics.js  # Stat card rendering
│   │   │   └── vulnerability-chart-manager.js # Chart colors
│   │   └── utils/
│   │       └── chart-theme-adapter.js  # Theme-aware chart config
│   └── vulnerabilities.html             # Dashboard markup
└── tests/
    └── e2e/
        └── vulnerability-colors.spec.js # Color consistency tests
```

**Structure Decision**: Using existing Option 2 (Web application) - frontend modifications only

## Phase 0: Outline & Research

### Research Tasks Identified:
1. **Existing Color Systems Analysis**
   - Current stat card color implementation (Tabler classes)
   - Chart color configuration (ApexCharts colors array)
   - Theme switching mechanism

2. **WCAG Accessibility Requirements**
   - Contrast ratio calculations for chosen colors
   - Color-blind safe palette verification
   - Supporting visual indicators beyond color

3. **CSS Variable Architecture**
   - Tabler's CSS variable system
   - Theme-specific overrides
   - Chart library color integration

4. **Browser Compatibility**
   - CSS variable support across browsers
   - ApexCharts theme update methods
   - Real-time theme switching approaches

**Output**: research.md with color system architecture and accessibility validation

## Phase 1: Design & Contracts
*Prerequisites: research.md complete*

### 1. Color System Design (→ data-model.md)
```javascript
// Severity Color Mapping
const SEVERITY_COLORS = {
  critical: {
    hex: '#dc2626',     // Red
    rgb: '220, 38, 38',
    class: 'severity-critical'
  },
  high: {
    hex: '#ea580c',     // Orange
    rgb: '234, 88, 12',
    class: 'severity-high'
  },
  medium: {
    hex: '#2563eb',     // Blue
    rgb: '37, 99, 235',
    class: 'severity-medium'
  },
  low: {
    hex: '#16a34a',     // Green
    rgb: '22, 163, 74',
    class: 'severity-low'
  }
};
```

### 2. CSS Variable Definitions
```css
:root {
  --vpr-critical: #dc2626;
  --vpr-high: #ea580c;
  --vpr-medium: #2563eb;
  --vpr-low: #16a34a;
}

[data-theme="dark"] {
  /* Adjusted for dark mode visibility */
  --vpr-critical: #ef4444;
  --vpr-high: #f97316;
  --vpr-medium: #3b82f6;
  --vpr-low: #22c55e;
}
```

### 3. Test Scenarios (→ quickstart.md)
- Verify color consistency in light mode
- Verify color consistency in dark mode
- Test theme switching color updates
- Validate WCAG contrast ratios
- Confirm color-blind accessibility

### 4. Update CLAUDE.md incrementally
- Add color system constants to project context
- Document theme variable architecture
- Note accessibility requirements

**Output**: data-model.md, quickstart.md, updated CLAUDE.md

## Phase 2: Task Planning Approach
*This section describes what the /tasks command will do - DO NOT execute during /plan*

**Task Generation Strategy**:
1. CSS variable definition tasks [P]
2. Stat card color update tasks [P]
3. Chart color configuration tasks
4. Theme switching update tasks
5. Accessibility validation tasks
6. E2E test creation tasks

**Ordering Strategy**:
- Define CSS variables first (foundation)
- Update components to use variables (parallel possible)
- Implement theme switching
- Add tests to verify implementation

**Estimated Output**: 15-20 numbered tasks focusing on CSS and JavaScript updates

## Complexity Tracking
*No violations - using existing frameworks and simple CSS variable approach*

## Progress Tracking
*This checklist is updated during execution flow*

**Phase Status**:
- [x] Phase 0: Research complete (/plan command)
- [x] Phase 1: Design complete (/plan command)
- [x] Phase 2: Task planning complete (/plan command - describe approach only)
- [ ] Phase 3: Tasks generated (/tasks command)
- [ ] Phase 4: Implementation complete
- [ ] Phase 5: Validation passed

**Gate Status**:
- [x] Initial Constitution Check: PASS
- [x] Post-Design Constitution Check: PASS
- [x] All NEEDS CLARIFICATION resolved
- [x] Complexity deviations documented (none)

---
*Based on Constitution v10.0.0 - See `/memory/constitution.md`*