/**
 * Simple Visual Test for Vulnerability Color Consistency
 *
 * This is all we really needed - take screenshots and visually verify
 * that the colors match between stat cards and charts.
 */

const { test, expect } = require("@playwright/test");

test.describe("Vulnerability Color Visual Check", () => {
    test("Capture screenshots for visual comparison", async ({ page }) => {
        // Navigate to vulnerabilities page
        await page.goto("http://localhost:8989/vulnerabilities.html");

        // Wait for data to load
        await page.waitForTimeout(2000);

        // Take light mode screenshot
        await page.screenshot({
            path: "test-results/vulnerability-colors-light.png",
            fullPage: false,
            clip: { x: 0, y: 200, width: 1200, height: 800 }
        });

        // Switch to dark mode
        await page.click("[data-bs-toggle='theme']");
        await page.waitForTimeout(500);

        // Take dark mode screenshot
        await page.screenshot({
            path: "test-results/vulnerability-colors-dark.png",
            fullPage: false,
            clip: { x: 0, y: 200, width: 1200, height: 800 }
        });

        // Simple CSS variable check to ensure they're defined
        const cssVars = await page.evaluate(() => {
            const style = getComputedStyle(document.documentElement);
            return {
                critical: style.getPropertyValue("--vpr-critical").trim(),
                high: style.getPropertyValue("--vpr-high").trim(),
                medium: style.getPropertyValue("--vpr-medium").trim(),
                low: style.getPropertyValue("--vpr-low").trim()
            };
        });

        // Just verify the variables exist
        expect(cssVars.critical).toBeTruthy();
        expect(cssVars.high).toBeTruthy();
        expect(cssVars.medium).toBeTruthy();
        expect(cssVars.low).toBeTruthy();

        console.log("âœ… Screenshots saved to test-results/");
        console.log("âœ… CSS variables defined:", cssVars);
        console.log("\nðŸ“¸ Please visually verify:");
        console.log("  - Stat card colors match chart colors");
        console.log("  - Medium is blue (not yellow)");
        console.log("  - Colors look good in both themes");
    });
});