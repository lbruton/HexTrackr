# Vulnerability Chart Normalization Feature

## Overview

The Vulnerability Chart Normalization feature allows you to toggle between absolute values and normalized (index 100) values in the vulnerability trends chart. This makes it easier to compare trends across different severity levels, especially when they have vastly different scales.

## How to Use

### Toggling Normalization

1. Navigate to the **Vulnerabilities** page
2. Locate the chart controls section (above the vulnerability trends chart)
3. Click the **"Normalize Data"** button (with percentage icon)
4. The button will turn blue when normalization is active

### Understanding Normalized View

When normalization is enabled:
- All severity lines start at index 100 (baseline)
- Each subsequent value shows the percentage change from the baseline
- This makes it easy to compare relative trends between severities
- Lines that were hard to see (like Low severity with small counts) become visible

### Tooltips

When hovering over data points in normalized mode:
- **Index**: Shows the normalized value (e.g., "Index: 125.5")
- **Actual**: Shows the real count or VPR value (e.g., "Actual: 45")

This dual display helps you understand both the trend and the absolute values.

## Features

### Persistence

Your normalization preference is automatically saved:
- The view state persists across page refreshes
- Your preference is stored in browser localStorage
- Each browser/device can have its own preference

### Performance

The normalization feature is optimized for performance:
- Toggle transitions complete in under 200ms
- No additional server requests needed
- All calculations happen client-side
- Chart rendering remains smooth

### Theme Compatibility

The normalization button works seamlessly with both:
- Light theme
- Dark theme

The button styling adapts automatically to your selected theme.

## Use Cases

### When to Use Normalization

- **Comparing trends**: When you want to see if different severities are trending in the same direction
- **Small value visibility**: When low-count severities are hard to see on the chart
- **Percentage analysis**: When relative changes are more important than absolute values
- **Trend alignment**: When you need to see if spikes/drops happen simultaneously across severities

### When to Use Absolute Values

- **Actual counts matter**: When you need to see the real vulnerability numbers
- **Resource planning**: When allocating resources based on actual workload
- **Reporting**: When generating reports that need actual metrics
- **Threshold monitoring**: When watching for specific count or VPR thresholds

## Technical Details

### Normalization Method

The feature uses an **Index 100 baseline normalization**:
1. The first non-zero value for each severity becomes the baseline (100)
2. All subsequent values are calculated as: `(value / baseline) Ã— 100`
3. This preserves the trend shape while normalizing the scale

### Data Storage

- Preference stored in: `localStorage.hextrackr.chartViewState`
- Format: JSON object with `viewMode` and `selectedTimeRange`
- No server-side storage required

### Browser Compatibility

- Works in all modern browsers (Chrome, Firefox, Safari, Edge)
- Requires localStorage support
- Gracefully degrades if localStorage is unavailable

## Troubleshooting

### Button Not Appearing

- Ensure you're on the Vulnerabilities page
- Check that JavaScript is enabled
- Clear browser cache and reload

### State Not Persisting

- Check if localStorage is enabled in your browser
- Verify you're not in private/incognito mode
- Check browser console for any errors

### Chart Not Updating

- Ensure you have vulnerability data to display
- Try refreshing the page
- Check browser console for JavaScript errors

## Related Features

- **Metric Toggle**: Switch between Count and VPR Score metrics
- **Time Range Zoom**: Focus on specific date ranges
- **Chart Export**: Export normalized or absolute views as images